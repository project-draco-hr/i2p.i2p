{
  System.err.println("onStop called");
  super.onStop();
  List contexts=RouterContext.listContexts();
  if ((contexts == null) || (contexts.size() <= 0))   throw new IllegalStateException("No contexts. This is usually because the router is either starting up or shutting down.");
  RouterContext ctx=(RouterContext)contexts.get(0);
  ctx.router().shutdownGracefully(Router.EXIT_HARD);
  System.err.println("shutdown complete");
}
