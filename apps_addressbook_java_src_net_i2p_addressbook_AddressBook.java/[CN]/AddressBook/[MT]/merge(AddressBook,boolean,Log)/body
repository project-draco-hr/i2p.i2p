{
  Iterator otherIter=other.addresses.keySet().iterator();
  while (otherIter.hasNext()) {
    String otherKey=(String)otherIter.next();
    String otherValue=(String)other.addresses.get(otherKey);
    if (valid(otherKey,otherValue)) {
      if (this.addresses.containsKey(otherKey) && !overwrite) {
        if (!this.addresses.get(otherKey).equals(otherValue) && log != null) {
          log.append("Conflict for " + otherKey + " from "+ other.location+ ". Destination in remote address book is "+ otherValue);
        }
      }
 else       if (!this.addresses.containsKey(otherKey) || !this.addresses.get(otherKey).equals(otherValue)) {
        this.addresses.put(otherKey,otherValue);
        this.modified=true;
        if (log != null) {
          log.append("New address " + otherKey + " added to address book. From: "+ other.location);
        }
      }
    }
  }
}
