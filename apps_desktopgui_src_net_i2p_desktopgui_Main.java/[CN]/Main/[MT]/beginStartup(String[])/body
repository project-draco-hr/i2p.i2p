{
  changeState(STARTING);
  String headless=System.getProperty("java.awt.headless");
  boolean isHeadless=Boolean.parseBoolean(headless);
  if (isHeadless) {
    log.warn("Headless environment: not starting desktopgui!");
    changeState(START_FAILED,"Headless environment: not starting desktopgui!",null);
    return;
  }
  try {
    String laf=UIManager.getSystemLookAndFeelClassName();
    UIManager.setLookAndFeel(laf);
  }
 catch (  ClassNotFoundException ex) {
    log.log(Log.ERROR,null,ex);
  }
catch (  InstantiationException ex) {
    log.log(Log.ERROR,null,ex);
  }
catch (  IllegalAccessException ex) {
    log.log(Log.ERROR,null,ex);
  }
catch (  UnsupportedLookAndFeelException ex) {
    log.log(Log.ERROR,null,ex);
  }
catch (  Error ex) {
    log.log(Log.ERROR,"No permissions? Different user?",ex);
    changeState(START_FAILED,"No permissions? Different user?",new RuntimeException(ex));
    return;
  }
  if (_context == null)   launchForeverLoop();
  SwingUtilities.invokeLater(new Runnable(){
    @Override public void run(){
      try {
        startUp();
      }
 catch (      Exception e) {
        log.error("Failed while running desktopgui!",e);
        changeState(START_FAILED,"Failed while running desktopgui!",e);
      }
    }
  }
);
}
