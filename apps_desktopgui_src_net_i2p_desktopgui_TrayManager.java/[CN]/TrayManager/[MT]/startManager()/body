{
  if (SystemTray.isSupported()) {
    tray=SystemTray.getSystemTray();
    String tooltip=SystemVersion.isWindows() ? _t("I2P: Right-click for menu") : null;
    trayIcon=new TrayIcon(getTrayImage(),tooltip,getMainMenu());
    trayIcon.setImageAutoSize(true);
    tray.add(trayIcon);
    trayIcon.addMouseListener(new MouseListener(){
      public void mouseClicked(      MouseEvent m){
        updateMenu();
      }
      public void mouseEntered(      MouseEvent m){
        updateMenu();
      }
      public void mouseExited(      MouseEvent m){
        updateMenu();
      }
      public void mousePressed(      MouseEvent m){
        updateMenu();
      }
      public void mouseReleased(      MouseEvent m){
        updateMenu();
      }
    }
);
  }
 else {
    throw new AWTException("SystemTray not supported");
  }
}
