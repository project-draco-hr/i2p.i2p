{
  popupListener=new PopupMenuListener(){
    @Override public void popupMenuWillBecomeVisible(    PopupMenuEvent e){
    }
    @Override public void popupMenuWillBecomeInvisible(    PopupMenuEvent e){
      if (window != null) {
        window.dispose();
        window=null;
      }
    }
    @Override public void popupMenuCanceled(    PopupMenuEvent e){
      if (window != null) {
        window.dispose();
        window=null;
      }
    }
  }
;
  addMouseListener(new MouseAdapter(){
    @Override public void mousePressed(    MouseEvent e){
      showJPopupMenu(e,previous);
      previous=e;
      previousTime=time;
      time=new Date();
    }
    @Override public void mouseReleased(    MouseEvent e){
      showJPopupMenu(e,previous);
      previous=e;
      previousTime=time;
      time=new Date();
    }
  }
);
}
