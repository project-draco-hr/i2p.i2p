{
  if ((e.isPopupTrigger() || previous.isPopupTrigger()) && (time.getTime() - previousTime.getTime() < 1000) && menu != null) {
    if (window == null) {
      if (IS_WINDOWS) {
        window=new JDialog((Frame)null);
        ((JDialog)window).setUndecorated(true);
      }
 else {
        window=new JWindow((Frame)null);
      }
      window.setAlwaysOnTop(true);
      Dimension size=menu.getPreferredSize();
      Point centerPoint=GraphicsEnvironment.getLocalGraphicsEnvironment().getCenterPoint();
      if (e.getY() > centerPoint.getY())       window.setLocation(e.getX(),e.getY() - size.height);
 else       window.setLocation(e.getX(),e.getY());
      window.setVisible(true);
      menu.show(((RootPaneContainer)window).getContentPane(),0,0);
      window.toFront();
    }
  }
}
