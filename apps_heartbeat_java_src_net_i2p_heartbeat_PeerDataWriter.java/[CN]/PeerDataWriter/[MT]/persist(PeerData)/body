{
  String filename=data.getConfig().getStatFile();
  String header=getHeader(data);
  File statFile=new File(filename);
  FileOutputStream fos=null;
  try {
    fos=new FileOutputStream(statFile);
    fos.write(header.getBytes());
    fos.write("#action\tstatus\tdate and time sent   \tsendMs\treplyMs\n".getBytes());
    for (Iterator iter=data.getDataPoints().iterator(); iter.hasNext(); ) {
      PeerData.EventDataPoint point=(PeerData.EventDataPoint)iter.next();
      String line=getEvent(point);
      fos.write(line.getBytes());
    }
  }
 catch (  IOException ioe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error persisting the peer data for " + data.getConfig().getPeer().calculateHash().toBase64(),ioe);
    return false;
  }
 finally {
    if (fos != null)     try {
      fos.close();
    }
 catch (    IOException ioe) {
    }
  }
  return true;
}
