{
  this.deletionKeyPlain=deletionKeyPlain;
  this.deletionKeyEncrypted=deletionKeyEncrypted;
  this.messageId=messageId;
  this.fragmentIndex=fragmentIndex;
  this.numFragments=numFragments;
  this.content=content;
  dhtKey=generateRandomHash();
  ByteArrayOutputStream byteStream=new ByteArrayOutputStream();
  DataOutputStream dataStream=new DataOutputStream(byteStream);
  try {
    deletionKeyEncrypted.writeTo(dataStream);
    messageId.writeTo(dataStream);
    dataStream.writeShort(fragmentIndex);
    dataStream.writeShort(numFragments);
    dataStream.writeShort(content.length);
    dataStream.write(content);
    encryptedData=encrypt(byteStream.toByteArray(),emailDestination);
    verify();
  }
 catch (  IOException e) {
    log.error("Can't write to ByteArrayOutputStream/DataOutputStream.",e);
  }
}
