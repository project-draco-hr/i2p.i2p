{
  while (!stop) {
    if (socketChanged) {
      socketChanged=false;
    }
    if (serverSocket == null) {
      Snark.debug("Server socket went away.. boo hiss",Snark.ERROR);
      stop=true;
      return;
    }
    try {
      I2PSocket socket=serverSocket.accept();
      if (socket == null) {
        if (socketChanged) {
          continue;
        }
 else {
          Snark.debug("Null socket accepted, but socket wasn't changed?",Snark.ERROR);
        }
      }
 else {
        Thread t=new Thread(new Handler(socket),"Connection-" + socket);
        t.start();
      }
    }
 catch (    I2PException ioe) {
      if (!socketChanged) {
        Snark.debug("Error while accepting: " + ioe,Snark.ERROR);
        stop=true;
      }
    }
catch (    IOException ioe) {
      Snark.debug("Error while accepting: " + ioe,Snark.ERROR);
      stop=true;
    }
  }
  try {
    serverSocket.close();
  }
 catch (  I2PException ignored) {
  }
}
