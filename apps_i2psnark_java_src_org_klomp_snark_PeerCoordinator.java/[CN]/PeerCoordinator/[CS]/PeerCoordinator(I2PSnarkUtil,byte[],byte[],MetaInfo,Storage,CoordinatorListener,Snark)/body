{
  _util=util;
  _random=util.getContext().random();
  this.id=id;
  this.infohash=infohash;
  this.metainfo=metainfo;
  this.storage=storage;
  this.listener=listener;
  this.snark=torrent;
  wantedPieces=new ArrayList();
  setWantedPieces();
  partialPieces=new ArrayList(getMaxConnections() + 1);
  peers=new LinkedBlockingQueue();
  magnetState=new MagnetState(infohash,metainfo);
  pexPeers=new ConcurrentHashSet();
  timer=new CheckEvent(new PeerCheckerTask(_util,this));
  timer.schedule((CHECK_PERIOD / 2) + _random.nextInt((int)CHECK_PERIOD));
}
