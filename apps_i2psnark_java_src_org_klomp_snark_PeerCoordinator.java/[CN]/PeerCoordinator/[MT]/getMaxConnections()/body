{
  if (metainfo == null)   return 6;
  int size=metainfo.getPieceLength(0);
  int max=_util.getMaxConnections();
  if (size <= 512 * 1024 || completed())   return max;
  if (size <= 1024 * 1024)   return (max + max + 2) / 3;
  return (max + 2) / 3;
}
