{
  halted=true;
  List removed=new ArrayList();
synchronized (peers) {
    timer.cancel();
    removed.addAll(peers);
    peers.clear();
    peerCount=0;
  }
  while (removed.size() > 0) {
    Peer peer=(Peer)removed.remove(0);
    peer.disconnect();
    removePeerFromPieces(peer);
  }
}
