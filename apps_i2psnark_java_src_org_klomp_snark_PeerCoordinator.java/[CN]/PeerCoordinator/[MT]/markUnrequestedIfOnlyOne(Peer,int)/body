{
synchronized (peers) {
    Iterator<Peer> it=peers.iterator();
    while (it.hasNext()) {
      Peer p=it.next();
      if (p.equals(peer))       continue;
      if (p.state == null)       continue;
      if (p.state.getRequestedPieces().contains(Integer.valueOf(piece))) {
        if (_log.shouldLog(Log.DEBUG))         _log.debug("Another peer is requesting piece " + piece);
        return;
      }
    }
  }
synchronized (wantedPieces) {
    Iterator<Piece> it=wantedPieces.iterator();
    while (it.hasNext()) {
      Piece p=it.next();
      if (p.getId() == piece) {
        p.setRequested(false);
        if (_log.shouldLog(Log.DEBUG))         _log.debug("Removing from request list piece " + piece);
        return;
      }
    }
  }
}
