{
  if (halted)   return -1;
synchronized (wantedPieces) {
    Integer piece=null;
    Iterator it=wantedPieces.iterator();
    while (piece == null && it.hasNext()) {
      Integer i=(Integer)it.next();
      if (havePieces.get(i.intValue())) {
        it.remove();
        piece=i;
      }
    }
    if (piece == null)     return -1;
    wantedPieces.add(piece);
    return piece.intValue();
  }
}
