{
  System.out.println(copyright);
  System.out.println();
  Snark snark=parseArguments(args);
  SnarkShutdown snarkhook=new SnarkShutdown(snark.storage,snark.coordinator,snark.acceptor,snark.trackerclient,snark);
  Runtime.getRuntime().addShutdownHook(snarkhook);
  Timer timer=new Timer(true);
  TimerTask monitor=new PeerMonitorTask(snark.coordinator);
  timer.schedule(monitor,PeerMonitorTask.MONITOR_PERIOD,PeerMonitorTask.MONITOR_PERIOD);
  if (Snark.command_interpreter) {
    boolean quit=false;
    System.out.println();
    System.out.println(usage);
    System.out.println();
    try {
      BufferedReader br=new BufferedReader(new InputStreamReader(System.in));
      String line=br.readLine();
      while (!quit && line != null) {
        line=line.toLowerCase();
        if ("quit".equals(line))         quit=true;
 else         if ("list".equals(line)) {
synchronized (coordinator.peers) {
            System.out.println(coordinator.peers.size() + " peers -" + " (i)nterested,"+ " (I)nteresting,"+ " (c)hoking,"+ " (C)hoked:");
            Iterator it=coordinator.peers.iterator();
            while (it.hasNext()) {
              Peer peer=(Peer)it.next();
              System.out.println(peer);
              System.out.println("\ti: " + peer.isInterested() + " I: "+ peer.isInteresting()+ " c: "+ peer.isChoking()+ " C: "+ peer.isChoked());
            }
          }
        }
 else         if ("info".equals(line)) {
          System.out.println("Name: " + meta.getName());
          System.out.println("Torrent: " + torrent);
          System.out.println("Tracker: " + meta.getAnnounce());
          List files=meta.getFiles();
          System.out.println("Files: " + ((files == null) ? 1 : files.size()));
          System.out.println("Pieces: " + meta.getPieces());
          System.out.println("Piece size: " + meta.getPieceLength(0) / 1024 + " KB");
          System.out.println("Total size: " + meta.getTotalLength() / (1024 * 1024) + " MB");
        }
 else         if ("".equals(line) || "help".equals(line)) {
          System.out.println(usage);
          System.out.println(help);
        }
 else {
          System.out.println("Unknown command: " + line);
          System.out.println(usage);
        }
        if (!quit) {
          System.out.println();
          line=br.readLine();
        }
      }
    }
 catch (    IOException ioe) {
      debug("ERROR while reading stdin: " + ioe,ERROR);
    }
    Runtime.getRuntime().removeShutdownHook(snarkhook);
    snarkhook.start();
  }
}
