{
  stopped=false;
  boolean coordinatorChanged=false;
  if (coordinator.halted()) {
    PeerCoordinatorSet set=PeerCoordinatorSet.instance();
    set.remove(coordinator);
    PeerCoordinator newCoord=new PeerCoordinator(coordinator.getID(),coordinator.getMetaInfo(),coordinator.getStorage(),coordinator.getListener(),this);
    set.add(newCoord);
    coordinator=newCoord;
    coordinatorChanged=true;
  }
  if (!trackerclient.started() && !coordinatorChanged) {
    trackerclient.start();
  }
 else   if (trackerclient.halted() || coordinatorChanged) {
    try {
      storage.reopen(rootDataDir);
    }
 catch (    IOException ioe) {
      try {
        storage.close();
      }
 catch (      IOException ioee) {
        ioee.printStackTrace();
      }
      fatal("Could not reopen storage",ioe);
    }
    TrackerClient newClient=new TrackerClient(coordinator.getMetaInfo(),coordinator);
    if (!trackerclient.halted())     trackerclient.halt();
    trackerclient=newClient;
    trackerclient.start();
  }
}
