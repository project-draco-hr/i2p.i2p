{
  stopped=true;
  TrackerClient tc=trackerclient;
  if (tc != null)   tc.halt();
  PeerCoordinator pc=coordinator;
  if (pc != null)   pc.halt();
  Storage st=storage;
  if (st != null) {
    if (storage.changed)     SnarkManager.instance().saveTorrentStatus(storage.getMetaInfo(),storage.getBitField());
    try {
      storage.close();
    }
 catch (    IOException ioe) {
      System.out.println("Error closing " + torrent);
      ioe.printStackTrace();
    }
  }
  if (pc != null)   PeerCoordinatorSet.instance().remove(pc);
}
