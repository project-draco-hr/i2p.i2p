{
  String fileNames[]=dir.list(TorrentFilenameFilter.instance());
  List<String> foundNames=new ArrayList(0);
  if (fileNames != null) {
    for (int i=0; i < fileNames.length; i++) {
      try {
        foundNames.add(new File(dir,fileNames[i]).getCanonicalPath());
      }
 catch (      IOException ioe) {
        _log.error("Error resolving '" + fileNames[i] + "' in '"+ dir,ioe);
      }
    }
  }
  Set<String> existingNames=listTorrentFiles();
  for (int i=0; i < foundNames.size(); i++) {
    if (existingNames.contains(foundNames.get(i))) {
    }
 else {
      if (shouldAutoStart() && !_util.connect())       addMessage(_("Unable to connect to I2P!"));
      try {
        addTorrent(foundNames.get(i),!shouldAutoStart());
      }
 catch (      Exception e) {
        addMessage(_("Unable to add {0}",foundNames.get(i)) + ": " + e);
      }
    }
  }
  existingNames.removeAll(_magnets);
  for (Iterator iter=existingNames.iterator(); iter.hasNext(); ) {
    String name=(String)iter.next();
    if (foundNames.contains(name)) {
    }
 else {
      try {
        stopTorrent(name,true);
      }
 catch (      Exception e) {
      }
    }
  }
}
