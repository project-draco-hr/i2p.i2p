{
  _util=util;
  _log=util.getContext().logManager().getLog(Storage.class);
  boolean areFilesPublic=_util.getFilesPublic();
  if (areFilesPublic)   _base=new File(rootDir,filterName(metainfo.getName()));
 else   _base=new SecureFile(rootDir,filterName(metainfo.getName()));
  this.metainfo=metainfo;
  this.listener=listener;
  needed=metainfo.getPieces();
  bitfield=new BitField(needed);
  piece_size=metainfo.getPieceLength(0);
  pieces=needed;
  total_length=metainfo.getTotalLength();
  List<List<String>> files=metainfo.getFiles();
  int sz=files != null ? files.size() : 1;
  _torrentFiles=new ArrayList<TorrentFile>(sz);
}
