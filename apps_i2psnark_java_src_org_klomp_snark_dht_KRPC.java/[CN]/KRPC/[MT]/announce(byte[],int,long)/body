{
  announce(ih);
  int rv=0;
  long start=_context.clock().now();
  List<NodeInfo> nodes=_knownNodes.findClosest(new InfoHash(ih),max);
  for (  NodeInfo nInfo : nodes) {
    if (announce(ih,nInfo,Math.min(maxWait,60 * 1000)))     rv++;
    maxWait-=_context.clock().now() - start;
    if (maxWait < 1000)     break;
  }
  return rv;
}
