{
  if ((name == null) || (name.trim().length() <= 0))   throw new DataFormatException("Empty destination provided");
  I2PAppContext ctx=I2PAppContext.getGlobalContext();
  Log log=ctx.logManager().getLog(I2PTunnel.class);
  if (name.startsWith("file:")) {
    Destination result=new Destination();
    byte content[]=null;
    FileInputStream in=null;
    try {
      in=new FileInputStream(name.substring("file:".length()));
      byte buf[]=new byte[1024];
      int read=DataHelper.read(in,buf);
      content=new byte[read];
      System.arraycopy(buf,0,content,0,read);
    }
 catch (    IOException ioe) {
      System.out.println(ioe.getMessage());
      return null;
    }
 finally {
      if (in != null)       try {
        in.close();
      }
 catch (      IOException io) {
      }
    }
    try {
      result.fromByteArray(content);
      return result;
    }
 catch (    Exception ex) {
      if (log.shouldLog(Log.INFO))       log.info("File is not a binary destination - trying base64");
      try {
        byte decoded[]=Base64.decode(new String(content));
        result.fromByteArray(decoded);
        return result;
      }
 catch (      DataFormatException dfe) {
        if (log.shouldLog(Log.WARN))         log.warn("File is not a base64 destination either - failing!");
        return null;
      }
    }
  }
 else {
    NamingService inst=ctx.namingService();
    return inst.lookup(name);
  }
}
