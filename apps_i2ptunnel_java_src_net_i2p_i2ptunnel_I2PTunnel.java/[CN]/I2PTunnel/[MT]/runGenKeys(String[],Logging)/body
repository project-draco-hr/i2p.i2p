{
  OutputStream pubdest=null;
  if (args.length == 2) {
    try {
      pubdest=new FileOutputStream(args[1]);
    }
 catch (    IOException ioe) {
      l.log("Error opening output stream");
      _log.error("Error generating keys to out",ioe);
      notifyEvent("genkeysResult","error");
      return;
    }
  }
 else   if (args.length != 1) {
    l.log("genkeys <privkeyfile> [<pubkeyfile>]");
    l.log("   creates a new keypair and prints the public key.\n" + "   if pubkeyfile is given, saves the public key there." + "\n"+ "   if the privkeyfile already exists, just print/save"+ "the pubkey.");
    notifyEvent("genkeysResult","error");
  }
  try {
    File privKeyFile=new File(args[0]);
    if (privKeyFile.exists()) {
      l.log("File already exists.");
      showKey(new FileInputStream(privKeyFile),pubdest,l);
    }
 else {
      makeKey(new FileOutputStream(privKeyFile),pubdest,l);
    }
    notifyEvent("genkeysResult","ok");
  }
 catch (  IOException ioe) {
    l.log("Error generating keys - " + ioe.getMessage());
    notifyEvent("genkeysResult","error");
    _log.error("Error generating keys",ioe);
  }
}
