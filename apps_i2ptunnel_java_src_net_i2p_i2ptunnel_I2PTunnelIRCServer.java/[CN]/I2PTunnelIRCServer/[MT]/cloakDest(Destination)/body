{
  Hash h;
  if (_cloak) {
    byte[] b=new byte[d.size() + _cloakKey.length];
    System.arraycopy(b,0,d.toByteArray(),0,d.size());
    System.arraycopy(b,d.size(),_cloakKey,0,_cloakKey.length);
    h=SHA256Generator.getInstance().calculateHash(b);
  }
 else {
    h=d.calculateHash();
  }
  return h.toBase64().substring(0,8) + ".i2p";
}
