{
  Properties opts=tunnel.getClientOptions();
  String passphrase=opts.getProperty(PROP_CLOAK);
  _cloak=passphrase == null || !"none".equals(passphrase);
  if (_cloak) {
    if (passphrase == null) {
      _cloakKey=new byte[Hash.HASH_LENGTH];
      tunnel.getContext().random().nextBytes(_cloakKey);
    }
 else {
      _cloakKey=SHA256Generator.getInstance().calculateHash(passphrase.trim().getBytes()).getData();
    }
  }
}
