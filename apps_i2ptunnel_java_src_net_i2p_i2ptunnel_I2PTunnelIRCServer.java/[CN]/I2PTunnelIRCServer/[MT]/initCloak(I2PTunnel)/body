{
  Properties opts=tunnel.getClientOptions();
  String passphrase=opts.getProperty(PROP_CLOAK);
  if (passphrase == null) {
    this.cloakKey=new byte[Hash.HASH_LENGTH];
    tunnel.getContext().random().nextBytes(this.cloakKey);
  }
 else {
    this.cloakKey=SHA256Generator.getInstance().calculateHash(passphrase.trim().getBytes()).getData();
  }
  this.hostname=opts.getProperty(PROP_HOSTNAME,PROP_HOSTNAME_DEFAULT);
}
