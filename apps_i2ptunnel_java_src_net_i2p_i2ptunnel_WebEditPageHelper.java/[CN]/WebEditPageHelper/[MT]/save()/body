{
  if (_type == null)   return "<b>Invalid form submission (no type?)</b>";
  Properties config=getConfig();
  if (config == null)   return "<b>Invalid params</b>";
  TunnelController cur=getTunnelController();
  if (cur == null) {
    cur=new TunnelController(config,"",_privKeyGenerate);
    TunnelControllerGroup.getInstance().addController(cur);
    if (cur.getStartOnLoad())     cur.startTunnelBackground();
  }
 else {
    cur.setConfig(config,"");
  }
  if ("httpclient".equals(cur.getType()) || "client".equals(cur.getType())) {
    List controllers=TunnelControllerGroup.getInstance().getControllers();
    for (int i=0; i < controllers.size(); i++) {
      TunnelController c=(TunnelController)controllers.get(i);
      if (c == cur)       continue;
      if ("httpclient".equals(c.getType()) || "client".equals(c.getType())) {
        Properties cOpt=c.getConfig("");
        if (_tunnelCount != null) {
          cOpt.setProperty("option.inbound.quantity",_tunnelCount);
          cOpt.setProperty("option.outbound.quantity",_tunnelCount);
        }
        if (_tunnelDepth != null) {
          cOpt.setProperty("option.inbound.length",_tunnelDepth);
          cOpt.setProperty("option.outbound.length",_tunnelDepth);
        }
        if (_connectDelay)         cOpt.setProperty("option.i2p.streaming.connectDelay","1000");
 else         cOpt.setProperty("option.i2p.streaming.connectDelay","0");
        if ("interactive".equals(_profile))         cOpt.setProperty("option.i2p.streaming.maxWindowSize","1");
 else         cOpt.remove("option.i2p.streaming.maxWindowSize");
        if (_name != null) {
          cOpt.setProperty("option.inbound.nickname",_name);
          cOpt.setProperty("option.outbound.nickname",_name);
        }
        c.setConfig(cOpt,"");
      }
    }
  }
  return getMessages(doSave());
}
