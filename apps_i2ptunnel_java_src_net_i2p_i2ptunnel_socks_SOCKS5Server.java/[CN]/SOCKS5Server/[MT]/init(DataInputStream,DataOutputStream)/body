{
  int nMethods=in.readByte() & 0xff;
  boolean methodOk=false;
  int method=Method.NO_ACCEPTABLE_METHODS;
  for (int i=0; i < nMethods; ++i) {
    method=in.readByte() & 0xff;
    if (method == Method.NO_AUTH_REQUIRED) {
      break;
    }
  }
  boolean canContinue=false;
switch (method) {
case Method.NO_AUTH_REQUIRED:
    _log.debug("no authentication required");
  sendInitReply(Method.NO_AUTH_REQUIRED,out);
return;
default :
_log.debug("no suitable authentication methods found (" + Integer.toHexString(method) + ")");
sendInitReply(Method.NO_ACCEPTABLE_METHODS,out);
throw new SOCKSException("Unsupported authentication method");
}
}
