{
  String spoof=getSpoofedHost(tunnel);
  if (spoof.length() <= 0)   return "";
  TunnelController tun=getController(tunnel);
  if (tun == null)   return "";
  String keyFile=tun.getPrivKeyFile();
  if (keyFile != null && keyFile.trim().length() > 0) {
    PrivateKeyFile pkf=new PrivateKeyFile(keyFile);
    try {
      Destination d=pkf.getDestination();
      if (d == null)       return "";
      SigningPrivateKey privKey=pkf.getSigningPrivKey();
      if (privKey == null)       return "";
      Signature sig=_context.dsa().sign(spoof.getBytes("UTF-8"),privKey);
      return Base64.encode(sig.getData());
    }
 catch (    I2PException e) {
    }
catch (    IOException e) {
    }
  }
  return "";
}
