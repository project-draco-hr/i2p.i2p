{
  TunnelController cur=getController(_tunnel);
  Properties config=getConfig();
  if (config == null)   return "Invalid params";
  if (cur == null) {
    cur=new TunnelController(config,"",true);
    _group.addController(cur);
    if (cur.getStartOnLoad())     cur.startTunnelBackground();
  }
 else {
    cur.setConfig(config,"");
  }
  if ("ircclient".equals(cur.getType()) || "httpclient".equals(cur.getType()) || "client".equals(cur.getType())) {
    List controllers=_group.getControllers();
    for (int i=0; i < controllers.size(); i++) {
      TunnelController c=(TunnelController)controllers.get(i);
      if (c == cur)       continue;
      if (("httpclient".equals(c.getType()) || "ircclient".equals(c.getType()) || "client".equals(c.getType())) && "true".equalsIgnoreCase(c.getSharedClient())) {
        Properties cOpt=c.getConfig("");
        if (_tunnelQuantity != null) {
          cOpt.setProperty("option.inbound.quantity",_tunnelQuantity);
          cOpt.setProperty("option.outbound.quantity",_tunnelQuantity);
        }
        if (_tunnelDepth != null) {
          cOpt.setProperty("option.inbound.length",_tunnelDepth);
          cOpt.setProperty("option.outbound.length",_tunnelDepth);
        }
        if (_tunnelVariance != null) {
          cOpt.setProperty("option.inbound.lengthVariance",_tunnelVariance);
          cOpt.setProperty("option.outbound.lengthVariance",_tunnelVariance);
        }
        if (_tunnelBackupQuantity != null) {
          cOpt.setProperty("option.inbound.backupQuantity",_tunnelBackupQuantity);
          cOpt.setProperty("option.outbound.backupQuantity",_tunnelBackupQuantity);
        }
        cOpt.setProperty("option.inbound.nickname",CLIENT_NICKNAME);
        cOpt.setProperty("option.outbound.nickname",CLIENT_NICKNAME);
        c.setConfig(cOpt,"");
      }
    }
  }
  List msgs=doSave();
  msgs.add(0,"Changes saved");
  return getMessages(msgs);
}
