{
  I2PAppContext context=I2PAppContext.getGlobalContext();
  String classname=opts.getProperty(PROP_MANAGER,DEFAULT_MANAGER);
  try {
    Class cls=Class.forName(classname);
    Constructor<I2PSocketManager> con=(Constructor<I2PSocketManager>)cls.getConstructor(new Class[]{I2PAppContext.class,I2PSession.class,Properties.class,String.class});
    I2PSocketManager mgr=con.newInstance(new Object[]{context,session,opts,name});
    return mgr;
  }
 catch (  Throwable t) {
    getLog().log(Log.CRIT,"Error loading " + classname,t);
    throw new IllegalStateException(t);
  }
}
