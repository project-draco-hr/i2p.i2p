{
  FileOutputStream fos=null;
  try {
    fos=new FileOutputStream(to);
    _addressBook.write(fos);
    Properties props=new Properties();
    for (Iterator iter=_activityLog.keySet().iterator(); iter.hasNext(); ) {
      Long when=(Long)iter.next();
      String msg=(String)_activityLog.get(when);
      props.setProperty(when.toString(),msg);
    }
    DataHelper.writeProperties(fos,props);
  }
 catch (  Exception e) {
    _error=e;
    _errorMessage="Error writing the address book to " + to;
  }
 finally {
    if (fos != null)     try {
      fos.close();
    }
 catch (    IOException ioe) {
    }
  }
}
