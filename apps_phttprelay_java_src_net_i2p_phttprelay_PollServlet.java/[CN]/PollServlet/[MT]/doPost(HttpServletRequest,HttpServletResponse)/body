{
  byte data[]=getData(req);
  if (data == null)   return;
  ByteArrayInputStream bais=new ByteArrayInputStream(data);
  String target=getTarget(bais);
  if (target == null) {
    log("Target not specified");
    resp.sendError(CODE_UNKNOWN);
    return;
  }
  if (!isKnown(target)) {
    resp.sendError(CODE_UNKNOWN);
    return;
  }
  if (!isAuthorized(target,bais)) {
    resp.sendError(CODE_UNAUTHORIZED);
    return;
  }
 else {
    log("Authorized access for target " + target);
  }
  sendMessages(resp,target);
}
