{
  File identDir=getIdentDir(target);
  if (identDir.exists()) {
    File identFile=new File(identDir,"identity.dat");
    if (identFile.exists()) {
      String files[]=identDir.list();
      if (files.length - 1 > _maxMessagesPerIdent) {
        log("Too many messages pending for " + target + ": "+ (files.length - 1));
        return false;
      }
 else {
        return true;
      }
    }
 else {
      log("Ident directory exists, but identity does not... corrupt for " + target);
      return false;
    }
  }
 else {
    log("Unknown ident " + target);
    return false;
  }
}
