{
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  while (true) {
    int ch=in.read();
switch (ch) {
case '\n':
case -1:
      String s=os.toString();
    log.debug("Got line '" + s + "'");
  return os.toString();
case '\r':
break;
default :
os.write(ch);
}
}
}
