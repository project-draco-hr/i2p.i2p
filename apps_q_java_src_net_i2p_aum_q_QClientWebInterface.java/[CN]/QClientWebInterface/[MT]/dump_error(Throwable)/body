{
  if (e instanceof InvocationTargetException) {
    Throwable e1=e.getCause();
    if (e1 != null) {
      e=e1;
    }
  }
  setStatus("HTTP/1.0 400 Error");
  setContentType("text/html");
  ByteArrayOutputStream os=new ByteArrayOutputStream();
  PrintStream ps=new PrintStream(os);
  e.printStackTrace(ps);
  String eText=new String(os.toByteArray());
  HtmlPage page=new HtmlPage();
  page.head.add("title").raw("Q Error");
  page.body.nest("h3").nest("i").raw("Dammit!!").end.end.hr().raw("There was an internal error processing your request").br().hr().nest("code").nest("pre").raw(eText).end.end.hr().add(dumpVars());
  setRawOutput(page.toString());
  e.printStackTrace();
}
