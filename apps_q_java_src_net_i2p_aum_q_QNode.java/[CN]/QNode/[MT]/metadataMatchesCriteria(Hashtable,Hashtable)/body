{
  boolean is_OrMode=false;
  if (criteria.containsKey("searchmode")) {
    if (((String)criteria.get("searchmode")).toLowerCase().equals("or")) {
      is_OrMode=true;
    }
  }
  Enumeration cKeys=criteria.keys();
  while (cKeys.hasMoreElements()) {
    String key=(String)cKeys.nextElement();
    if (key.equals("searchmode")) {
      continue;
    }
    String cval=(String)criteria.get(key);
    String mval=(String)metadata.get(key);
    if (mval == null) {
      mval="";
    }
    if (!(mval.matches(cval) ^ is_OrMode)) {
      return is_OrMode;
    }
  }
  return !is_OrMode;
}
