{
  Set<String> unsetKeys=new HashSet(_context.router().getConfigSettings());
  if (_config != null) {
    Properties props=new Properties();
    try {
      DataHelper.loadProps(props,new ByteArrayInputStream(_config.getBytes()));
    }
 catch (    IOException ioe) {
      _log.error("Config error",ioe);
      addFormError(ioe.toString());
      addFormError(_("Error updating the configuration - please see the error logs"));
      return;
    }
    for (    Object key : props.keySet()) {
      unsetKeys.remove(key);
    }
    boolean saved=_context.router().saveConfig(props,unsetKeys);
    if (saved)     addFormNotice(_("Configuration saved successfully"));
 else     addFormError(_("Error saving the configuration (applied but not saved) - please see the error logs"));
  }
}
