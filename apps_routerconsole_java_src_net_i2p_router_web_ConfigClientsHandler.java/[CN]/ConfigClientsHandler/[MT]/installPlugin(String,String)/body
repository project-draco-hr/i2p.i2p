{
  ConsoleUpdateManager mgr=UpdateHandler.updateManager(_context);
  if (mgr == null) {
    addFormError("Update manager not registered, cannot install");
    return;
  }
  if (mgr.isUpdateInProgress()) {
    addFormError(_("Plugin or update download already in progress."));
    return;
  }
  URI uri;
  try {
    uri=new URI(url);
  }
 catch (  URISyntaxException use) {
    addFormError(_("Bad URL {0}",url));
    return;
  }
  if (!url.startsWith("file:")) {
    if (!verifyProxy())     return;
  }
  if (mgr.installPlugin(app,uri)) {
    if (url.startsWith("file:"))     addFormNotice(_("Installing plugin from {0}",uri.getPath()));
 else     addFormNotice(_("Downloading plugin from {0}",url));
  }
 else {
    addFormError("Cannot install, check logs");
  }
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException ie) {
  }
}
