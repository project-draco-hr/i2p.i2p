{
  if ("Add key".equals(_action)) {
    if (_peer == null || _key == null) {
      addFormError("You must enter a destination and a key");
      return;
    }
    Hash h=new Hash();
    try {
      h.fromBase64(_peer);
    }
 catch (    DataFormatException dfe) {
    }
    if (h.getData() == null) {
      try {
        Destination d=new Destination();
        d.fromBase64(_peer);
        h=d.calculateHash();
      }
 catch (      DataFormatException dfe) {
      }
    }
    if (h.getData() == null) {
      Destination d=_context.namingService().lookup(_peer);
      if (d != null)       h=d.calculateHash();
    }
    SessionKey sk=new SessionKey();
    try {
      sk.fromBase64(_key);
    }
 catch (    DataFormatException dfe) {
    }
    if (h.getData() != null && sk.getData() != null) {
      _context.keyRing().put(h,sk);
      addFormNotice("Key for " + h.toBase64() + " added to keyring");
    }
 else {
      addFormError("Invalid destination or key");
    }
  }
 else {
    addFormError("Unsupported");
  }
}
