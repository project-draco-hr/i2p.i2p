{
  String pfx=realm;
  if (user != null && user.length() > 0)   pfx+='.' + user;
  try {
    MessageDigest md=MessageDigest.getInstance("MD5");
    md.update(pw.getBytes("ISO-8859-1"));
    String hex=DataHelper.toString(md.digest());
    Map<String,String> toAdd=Collections.singletonMap(pfx + PROP_MD5,hex);
    List<String> toDel=new ArrayList(4);
    toDel.add(pfx + PROP_PW);
    toDel.add(pfx + PROP_B64);
    toDel.add(pfx + PROP_CRYPT);
    toDel.add(pfx + PROP_SHASH);
    return _context.router().saveConfig(toAdd,toDel);
  }
 catch (  UnsupportedEncodingException uee) {
    return false;
  }
catch (  NoSuchAlgorithmException nsae) {
    return false;
  }
}
