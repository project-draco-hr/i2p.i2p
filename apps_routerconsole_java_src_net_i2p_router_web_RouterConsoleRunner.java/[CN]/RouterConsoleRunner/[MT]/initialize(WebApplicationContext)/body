{
  String password=getPassword();
  if (password != null) {
    HashUserRealm realm=new HashUserRealm("i2prouter");
    realm.put("admin",password);
    realm.addUserToRole("admin","routerAdmin");
    context.setRealm(realm);
    context.setAuthenticator(authenticator);
    context.addHandler(0,new SecurityHandler());
    SecurityConstraint constraint=new SecurityConstraint("admin","routerAdmin");
    constraint.setAuthenticate(true);
    context.addSecurityConstraint("/",constraint);
  }
  SecurityConstraint sc=new SecurityConstraint();
  sc.setName("No trace or options");
  sc.addMethod("TRACE");
  sc.addMethod("OPTIONS");
  sc.setAuthenticate(true);
  context.addSecurityConstraint("/*",sc);
}
