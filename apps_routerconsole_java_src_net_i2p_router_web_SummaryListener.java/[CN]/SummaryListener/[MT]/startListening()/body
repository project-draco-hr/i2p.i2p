{
  RateStat rs=_rate.getRateStat();
  long period=_rate.getPeriod();
  String baseName=rs.getName() + "." + period;
  _name=createName(_context,baseName);
  _eventName=createName(_context,baseName + ".events");
  try {
    RrdDef def=new RrdDef(_name,now() / 1000,period / 1000);
    long heartbeat=period * 10 / 1000;
    def.addDatasource(_name,"GAUGE",heartbeat,Double.NaN,Double.NaN);
    def.addDatasource(_eventName,"GAUGE",heartbeat,0,Double.NaN);
    double xff=0.9;
    int steps=1;
    int rows=PERIODS;
    def.addArchive("AVERAGE",xff,steps,rows);
    _factory=(RrdMemoryBackendFactory)RrdBackendFactory.getDefaultFactory();
    _db=new RrdDb(def,_factory);
    _sample=_db.createSample();
    _renderer=new SummaryRenderer(_context,this);
    _rate.setSummaryListener(this);
    if (_log.shouldLog(Log.INFO))     _log.info("New RRD " + baseName + " consuming "+ _db.getRrdBackend().getLength()+ " bytes");
  }
 catch (  RrdException re) {
    _log.error("Error starting",re);
  }
catch (  IOException ioe) {
    _log.error("Error starting",ioe);
  }
}
