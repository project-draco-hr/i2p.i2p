{
  _status="<b>Update downloaded</b>";
  TrustedUpdate up=new TrustedUpdate(_context);
  String err=up.migrateVerified(RouterVersion.VERSION,SIGNED_UPDATE_FILE,Router.UPDATE_FILE);
  File f=new File(SIGNED_UPDATE_FILE);
  f.delete();
  if (err == null) {
    String policy=_context.getProperty(ConfigUpdateHandler.PROP_UPDATE_POLICY);
    if ("install".equals(policy)) {
      _log.log(Log.CRIT,"Update was VERIFIED, restarting to install it");
      _status="<b>Update verified</b><br />Restarting";
      restart();
    }
 else {
      _log.log(Log.CRIT,"Update was VERIFIED, will be installed at next restart");
      _status="<b>Update downloaded</b><br />Click Restart to Install";
    }
  }
 else {
    err=err + " from " + url;
    _log.log(Log.CRIT,err);
    _status="<b>" + err + "</b>";
    System.setProperty(PROP_UPDATE_IN_PROGRESS,"false");
  }
}
