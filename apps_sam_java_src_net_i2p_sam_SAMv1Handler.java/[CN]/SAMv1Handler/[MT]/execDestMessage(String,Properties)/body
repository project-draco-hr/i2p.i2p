{
  if (opcode.equals("GENERATE")) {
    if (!props.isEmpty()) {
      _log.debug("Properties specified in DEST GENERATE message");
      return false;
    }
    ByteArrayOutputStream priv=new ByteArrayOutputStream();
    ByteArrayOutputStream pub=new ByteArrayOutputStream();
    SAMUtils.genRandomKey(priv,pub);
    return writeString("DEST REPLY" + " PUB=" + Base64.encode(pub.toByteArray()) + " PRIV="+ Base64.encode(priv.toByteArray())+ "\n");
  }
 else {
    _log.debug("Unrecognized DEST message opcode: \"" + opcode + "\"");
    return false;
  }
}
