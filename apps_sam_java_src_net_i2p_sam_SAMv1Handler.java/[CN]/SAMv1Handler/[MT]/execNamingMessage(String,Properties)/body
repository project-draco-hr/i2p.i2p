{
  if (opcode.equals("LOOKUP")) {
    if (props == null) {
      _log.debug("No parameters specified in NAMING LOOKUP message");
      return false;
    }
    String name=props.getProperty("NAME");
    if (name == null) {
      _log.debug("Name to resolve not specified in NAMING message");
      return false;
    }
    Destination dest;
    if (name.equals("ME")) {
      if (rawSession != null) {
        dest=rawSession.getDestination();
      }
 else       if (streamSession != null) {
        dest=streamSession.getDestination();
      }
 else       if (datagramSession != null) {
        dest=datagramSession.getDestination();
      }
 else {
        _log.debug("Lookup for SESSION destination, but session is null");
        return false;
      }
    }
 else {
      dest=SAMUtils.lookupHost(name,null);
    }
    if (dest == null) {
      return writeString("NAMING REPLY RESULT=KEY_NOT_FOUND\n");
    }
    return writeString("NAMING REPLY RESULT=OK NAME=" + name + " VALUE="+ dest.toBase64()+ "\n");
  }
 else {
    _log.debug("Unrecognized NAMING message opcode: \"" + opcode + "\"");
    return false;
  }
}
