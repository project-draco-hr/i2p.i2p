{
  if (getStreamSession() == null) {
    _log.error("BUG! Received stream disconnection, but session is null!");
    throw new NullPointerException("BUG! STREAM session is null!");
  }
  if (!writeString("STREAM CLOSED ID=" + id + " RESULT="+ result+ (msg == null ? "" : (" MESSAGE=" + msg))+ "\n")) {
    throw new IOException("Error notifying disconnection to SAM client");
  }
}
