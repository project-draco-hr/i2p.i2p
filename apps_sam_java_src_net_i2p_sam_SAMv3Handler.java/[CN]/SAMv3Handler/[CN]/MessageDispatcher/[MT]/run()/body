{
  try {
    String header=DataHelper.readLine(is).trim();
    StringTokenizer tok=new StringTokenizer(header," ");
    if (tok.countTokens() != 3) {
      return;
    }
    String version=tok.nextToken();
    if (!"3.0".equals(version))     return;
    String nick=tok.nextToken();
    String dest=tok.nextToken();
    byte[] data=new byte[is.available()];
    is.read(data);
    SessionRecord rec=sSessionsHash.get(nick);
    if (rec != null) {
      rec.getHandler().session.sendBytes(dest,data);
    }
 else {
      Log log=I2PAppContext.getGlobalContext().logManager().getLog(SAMv3Handler.class);
      if (log.shouldLog(Log.WARN))       log.warn("Dropping datagram, no session for " + nick);
    }
  }
 catch (  Exception e) {
    Log log=I2PAppContext.getGlobalContext().logManager().getLog(SAMv3Handler.class);
    if (log.shouldLog(Log.WARN))     log.warn("Error handling datagram",e);
  }
}
