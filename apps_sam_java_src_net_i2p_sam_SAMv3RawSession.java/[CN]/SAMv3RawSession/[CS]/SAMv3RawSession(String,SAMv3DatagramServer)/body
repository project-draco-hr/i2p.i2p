{
  super(SAMv3Handler.sSessionsHash.get(nick).getDest(),SAMv3Handler.sSessionsHash.get(nick).getProps(),SAMv3Handler.sSessionsHash.get(nick).getHandler());
  this.nick=nick;
  this.recv=this;
  this.server=dgServer;
  SessionRecord rec=SAMv3Handler.sSessionsHash.get(nick);
  if (rec == null)   throw new InterruptedIOException();
  this.handler=rec.getHandler();
  Properties props=rec.getProps();
  String portStr=props.getProperty("PORT");
  if (portStr == null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("receiver port not specified. Current socket will be used.");
    this.clientAddress=null;
  }
 else {
    int port=Integer.parseInt(portStr);
    String host=props.getProperty("HOST");
    if (host == null) {
      host=rec.getHandler().getClientIP();
      if (_log.shouldLog(Log.DEBUG))       _log.debug("no host specified. Taken from the client socket : " + host + ':'+ port);
    }
    this.clientAddress=new InetSocketAddress(host,port);
  }
  _sendHeader=((handler.verMajor == 3 && handler.verMinor >= 2) || handler.verMajor > 3) && Boolean.parseBoolean(props.getProperty("HEADER"));
}
