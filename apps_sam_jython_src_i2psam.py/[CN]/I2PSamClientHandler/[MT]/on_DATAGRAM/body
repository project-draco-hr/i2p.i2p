def on_DATAGRAM(self, topic, subtopic, args):
    "\n        DATAGRAM SEND\n        DESTINATION=$base64key\n        SIZE=$numBytes\\n[$numBytes of data]\n    \n        All datagram messages have a signature/hash header, formatted as:\n            - sender's binary public dest\n            - S(H(sender_bin_pubdest + recipient_bin_pubdest + msg))\n        "
    log(4, 'entered')
    if (subtopic != 'SEND'):
        log(3, ("Got illegal subtopic '%s' in DATAGRAM command" % subtopic))
        return
    peerdestb64 = args['DESTINATION']
    peerdest = I2PDestination(base64=peerdestb64)
    peerdestBin = base64dec(peerdestb64)
    data = args['DATA']
    log(4, ('samDestPubBin (%s) %s' % (type(self.samDestPubBin), repr(self.samDestPubBin))))
    log(4, ('peerdestBin (%s) %s' % (type(peerdestBin), repr(peerdestBin))))
    log(4, ('data (%s) %s' % (type(data), repr(data))))
    hashed = shahash(((self.samDestPubBin + peerdestBin) + data))
    log(4, ('hashed=%s' % repr(hashed)))
    sig = self.dest.sign(hashed)
    log(4, ('sig=%s' % repr(sig)))
    hdr = (self.samDestPubBin + sig)
    self.samSession.sendMessage(peerdest, (hdr + data))
