def on_destroysession(self, flds):
    log(4, 'entered')
    server = self.server
    client = server.i2pclient
    globalsessions = server.sessions
    sessionsLock = server.sessionsLock
    read = self.rfile.read
    readline = self.rfile.readline
    write = self.wfile.write
    flush = self.wfile.flush
    sessionsLock.acquire()
    try:
        b64priv = flds[1]
        if (not globalsessions.has_key(b64priv)):
            write('error nosuchsession\n')
        elif (not self.localsessions.has_key(b64priv)):
            write('error notyoursession\n')
        else:
            session = self.localsessions[b64priv]
            del self.localsessions[b64priv]
            del globalsessions[b64priv]
            try:
                session.destroySession()
                write('ok\n')
            except:
                raise
    except:
        logException(4, 'destroy session failed')
        write('error exception\n')
    sessionsLock.release()
    log(4, 'done')
