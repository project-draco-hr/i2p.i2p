{
  if (!_connected)   return;
  if (getTimeLeft() > 0)   return;
  if (getUnackedPacketsSent() > 0)   return;
  if (_options.getInactivityTimeout() <= 0)   return;
  if ((_closeSentOn > 0) || (_closeReceivedOn > 0))   return;
switch (_options.getInactivityAction()) {
case ConnectionOptions.INACTIVITY_ACTION_SEND:
    if (_log.shouldLog(Log.WARN))     _log.warn("Sending some data due to inactivity");
  _receiver.send(null,0,0,true);
break;
case ConnectionOptions.INACTIVITY_ACTION_NOOP:
if (_log.shouldLog(Log.WARN)) _log.warn("Inactivity timer expired, but we aint doin' shit");
break;
case ConnectionOptions.INACTIVITY_ACTION_DISCONNECT:
default :
if (_log.shouldLog(Log.WARN)) _log.warn("Closing connection due to inactivity");
if (_log.shouldLog(Log.DEBUG)) {
StringBuffer buf=new StringBuffer(128);
buf.append("last sent was: ").append(_context.clock().now() - _lastSendTime);
buf.append("ms ago, last received was: ").append(_context.clock().now() - _lastReceivedOn);
buf.append("ms ago, inactivity timeout is: ").append(_options.getInactivityTimeout());
_log.debug(buf.toString());
}
disconnect(true);
break;
}
}
