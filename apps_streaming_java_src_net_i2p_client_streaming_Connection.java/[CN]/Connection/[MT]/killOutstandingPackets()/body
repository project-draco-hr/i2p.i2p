{
  boolean tagsCancelled=false;
synchronized (_outboundPackets) {
    for (Iterator iter=_outboundPackets.values().iterator(); iter.hasNext(); ) {
      PacketLocal pl=(PacketLocal)iter.next();
      if ((pl.getTagsSent() != null) && (pl.getTagsSent().size() > 0))       tagsCancelled=true;
      pl.cancelled();
    }
    _outboundPackets.clear();
    _outboundPackets.notifyAll();
  }
  if (tagsCancelled)   _context.sessionKeyManager().failTags(_remotePeer.getPublicKey());
}
