{
  if (_disconnectScheduledOn < 0) {
    _disconnectScheduledOn=_context.clock().now();
    SimpleScheduler.getInstance().addEvent(new DisconnectEvent(),DISCONNECT_TIMEOUT);
  }
  long now=_context.clock().now();
  if (_resetSentOn + 10 * 1000 > now)   return;
  if (_resetReceived)   return;
  _resetSent=true;
  if (_resetSentOn <= 0)   _resetSentOn=now;
  if ((_remotePeer == null) || (_sendStreamId <= 0))   return;
  PacketLocal reply=new PacketLocal(_context,_remotePeer);
  reply.setFlag(Packet.FLAG_RESET);
  reply.setFlag(Packet.FLAG_SIGNATURE_INCLUDED);
  reply.setSendStreamId(_sendStreamId);
  reply.setReceiveStreamId(_receiveStreamId);
  reply.setOptionalFrom(_connectionManager.getSession().getMyDestination());
  if (_outboundQueue.enqueue(reply)) {
    _unackedPacketsReceived=0;
    _lastSendTime=_context.clock().now();
    resetActivityTimer();
  }
}
