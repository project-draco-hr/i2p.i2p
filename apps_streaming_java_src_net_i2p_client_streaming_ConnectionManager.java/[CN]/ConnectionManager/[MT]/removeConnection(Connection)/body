{
  boolean removed=false;
synchronized (_connectionLock) {
    Object o=_connectionByInboundId.remove(new Long(con.getReceiveStreamId()));
    removed=(o == con);
    if (_log.shouldLog(Log.DEBUG)) {
      _log.debug("Connection removed? " + removed + " remaining: "+ _connectionByInboundId.size()+ ": "+ con);
    }
    if (!removed && _log.shouldLog(Log.DEBUG)) {
      _log.debug("Failed to remove " + con + "\n"+ _connectionByInboundId.values());
    }
    _connectionLock.notifyAll();
  }
  if (removed) {
    _context.statManager().addRateData("stream.con.lifetimeMessagesSent",con.getLastSendId(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeMessagesReceived",con.getHighestAckedThrough(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeBytesSent",con.getLifetimeBytesSent(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeBytesReceived",con.getLifetimeBytesReceived(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeDupMessagesSent",con.getLifetimeDupMessagesSent(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeDupMessagesReceived",con.getLifetimeDupMessagesReceived(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeRTT",con.getOptions().getRTT(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeCongestionSeenAt",con.getLastCongestionSeenAt(),con.getLifetime());
    _context.statManager().addRateData("stream.con.lifetimeSendWindowSize",con.getOptions().getWindowSize(),con.getLifetime());
  }
}
