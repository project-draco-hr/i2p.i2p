{
  if ((!isNew) && (sequenceNum > 0)) {
    int oldSize=con.getOptions().getWindowSize();
    oldSize>>>=1;
    if (oldSize <= 0)     oldSize=1;
    con.getOptions().setWindowSize(oldSize);
    return true;
  }
 else   if (numResends > 0) {
    int newWindowSize=con.getOptions().getWindowSize();
    newWindowSize/=2;
    if (newWindowSize <= 0)     newWindowSize=1;
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Shrink the window to " + newWindowSize + " (#resends: "+ numResends+ ") for "+ con);
    con.getOptions().setWindowSize(newWindowSize);
  }
 else {
    int newWindowSize=con.getOptions().getWindowSize();
    newWindowSize+=1;
    if (_log.shouldLog(Log.DEBUG))     _log.debug("New window size " + newWindowSize + " (#resends: "+ numResends+ ") for "+ con);
    con.getOptions().setWindowSize(newWindowSize);
  }
  return false;
}
