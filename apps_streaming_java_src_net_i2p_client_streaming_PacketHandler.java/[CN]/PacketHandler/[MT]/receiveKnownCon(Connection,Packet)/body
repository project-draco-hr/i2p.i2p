{
  if (isValidMatch(con.getSendStreamId(),packet.getReceiveStreamId())) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("receive valid: " + packet);
    con.getPacketHandler().receivePacket(packet,con);
  }
 else {
    if (packet.isFlagSet(Packet.FLAG_RESET)) {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("receive reset: " + packet);
      con.getPacketHandler().receivePacket(packet,con);
    }
 else     if (packet.isFlagSet(Packet.FLAG_SYNCHRONIZE)) {
      if ((con.getSendStreamId() == null) || (DataHelper.eq(con.getSendStreamId(),packet.getReceiveStreamId()))) {
        con.setSendStreamId(packet.getReceiveStreamId());
        con.getPacketHandler().receivePacket(packet,con);
      }
 else {
        if (_log.shouldLog(Log.WARN))         _log.warn("Receive a syn packet with the wrong IDs: " + packet);
      }
    }
 else {
      if (_log.shouldLog(Log.WARN))       _log.warn("Received a packet on the wrong stream: " + packet);
    }
  }
}
