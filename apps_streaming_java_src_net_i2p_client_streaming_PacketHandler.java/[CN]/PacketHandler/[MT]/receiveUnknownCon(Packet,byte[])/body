{
  if (packet.isFlagSet(Packet.FLAG_ECHO)) {
    if (packet.getSendStreamId() != null) {
      receivePing(packet);
    }
 else     if (packet.getReceiveStreamId() != null) {
      receivePong(packet);
    }
 else {
      if (_log.shouldLog(Log.WARN))       _log.warn("Echo packet received with no stream IDs: " + packet);
    }
    packet.releasePayload();
  }
 else {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Packet received on an unknown stream (and not an ECHO): " + packet);
    if (sendId == null) {
      Connection con=_manager.getConnectionByOutboundId(packet.getReceiveStreamId());
      if (con != null) {
        if (con.getAckedPackets() <= 0) {
          if (_log.shouldLog(Log.DEBUG))           _log.debug("Received additional packets before the syn on " + con + ": "+ packet);
          receiveKnownCon(con,packet);
          return;
        }
 else {
          if (_log.shouldLog(Log.DEBUG))           _log.debug("hrmph, received while ack of syn was in flight on " + con + ": "+ packet+ " acked: "+ con.getAckedPackets());
          receiveKnownCon(con,packet);
          return;
        }
      }
    }
    if (packet.isFlagSet(Packet.FLAG_SYNCHRONIZE)) {
      _manager.getConnectionHandler().receiveNewSyn(packet);
    }
 else {
      if (_log.shouldLog(Log.WARN)) {
        StringBuffer buf=new StringBuffer(128);
        Set cons=_manager.listConnections();
        for (Iterator iter=cons.iterator(); iter.hasNext(); ) {
          Connection con=(Connection)iter.next();
          buf.append(con.toString()).append(" ");
        }
        _log.warn("Packet belongs to no other cons: " + packet + " connections: "+ buf.toString()+ " sendId: "+ (sendId != null ? Base64.encode(sendId) : " unknown"));
      }
      packet.releasePayload();
    }
  }
}
