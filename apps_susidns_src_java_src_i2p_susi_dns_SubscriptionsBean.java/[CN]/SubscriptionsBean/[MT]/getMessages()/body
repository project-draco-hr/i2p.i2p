{
  String message="";
  if (action != null) {
    if (lastSerial != null && serial != null && serial.compareTo(lastSerial) == 0) {
      if (action.compareToIgnoreCase("save") == 0) {
        save();
        String nonce=System.getProperty("addressbook.nonce");
        if (nonce != null) {
          message="Subscriptions saved, updating addressbook from subscription sources now." + "<img height=\"1\" width=\"1\" alt=\"\" " + "src=\"/addressbook/?wakeup=1&nonce=" + nonce + "\">";
        }
 else {
          message="Subscriptions saved.";
        }
      }
 else       if (action.compareToIgnoreCase("reload") == 0) {
        reload();
        message="Subscriptions reloaded.";
      }
    }
 else {
      message="Invalid form submission, probably because you used the 'back' or 'reload' button on your browser. Please resubmit.";
    }
  }
  if (message.length() > 0)   message="<p class=\"messages\">" + message + "</p>";
  return message;
}
