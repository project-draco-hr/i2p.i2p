{
  String str=request.getParameter(PAGESIZE);
  if (str != null && str.length() > 0) {
    try {
      int pageSize=Integer.parseInt(str);
      int oldPageSize=sessionObject.folder.getPageSize();
      if (pageSize != oldPageSize)       sessionObject.folder.setPageSize(pageSize);
    }
 catch (    NumberFormatException nfe) {
      sessionObject.error+=_("Invalid pagesize number, resetting to default value.") + "<br>";
    }
  }
  if (buttonPressed(request,PREVPAGE)) {
    sessionObject.pageChanged=true;
    sessionObject.folder.previousPage();
  }
 else   if (buttonPressed(request,NEXTPAGE)) {
    sessionObject.pageChanged=true;
    sessionObject.folder.nextPage();
  }
 else   if (buttonPressed(request,FIRSTPAGE)) {
    sessionObject.pageChanged=true;
    sessionObject.folder.firstPage();
  }
 else   if (buttonPressed(request,LASTPAGE)) {
    sessionObject.pageChanged=true;
    sessionObject.folder.lastPage();
  }
 else   if (buttonPressed(request,DELETE)) {
    int m=getCheckedMessage(request);
    if (m != -1)     sessionObject.reallyDelete=true;
 else     sessionObject.error+=_("No messages marked for deletion.") + "<br>";
  }
 else {
    int numberDeleted=0;
    if (buttonPressed(request,REALLYDELETE)) {
      for (Enumeration e=request.getParameterNames(); e.hasMoreElements(); ) {
        String parameter=(String)e.nextElement();
        if (parameter.startsWith("check") && request.getParameter(parameter).compareTo("1") == 0) {
          String number=parameter.substring(5);
          try {
            int n=Integer.parseInt(number);
            String uidl=(String)sessionObject.folder.getElementAtPosXonCurrentPage(n);
            if (uidl != null) {
              Mail mail=sessionObject.mailCache.getMail(uidl,MailCache.FETCH_HEADER);
              if (mail != null) {
                if (sessionObject.mailbox.delete(uidl)) {
                  mail.markForDeletion=true;
                  numberDeleted++;
                }
 else                 sessionObject.error+=_("Error deleting message: {0}",sessionObject.mailbox.lastError()) + "<br>";
              }
            }
          }
 catch (          NumberFormatException nfe) {
          }
        }
      }
      sessionObject.mailbox.performDelete();
      sessionObject.folder.setElements(sessionObject.mailbox.getUIDLs());
      sessionObject.pageChanged=true;
      sessionObject.info+=ngettext("1 message deleted.","{0} messages deleted.",numberDeleted);
    }
    sessionObject.reallyDelete=false;
  }
  sessionObject.markAll=buttonPressed(request,MARKALL);
  sessionObject.clear=buttonPressed(request,CLEAR);
  sessionObject.invert=buttonPressed(request,INVERT);
  processSortingButton(sessionObject,request,SORT_ID);
  processSortingButton(sessionObject,request,SORT_SENDER);
  processSortingButton(sessionObject,request,SORT_SUBJECT);
  processSortingButton(sessionObject,request,SORT_DATE);
  processSortingButton(sessionObject,request,SORT_SIZE);
}
