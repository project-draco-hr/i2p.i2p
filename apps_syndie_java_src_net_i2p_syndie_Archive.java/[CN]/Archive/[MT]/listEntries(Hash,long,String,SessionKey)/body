{
  List rv=new ArrayList();
  BlogInfo info=getBlogInfo(blog);
  if (info == null)   return rv;
  File blogDir=new File(_rootDir,blog.toBase64());
  File entries[]=blogDir.listFiles(_entryFilenameFilter);
  if (entries == null)   return rv;
  for (int i=0; i < entries.length; i++) {
    try {
      EntryContainer entry=null;
      if (blogKey == null) {
        File entryDir=getEntryDir(entries[i]);
        if (entryDir.exists())         entry=getCachedEntry(entryDir);
        if ((entry == null) || !entryDir.exists()) {
          if (!extractEntry(entries[i],entryDir,info)) {
            _log.error("Entry " + entries[i].getPath() + " is not valid");
            entries[i].delete();
            continue;
          }
          entry=getCachedEntry(entryDir);
        }
      }
 else {
        entry=new EntryContainer();
        FileInputStream fi=null;
        try {
          fi=new FileInputStream(entries[i]);
          entry.load(fi);
        }
  finally {
          if (fi != null)           try {
            fi.close();
          }
 catch (          IOException ioe) {
          }
        }
        boolean ok=entry.verifySignature(_context,info);
        if (!ok) {
          _log.error("Keyed entry " + entries[i].getPath() + " is not valid");
          entries[i].delete();
          continue;
        }
        entry.parseRawData(_context,blogKey);
        entry.setCompleteSize((int)entries[i].length());
      }
      if (entryId >= 0) {
        if (entry.getURI().getEntryId() == entryId) {
          rv.add(entry);
          return rv;
        }
      }
 else       if (tag != null) {
        String tags[]=entry.getTags();
        for (int j=0; j < tags.length; j++) {
          if (tags[j].equals(tag)) {
            rv.add(entry);
            if (_log.shouldLog(Log.DEBUG))             _log.debug("cached entry matched requested tag [" + tag + "]: "+ entry.getURI());
            break;
          }
        }
      }
 else {
        if (_log.shouldLog(Log.DEBUG))         _log.debug("cached entry is ok and no id or tag was requested: " + entry.getURI());
        rv.add(entry);
      }
    }
 catch (    IOException ioe) {
      _log.error("Error listing entries",ioe);
    }
  }
  return rv;
}
