{
  if (isSingleUser()) {
    Hash userHash=_context.sha().calculateHash(DataHelper.getUTF8(getDefaultLogin()));
    File userFile=new File(_userDir,Base64.encode(userHash.getData()));
    if (_log.shouldLog(Log.INFO))     _log.info("Attempting to login to the default user: " + userFile.getAbsolutePath());
    if (userFile.exists()) {
      Properties props=loadUserProps(userFile);
      if (props == null) {
        user.invalidate();
        _log.error("Error reading the default user file: " + userFile);
        return;
      }
      String ok=user.login(getDefaultLogin(),getDefaultPass(),props);
      if (User.LOGIN_OK.equals(ok)) {
        return;
      }
 else {
        user.invalidate();
        _log.error("Error logging into the default user: " + ok);
        return;
      }
    }
 else {
      String ok=register(user,getDefaultLogin(),getDefaultPass(),"","default","Default Syndie blog","");
      if (User.LOGIN_OK.equals(ok)) {
        _log.info("Default user created: " + user);
        String altArchives=_context.getProperty("syndie.defaultSingleUserArchives");
        String archives[]=DEFAULT_SINGLE_USER_ARCHIVES;
        if ((altArchives != null) && (altArchives.trim().length() > 0)) {
          ArrayList list=new ArrayList();
          StringTokenizer tok=new StringTokenizer(altArchives,",\t ");
          while (tok.hasMoreTokens())           list.add(tok.nextToken());
          if (list.size() > 0) {
            archives=new String[list.size()];
            for (int i=0; i < list.size(); i++)             archives[i]=(String)list.get(i);
          }
        }
        for (int i=0; i < archives.length; i++)         user.getPetNameDB().add(new PetName("DefaultArchive" + i,"syndie","syndiearchive",archives[i]));
        scheduleSyndication(archives);
        saveUser(user);
        return;
      }
 else {
        user.invalidate();
        _log.error("Error registering the default user: " + ok);
        return;
      }
    }
  }
 else {
    return;
  }
}
