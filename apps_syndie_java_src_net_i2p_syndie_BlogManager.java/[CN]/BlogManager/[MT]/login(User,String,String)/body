{
  if ((login == null) || (pass == null))   return "<span class=\"b_loginMsgErr\">Login not specified</span>";
  Hash userHash=_context.sha().calculateHash(DataHelper.getUTF8(login));
  Hash passHash=_context.sha().calculateHash(DataHelper.getUTF8(pass));
  File userFile=new File(_userDir,Base64.encode(userHash.getData()));
  System.out.println("Attempting to login to " + login + " w/ pass = "+ pass+ ": file = "+ userFile.getAbsolutePath()+ " passHash = "+ Base64.encode(passHash.getData()));
  if (userFile.exists()) {
    try {
      Properties props=new Properties();
      FileInputStream fin=new FileInputStream(userFile);
      BufferedReader in=new BufferedReader(new InputStreamReader(fin,"UTF-8"));
      String line=null;
      while ((line=in.readLine()) != null) {
        int split=line.indexOf('=');
        if (split <= 0)         continue;
        String key=line.substring(0,split);
        String val=line.substring(split + 1);
        props.setProperty(key.trim(),val.trim());
      }
      return user.login(login,pass,props);
    }
 catch (    IOException ioe) {
      ioe.printStackTrace();
      return "<span class=\"b_loginMsgErr\">Error logging in - corrupt userfile</span>";
    }
  }
 else {
    return "<span class=\"b_loginMsgErr\">User does not exist</span>";
  }
}
