{
  FileOutputStream out=null;
  try {
    out=new FileOutputStream(new File(entryDir,ATTACHMENT_PREFIX + num + ATTACHMENT_META_SUFFIX));
    Map meta=attachment.getMeta();
    for (Iterator iter=meta.keySet().iterator(); iter.hasNext(); ) {
      String k=(String)iter.next();
      String v=(String)meta.get(k);
      out.write(DataHelper.getUTF8(k + '=' + v+ '\n'));
    }
    out.write(DataHelper.getUTF8(ATTACHMENT_DATA_SIZE + '=' + attachment.getDataLength()));
  }
  finally {
    out.close();
  }
}
