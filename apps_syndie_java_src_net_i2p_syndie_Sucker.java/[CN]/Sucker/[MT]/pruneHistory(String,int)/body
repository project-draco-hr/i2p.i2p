{
  int i=0;
  String urlHash=sha1(url);
  Iterator iter=_state.history.iterator();
  while (iter.hasNext()) {
    String historyLine=(String)iter.next();
    if (historyLine.startsWith(urlHash)) {
      i++;
    }
  }
  i=i - nrToKeep;
  if (i > 0) {
    iter=_state.history.iterator();
    while (i > 0 && iter.hasNext()) {
      String historyLine=(String)iter.next();
      if (historyLine.startsWith(urlHash)) {
        iter.remove();
        i--;
      }
    }
  }
}
