{
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  ZipOutputStream out=new ZipOutputStream(baos);
  ZipEntry ze=new ZipEntry(ZIP_ENTRY);
  byte data[]=DataHelper.getUTF8(_entryData.getText());
  ze.setTime(0);
  out.putNextEntry(ze);
  out.write(data);
  out.closeEntry();
  for (int i=0; (_attachments != null) && (i < _attachments.length); i++) {
    ze=new ZipEntry(ZIP_ATTACHMENT_PREFIX + i + ZIP_ATTACHMENT_SUFFIX);
    data=_attachments[i].getData();
    out.putNextEntry(ze);
    out.write(data);
    out.closeEntry();
    ze=new ZipEntry(ZIP_ATTACHMENT_META_PREFIX + i + ZIP_ATTACHMENT_META_SUFFIX);
    data=_attachments[i].getRawMetadata();
    out.putNextEntry(ze);
    out.write(data);
    out.closeEntry();
  }
  out.finish();
  out.close();
  return baos.toByteArray();
}
