{
  Archive archive=BlogManager.instance().getArchive();
  if (regenerateIndex)   archive.regenerateIndex();
  ArchiveIndex index=archive.getIndex();
  List entries=pickEntryURIs(user,index,blog,tag,entryId,group);
  HTMLRenderer renderer=new HTMLRenderer(I2PAppContext.getGlobalContext());
  int start=pageNum * numPerPage;
  int end=start + numPerPage;
  int pages=1;
  if (entries.size() <= 1) {
    start=0;
    end=1;
  }
 else {
    if (end >= entries.size())     end=entries.size();
    if ((pageNum < 0) || (numPerPage <= 0)) {
      start=0;
      end=entries.size() - 1;
    }
 else {
      pages=entries.size() / numPerPage;
      if (numPerPage * pages < entries.size())       pages++;
      if (pageNum > 0) {
        String prevURL=null;
        if ((selector == null) || (selector.trim().length() <= 0))         prevURL=HTMLRenderer.getPageURL(blog,tag,entryId,group,numPerPage,pageNum - 1,expandEntries,showImages);
 else         prevURL=HTMLRenderer.getPageURL(user,selector,numPerPage,pageNum - 1);
        out.write(" <a class=\"b_selectorPrevMore\" href=\"" + prevURL + "\">&lt;&lt;</a>");
      }
 else {
        out.write(" <span class=\"b_selectorPrevNone\">&lt;&lt;</span> ");
      }
      out.write("<span class=\"b_selectorPage\">Page " + (pageNum + 1) + " of "+ pages+ "</span>");
      if (pageNum + 1 < pages) {
        String nextURL=null;
        if ((selector == null) || (selector.trim().length() <= 0))         nextURL=HTMLRenderer.getPageURL(blog,tag,entryId,group,numPerPage,pageNum + 1,expandEntries,showImages);
 else         nextURL=HTMLRenderer.getPageURL(user,selector,numPerPage,pageNum + 1);
        out.write(" <a class=\"b_selectorNextMore\" href=\"" + nextURL + "\">&gt;&gt;</a>");
      }
 else {
        out.write(" <span class=\"b_selectorNextNone\">&gt;&gt;</span>");
      }
    }
  }
  if (afterPagination != null)   out.write(afterPagination);
  if (entries.size() <= 0)   end=-1;
  for (int i=start; i < end; i++) {
    BlogURI uri=(BlogURI)entries.get(i);
    EntryContainer c=archive.getEntry(uri);
    try {
      if (c == null)       renderer.renderUnknownEntry(user,archive,uri,out);
 else       renderer.render(user,archive,c,out,!expandEntries,showImages);
    }
 catch (    RuntimeException e) {
      e.printStackTrace();
      throw e;
    }
  }
}
