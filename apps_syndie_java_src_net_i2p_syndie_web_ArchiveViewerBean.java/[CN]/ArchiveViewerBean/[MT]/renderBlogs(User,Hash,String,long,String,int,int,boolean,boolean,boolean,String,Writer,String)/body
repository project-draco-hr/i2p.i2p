{
  Archive archive=BlogManager.instance().getArchive();
  if (regenerateIndex)   archive.regenerateIndex();
  ArchiveIndex index=archive.getIndex();
  List entries=pickEntryURIs(user,index,blog,tag,entryId,group);
  System.out.println("Searching for " + blog + "/"+ tag+ "/"+ entryId+ "/"+ pageNum+ "/"+ numPerPage+ "/"+ group);
  System.out.println("Entry URIs: " + entries);
  HTMLRenderer renderer=new HTMLRenderer();
  int start=pageNum * numPerPage;
  int end=start + numPerPage;
  int pages=1;
  if (entries.size() <= 1) {
    start=0;
    end=1;
  }
 else {
    if (end >= entries.size())     end=entries.size();
    if ((pageNum < 0) || (numPerPage <= 0)) {
      start=0;
      end=entries.size() - 1;
    }
 else {
      pages=entries.size() / numPerPage;
      if (numPerPage * pages < entries.size())       pages++;
      out.write("<i>");
      if (pageNum > 0) {
        String prevURL=null;
        if ((selector == null) || (selector.trim().length() <= 0))         prevURL=HTMLRenderer.getPageURL(blog,tag,entryId,group,numPerPage,pageNum - 1,expandEntries,showImages);
 else         prevURL=HTMLRenderer.getPageURL(user,selector,numPerPage,pageNum - 1);
        System.out.println("prevURL: " + prevURL);
        out.write(" <a href=\"" + prevURL + "\">&lt;&lt;</a>");
      }
 else {
        out.write(" &lt;&lt; ");
      }
      out.write("Page " + (pageNum + 1) + " of "+ pages);
      if (pageNum + 1 < pages) {
        String nextURL=null;
        if ((selector == null) || (selector.trim().length() <= 0))         nextURL=HTMLRenderer.getPageURL(blog,tag,entryId,group,numPerPage,pageNum + 1,expandEntries,showImages);
 else         nextURL=HTMLRenderer.getPageURL(user,selector,numPerPage,pageNum + 1);
        System.out.println("nextURL: " + nextURL);
        out.write(" <a href=\"" + nextURL + "\">&gt;&gt;</a>");
      }
 else {
        out.write(" &gt;&gt;");
      }
      out.write("</i>");
    }
  }
  if (afterPagination != null)   out.write(afterPagination);
  if (entries.size() <= 0)   end=-1;
  System.out.println("Entries.size: " + entries.size() + " start="+ start+ " end="+ end);
  for (int i=start; i < end; i++) {
    BlogURI uri=(BlogURI)entries.get(i);
    EntryContainer c=archive.getEntry(uri);
    try {
      if (c == null)       renderer.renderUnknownEntry(user,archive,uri,out);
 else       renderer.render(user,archive,c,out,!expandEntries,showImages);
    }
 catch (    RuntimeException e) {
      e.printStackTrace();
      throw e;
    }
  }
}
