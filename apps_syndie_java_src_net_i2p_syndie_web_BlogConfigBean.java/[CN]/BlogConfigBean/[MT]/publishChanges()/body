{
  FileInputStream logo=null;
  try {
    if (_logo != null)     logo=new FileInputStream(_logo);
    InputStream styleStream=createStyleStream();
    InputStream groupStream=createGroupStream();
    String tags=BlogInfoData.TAG;
    String subject="n/a";
    String headers="";
    String sml="";
    List filenames=new ArrayList();
    List filestreams=new ArrayList();
    List filetypes=new ArrayList();
    if (logo != null) {
      filenames.add(BlogInfoData.ATTACHMENT_LOGO);
      filestreams.add(logo);
      filetypes.add("image/png");
    }
    filenames.add(BlogInfoData.ATTACHMENT_STYLE_OVERRIDE);
    filestreams.add(styleStream);
    filetypes.add("text/plain");
    filenames.add(BlogInfoData.ATTACHMENT_REFERENCE_GROUPS);
    filestreams.add(groupStream);
    filetypes.add("text/plain");
    BlogURI uri=BlogManager.instance().createBlogEntry(_user,subject,tags,headers,sml,filenames,filestreams,filetypes);
    if (uri != null) {
      Archive archive=BlogManager.instance().getArchive();
      BlogInfo info=archive.getBlogInfo(_user.getBlog());
      if (info != null) {
        String props[]=info.getProperties();
        Properties opts=new Properties();
        for (int i=0; i < props.length; i++) {
          if (!props[i].equals(BlogInfo.SUMMARY_ENTRY_ID))           opts.setProperty(props[i],info.getProperty(props[i]));
        }
        opts.setProperty(BlogInfo.SUMMARY_ENTRY_ID,uri.toString());
        boolean updated=BlogManager.instance().updateMetadata(_user,_user.getBlog(),opts);
        if (updated) {
          _log.info("Blog summary updated for " + _user + " in "+ uri.toString());
          return true;
        }
      }
 else {
        _log.error("Info is not known for " + _user.getBlog().toBase64());
        return false;
      }
    }
 else {
      _log.error("Error creating the summary entry");
      return false;
    }
  }
  finally {
    if (logo != null)     try {
      logo.close();
    }
 catch (    IOException ioe) {
    }
  }
  return false;
}
