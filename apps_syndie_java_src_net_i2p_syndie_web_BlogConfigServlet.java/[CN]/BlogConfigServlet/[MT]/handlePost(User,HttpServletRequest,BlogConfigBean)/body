{
  StringBuffer rv=new StringBuffer(64);
  MultiPartRequest req=new MultiPartRequest(rawRequest);
  if (authAction(req.getString(PARAM_AUTH_ACTION))) {
    String filename=req.getFilename("newLogo");
    if ((filename != null) && (filename.trim().length() > 0)) {
      Hashtable params=req.getParams("newLogo");
      String type="image/png";
      for (Iterator iter=params.keySet().iterator(); iter.hasNext(); ) {
        String cur=(String)iter.next();
        if ("content-type".equalsIgnoreCase(cur)) {
          type=(String)params.get(cur);
          break;
        }
      }
      InputStream logoSrc=req.getInputStream("newLogo");
      File tmpLogo=File.createTempFile("blogLogo",".png",BlogManager.instance().getTempDir());
      FileOutputStream out=null;
      try {
        out=new FileOutputStream(tmpLogo);
        byte buf[]=new byte[4096];
        int read=0;
        while ((read=logoSrc.read(buf)) != -1)         out.write(buf,0,read);
      }
  finally {
        if (out != null)         try {
          out.close();
        }
 catch (        IOException ioe) {
        }
      }
      long len=tmpLogo.length();
      if (len > BlogInfoData.MAX_LOGO_SIZE) {
        tmpLogo.delete();
        rv.append("Proposed logo is too large (" + len + ", max of "+ BlogInfoData.MAX_LOGO_SIZE+ ")<br />\n");
      }
 else {
        bean.setLogo(tmpLogo);
        rv.append("Logo updated<br />");
      }
    }
 else {
    }
  }
 else {
  }
  return rv;
}
