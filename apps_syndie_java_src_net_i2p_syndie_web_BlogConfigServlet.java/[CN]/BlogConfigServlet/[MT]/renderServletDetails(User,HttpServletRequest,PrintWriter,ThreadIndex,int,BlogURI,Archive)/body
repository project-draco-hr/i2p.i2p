{
  if ((user == null) || (!user.getAuthenticated() && !BlogManager.instance().isSingleUser())) {
    out.write("You must be logged in to edit your profile");
    return;
  }
  BlogConfigBean bean=getConfigBean(req,user);
  String screen=req.getParameter(PARAM_CONFIG_SCREEN);
  if (screen == null)   screen=SCREEN_REFERENCES;
  out.write("<tr><td colspan=\"3\">\n");
  showConfigNav(req,out);
  if (isAuthed(req)) {
    StringBuffer buf=handleOtherAuthedActions(user,req,bean);
    if (buf != null)     out.write(buf.toString());
  }
 else {
    String contentType=req.getContentType();
    if (!empty(contentType) && (contentType.indexOf("boundary=") != -1)) {
      StringBuffer buf=handlePost(user,req,bean);
      if (buf != null)       out.write(buf.toString());
    }
  }
  if (bean.isUpdated())   showCommitForm(req,out);
  if (SCREEN_REFERENCES.equals(screen)) {
    displayReferencesScreen(req,out,user,bean);
  }
 else   if (SCREEN_IMAGES.equals(screen)) {
    displayImagesScreen(req,out,user,bean);
  }
 else {
    displayUnknownScreen(out,screen);
  }
  out.write("</td></tr>\n");
}
