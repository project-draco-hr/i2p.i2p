{
  _fetchIndexInProgress=true;
  _remoteIndex=null;
  _remoteLocation=location;
  _remoteSchema=schema;
  _proxyHost=null;
  _proxyPort=-1;
  _exportCapable=false;
  if (user == null)   user=BlogManager.instance().getDefaultUser();
  if ((schema == null) || (schema.trim().length() <= 0) || (location == null)|| (location.trim().length() <= 0)) {
    _statusMessages.add("Location must be specified [" + location + "] ["+ schema+ "]");
    _fetchIndexInProgress=false;
    return;
  }
  if ("web".equals(schema)) {
    if ((proxyHost != null) && (proxyHost.trim().length() > 0) && (proxyPort != null)&& (proxyPort.trim().length() > 0)) {
      _proxyHost=proxyHost;
      try {
        _proxyPort=Integer.parseInt(proxyPort);
      }
 catch (      NumberFormatException nfe) {
        _statusMessages.add("Proxy port " + HTMLRenderer.sanitizeString(proxyPort) + " is invalid");
        _fetchIndexInProgress=false;
        return;
      }
    }
  }
 else {
    _statusMessages.add(new String("Remote schema " + HTMLRenderer.sanitizeString(schema) + " currently not supported"));
    _fetchIndexInProgress=false;
    return;
  }
  _statusMessages.add("Fetching index from " + HTMLRenderer.sanitizeString(_remoteLocation) + (_proxyHost != null ? " via " + HTMLRenderer.sanitizeString(_proxyHost) + ":"+ _proxyPort : ""));
  File archiveFile;
  if (user.getBlog() != null) {
    archiveFile=new File(BlogManager.instance().getTempDir(),user.getBlog().toBase64() + "_remoteArchive.txt");
  }
 else {
    archiveFile=new File(BlogManager.instance().getTempDir(),"remoteArchive.txt");
  }
  archiveFile.delete();
  Properties etags=new Properties();
  try {
    DataHelper.loadProps(etags,new File(BlogManager.instance().getRootDir(),"etags"));
  }
 catch (  IOException ioe) {
  }
  EepGet eep=new EepGet(I2PAppContext.getGlobalContext(),((_proxyHost != null) && (_proxyPort > 0)),_proxyHost,_proxyPort,0,archiveFile.getAbsolutePath(),location,true,etags.getProperty(location));
  eep.addStatusListener(new IndexFetcherStatusListener(archiveFile));
  eep.fetch();
  if (eep.getETag() != null) {
    etags.setProperty(location,eep.getETag());
  }
  try {
    DataHelper.storeProps(etags,new File(BlogManager.instance().getRootDir(),"etags"));
  }
 catch (  IOException ioe) {
  }
}
