{
  int startRoot=DEFAULT_THREADOFFSET;
  if (offset >= 0)   startRoot=offset;
  renderStart(out,format);
  int endRoot=startRoot + (threadCount > 0 ? threadCount : DEFAULT_THREADCOUNT);
  if (endRoot >= index.getRootCount())   endRoot=index.getRootCount() - 1;
  for (int i=startRoot; i <= endRoot; i++) {
    ThreadNode node=index.getRoot(i);
    if (FORMAT_XML.equals(format))     out.write(node.toString());
 else     render(user,node,out);
  }
  renderEnd(out,format);
}
