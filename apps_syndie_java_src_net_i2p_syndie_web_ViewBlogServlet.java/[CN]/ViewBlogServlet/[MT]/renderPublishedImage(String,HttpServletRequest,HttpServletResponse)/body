{
  String blog=req.getParameter(PARAM_BLOG);
  if (blog != null) {
    Archive archive=BlogManager.instance().getArchive();
    byte h[]=Base64.decode(blog);
    if ((h != null) && (h.length == Hash.HASH_LENGTH)) {
      Hash blogHash=new Hash(h);
      BlogInfo info=archive.getBlogInfo(blogHash);
      String entryId=info.getProperty(BlogInfo.SUMMARY_ENTRY_ID);
      _log.debug("Author's entryId: " + entryId);
      if (entryId != null) {
        BlogURI dataURI=new BlogURI(entryId);
        EntryContainer entry=archive.getEntry(dataURI);
        if (entry != null) {
          BlogInfoData data=new BlogInfoData();
          try {
            data.load(entry);
            _log.debug("Blog info data loaded from: " + entryId);
            Attachment toWrite=null;
            if (BlogInfoData.ATTACHMENT_LOGO.equals(requestedImage)) {
              toWrite=data.getLogo();
            }
 else {
              toWrite=data.getOtherAttachment(requestedImage);
            }
            if (toWrite != null) {
              resp.setContentType("image/png");
              resp.setContentLength(toWrite.getDataLength());
              InputStream in=null;
              OutputStream out=null;
              try {
                in=toWrite.getDataStream();
                out=resp.getOutputStream();
                byte buf[]=new byte[4096];
                int read=-1;
                while ((read=in.read(buf)) != -1)                 out.write(buf,0,read);
                _log.debug("Write image from: " + entryId);
                return true;
              }
  finally {
                if (in != null)                 try {
                  in.close();
                }
 catch (                IOException ioe) {
                }
                if (out != null)                 try {
                  out.close();
                }
 catch (                IOException ioe) {
                }
              }
            }
          }
 catch (          IOException ioe) {
            _log.debug("Error reading/writing: " + entryId,ioe);
            data=null;
          }
        }
      }
    }
  }
  return false;
}
