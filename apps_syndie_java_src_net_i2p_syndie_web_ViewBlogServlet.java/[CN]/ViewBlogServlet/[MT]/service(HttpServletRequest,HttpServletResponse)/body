{
  req.setCharacterEncoding("UTF-8");
  String attachment=req.getParameter(PARAM_ATTACHMENT);
  if (attachment != null) {
    if (renderAttachment(req,resp,attachment))     return;
  }
  String img=req.getParameter(PARAM_IMAGE);
  if (img != null) {
    boolean rendered=renderUpdatedImage(img,req,resp);
    if (!rendered)     rendered=renderPublishedImage(img,req,resp);
    if (!rendered)     rendered=renderDefaultImage(img,req,resp);
    if (rendered)     return;
  }
  super.service(req,resp);
}
