{
  if ((visibleEntry != null) && (empty(req,ThreadedHTMLRenderer.PARAM_OFFSET))) {
    threadOffset=index.getRoot(visibleEntry);
  }
  if (threadOffset < 0)   threadOffset=0;
  out.write("<!-- threads begin -->\n");
  if (threadOffset + numThreads > index.getRootCount())   numThreads=index.getRootCount() - threadOffset;
  TreeRenderState state=new TreeRenderState(new ArrayList());
  int written=0;
  for (int curRoot=threadOffset; curRoot < numThreads + threadOffset; curRoot++) {
    ThreadNode node=index.getRoot(curRoot);
    out.write("<!-- thread begin curRoot=" + curRoot + " threadOffset="+ threadOffset+ " -->\n");
    renderThread(user,out,index,archive,req,node,0,visibleEntry,state);
    out.write("<!-- thread end -->\n");
    written++;
  }
  if (written <= 0)   out.write("<tr class=\"threadEven\"><td colspan=\"3\">No matching threads</td></tr>\n");
  out.write("<!-- threads end -->\n");
}
