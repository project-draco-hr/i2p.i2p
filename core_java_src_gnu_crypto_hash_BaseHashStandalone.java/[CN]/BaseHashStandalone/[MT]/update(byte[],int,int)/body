{
  int n=(int)(count % blockSize);
  count+=len;
  int partLen=blockSize - n;
  int i=0;
  if (len >= partLen) {
    System.arraycopy(b,offset,buffer,n,partLen);
    transform(buffer,0);
    for (i=partLen; i + blockSize - 1 < len; i+=blockSize) {
      transform(b,offset + i);
    }
    n=0;
  }
  if (i < len) {
    System.arraycopy(b,offset + i,buffer,n,len - i);
  }
}
