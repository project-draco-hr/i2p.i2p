{
synchronized (asyncBuffers) {
    long before=System.currentTimeMillis();
    long waited=0;
    while (status[nextBuf] != STATUS_FILLED) {
      System.out.println(Thread.currentThread().getName() + ": Next PRNG buffer " + nextBuf+ " isn't ready ("+ status[nextBuf]+ ")");
      asyncBuffers.notifyAll();
      try {
        asyncBuffers.wait();
      }
 catch (      InterruptedException ie) {
      }
      waited=System.currentTimeMillis() - before;
    }
    if (waited > 0)     System.out.println(Thread.currentThread().getName() + ": Took " + waited+ "ms for a full PRNG buffer to be found");
    buffer=asyncBuffers[nextBuf];
    status[nextBuf]=STATUS_LIVE;
    int prev=nextBuf - 1;
    if (prev < 0)     prev=BUFFERS - 1;
    if (status[prev] == STATUS_LIVE)     status[prev]=STATUS_NEED_FILL;
    nextBuf++;
    if (nextBuf >= BUFFERS)     nextBuf=0;
    asyncBuffers.notify();
  }
}
