{
  if (dest == null)   throw new I2PSessionException("No destination specified");
  if (payload == null)   throw new I2PSessionException("No payload specified");
  Payload data=new Payload();
  int size=payload.length + RandomSource.getInstance().nextInt(1024);
  byte encr[]=ElGamalAESEngine.encrypt(payload,dest.getPublicKey(),key,tags,tag,newKey,size);
  data.setEncryptedData(encr);
  _log.debug("Encrypting the payload to public key " + dest.getPublicKey().toBase64() + "\nPayload: "+ data.calculateHash());
  return data;
}
