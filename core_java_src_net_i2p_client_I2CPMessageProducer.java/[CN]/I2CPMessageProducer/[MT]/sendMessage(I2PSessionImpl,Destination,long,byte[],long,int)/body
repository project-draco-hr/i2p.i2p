{
  if (!updateBps(payload.length,expires))   return;
  SendMessageMessage msg;
  if (expires > 0 || flags > 0) {
    SendMessageExpiresMessage smsg=new SendMessageExpiresMessage();
    smsg.setExpiration(expires);
    smsg.setFlags(flags);
    msg=smsg;
  }
 else   msg=new SendMessageMessage();
  msg.setDestination(dest);
  msg.setSessionId(session.getSessionId());
  msg.setNonce(nonce);
  Payload data=createPayload(dest,payload,null,null,null,null);
  msg.setPayload(data);
  session.sendMessage(msg);
}
