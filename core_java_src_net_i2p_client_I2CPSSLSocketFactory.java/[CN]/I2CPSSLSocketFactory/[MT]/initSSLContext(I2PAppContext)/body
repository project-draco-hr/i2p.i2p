{
  KeyStore ks;
  try {
    ks=KeyStore.getInstance(KeyStore.getDefaultType());
    ks.load(null,"".toCharArray());
  }
 catch (  GeneralSecurityException gse) {
    _log.error("Key Store init error",gse);
    return;
  }
catch (  IOException ioe) {
    _log.error("Key Store init error",ioe);
    return;
  }
  File dir=new File(context.getConfigDir(),CERT_DIR);
  int adds=addCerts(dir,ks);
  int totalAdds=adds;
  if (adds > 0 && _log.shouldLog(Log.INFO))   _log.info("Loaded " + adds + " trusted certificates from "+ dir.getAbsolutePath());
  File dir2=new File(System.getProperty("user.dir"),CERT_DIR);
  if (!dir.getAbsolutePath().equals(dir2.getAbsolutePath())) {
    adds=addCerts(dir2,ks);
    totalAdds+=adds;
    if (adds > 0 && _log.shouldLog(Log.INFO))     _log.info("Loaded " + adds + " trusted certificates from "+ dir.getAbsolutePath());
  }
  if (totalAdds > 0) {
    if (_log.shouldLog(Log.INFO))     _log.info("Loaded total of " + totalAdds + " new trusted certificates");
  }
 else {
    _log.error("No trusted certificates loaded (looked in " + dir.getAbsolutePath() + (dir.getAbsolutePath().equals(dir2.getAbsolutePath()) ? "" : (" and " + dir2.getAbsolutePath()))+ ", I2CP SSL client connections will fail. "+ "Copy the file certificates/i2cp.local.crt from the router to the directory.");
    return;
  }
  try {
    SSLContext sslc=SSLContext.getInstance("TLS");
    TrustManagerFactory tmf=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
    tmf.init(ks);
    sslc.init(null,tmf.getTrustManagers(),context.random());
    _factory=sslc.getSocketFactory();
  }
 catch (  GeneralSecurityException gse) {
    _log.error("SSL context init error",gse);
  }
}
