{
  Payload payload=msg.getPayload();
  byte[] data=_context.elGamalAESEngine().decrypt(payload.getEncryptedData(),session.getDecryptionKey());
  if (data == null) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Error decrypting the payload");
    throw new DataFormatException("Unable to decrypt the payload");
  }
  payload.setUnencryptedData(data);
  return payload;
}
