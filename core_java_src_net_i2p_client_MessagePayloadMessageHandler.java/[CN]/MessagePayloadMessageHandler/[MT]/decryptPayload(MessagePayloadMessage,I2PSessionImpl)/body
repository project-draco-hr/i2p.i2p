{
  Payload payload=msg.getPayload();
  byte[] data=_context.elGamalAESEngine().decrypt(payload.getEncryptedData(),session.getDecryptionKey());
  if (data == null) {
    _log.error("Error decrypting the payload to public key " + session.getMyDestination().getPublicKey().toBase64() + "\nPayload: "+ payload.calculateHash());
    throw new DataFormatException("Unable to decrypt the payload");
  }
  payload.setUnencryptedData(data);
  return payload;
}
