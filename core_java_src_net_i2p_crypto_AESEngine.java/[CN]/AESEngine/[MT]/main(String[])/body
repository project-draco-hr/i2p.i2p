{
  SessionKey key=KeyGenerator.getInstance().generateSessionKey();
  byte iv[]=new byte[16];
  RandomSource.getInstance().nextBytes(iv);
  byte sbuf[]=new byte[16];
  RandomSource.getInstance().nextBytes(sbuf);
  byte se[]=AESEngine.getInstance().encrypt(sbuf,key,iv);
  byte sd[]=AESEngine.getInstance().decrypt(se,key,iv);
  _log.debug("Short test: " + DataHelper.eq(sd,sbuf));
  byte lbuf[]=new byte[1024];
  RandomSource.getInstance().nextBytes(sbuf);
  byte le[]=AESEngine.getInstance().safeEncrypt(lbuf,key,iv,2048);
  byte ld[]=AESEngine.getInstance().safeDecrypt(le,key,iv);
  _log.debug("Long test: " + DataHelper.eq(ld,lbuf));
}
