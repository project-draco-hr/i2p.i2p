{
  I2PAppContext ctx=new I2PAppContext();
  SessionKey key=ctx.keyGenerator().generateSessionKey();
  byte iv[]=new byte[16];
  RandomSource.getInstance().nextBytes(iv);
  byte sbuf[]=new byte[16];
  RandomSource.getInstance().nextBytes(sbuf);
  byte se[]=ctx.AESEngine().encrypt(sbuf,key,iv);
  byte sd[]=ctx.AESEngine().decrypt(se,key,iv);
  ctx.logManager().getLog(AESEngine.class).debug("Short test: " + DataHelper.eq(sd,sbuf));
  byte lbuf[]=new byte[1024];
  RandomSource.getInstance().nextBytes(sbuf);
  byte le[]=ctx.AESEngine().safeEncrypt(lbuf,key,iv,2048);
  byte ld[]=ctx.AESEngine().safeDecrypt(le,key,iv);
  ctx.logManager().getLog(AESEngine.class).debug("Long test: " + DataHelper.eq(ld,lbuf));
}
