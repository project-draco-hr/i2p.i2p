{
  if ((iv == null) || (payload == null) || (sessionKey == null)|| (iv.length != 16))   return null;
  ByteArrayOutputStream baos=new ByteArrayOutputStream(paddedSize + 64);
  Hash h=_context.sha().calculateHash(iv);
  try {
    h.writeBytes(baos);
    DataHelper.writeLong(baos,4,payload.length);
    baos.write(payload);
    byte tv[]=baos.toByteArray();
    baos.write(ElGamalAESEngine.getPadding(_context,tv.length,paddedSize));
  }
 catch (  IOException ioe) {
    _log.error("Error writing data",ioe);
    return null;
  }
catch (  DataFormatException dfe) {
    _log.error("Error writing data",dfe);
    return null;
  }
  byte orig[]=baos.toByteArray();
  byte rv[]=new byte[orig.length];
  encrypt(orig,0,rv,0,sessionKey,iv,rv.length);
  return rv;
}
