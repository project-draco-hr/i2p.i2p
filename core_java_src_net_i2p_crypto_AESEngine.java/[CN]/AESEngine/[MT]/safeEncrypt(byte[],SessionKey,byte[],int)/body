{
  if ((iv == null) || (payload == null) || (sessionKey == null)|| (iv.length != 16))   return null;
  int size=Hash.HASH_LENGTH + 4 + payload.length;
  int padding=ElGamalAESEngine.getPaddingSize(size,paddedSize);
  byte data[]=new byte[size + padding];
  SHA256EntryCache.CacheEntry cache=_context.sha().cache().acquire(iv.length);
  Hash h=_context.sha().calculateHash(iv,cache);
  int cur=0;
  System.arraycopy(h.getData(),0,data,cur,Hash.HASH_LENGTH);
  cur+=Hash.HASH_LENGTH;
  _context.sha().cache().release(cache);
  DataHelper.toLong(data,cur,4,payload.length);
  cur+=4;
  System.arraycopy(payload,0,data,cur,payload.length);
  cur+=payload.length;
  byte paddingData[]=ElGamalAESEngine.getPadding(_context,size,paddedSize);
  System.arraycopy(paddingData,0,data,cur,paddingData.length);
  encrypt(data,0,data,0,sessionKey,iv,data.length);
  return data;
}
