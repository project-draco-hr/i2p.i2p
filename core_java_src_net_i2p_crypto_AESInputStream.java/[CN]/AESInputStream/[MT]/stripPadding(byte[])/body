{
  int numPadBytes=(int)data[data.length - 1];
  if ((numPadBytes >= data.length) || (numPadBytes <= 0))   throw new IOException("Invalid number of pad bytes");
  int rv[]=new int[data.length - numPadBytes];
  if (true) {
    for (int i=data.length - numPadBytes; i < data.length; i++) {
      if (data[i] != (byte)numPadBytes) {
        throw new IOException("Incorrect padding on decryption: data[" + i + "] = "+ data[i]+ " not "+ numPadBytes);
      }
    }
  }
  for (int i=0; i < rv.length; i++)   rv[i]=data[i];
  _cumulativePaddingStripped+=numPadBytes;
  return rv;
}
