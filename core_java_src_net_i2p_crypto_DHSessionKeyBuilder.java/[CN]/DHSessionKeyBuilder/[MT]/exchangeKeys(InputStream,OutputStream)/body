{
  DHSessionKeyBuilder builder=new DHSessionKeyBuilder();
  writeBigI(out,builder.getMyPublicValue());
  BigInteger Y=readBigI(in);
  if (Y == null)   return null;
  try {
    builder.setPeerPublicValue(Y);
    return builder;
  }
 catch (  InvalidPublicParameterException ippe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Key exchange failed (hostile peer?)",ippe);
    return null;
  }
}
