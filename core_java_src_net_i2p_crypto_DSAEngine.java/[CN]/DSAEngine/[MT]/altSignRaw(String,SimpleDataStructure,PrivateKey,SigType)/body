{
  int hashlen=hash.length();
  if (type.getHashLen() != hashlen)   throw new IllegalArgumentException("type mismatch hash=" + hash.getClass() + " key="+ type);
  java.security.Signature jsig;
  if (type.getBaseAlgorithm() == SigAlgo.EdDSA)   jsig=new net.i2p.crypto.eddsa.EdDSAEngine();
 else   jsig=java.security.Signature.getInstance(algo);
  jsig.initSign(privKey,_context.random());
  jsig.update(hash.getData());
  return SigUtil.fromJavaSig(jsig.sign(),type);
}
