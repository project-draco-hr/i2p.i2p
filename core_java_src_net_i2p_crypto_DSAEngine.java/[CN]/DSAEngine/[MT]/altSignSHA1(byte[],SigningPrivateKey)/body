{
  java.security.Signature jsig=java.security.Signature.getInstance("SHA1withDSA");
  KeyFactory keyFact=KeyFactory.getInstance("DSA");
  KeySpec spec=new DSAPrivateKeySpec(new NativeBigInteger(1,privateKey.getData()),CryptoConstants.dsap,CryptoConstants.dsaq,CryptoConstants.dsag);
  PrivateKey privKey=keyFact.generatePrivate(spec);
  jsig.initSign(privKey,_context.random());
  jsig.update(data);
  return new Signature(aSN1ToSigBytes(jsig.sign()));
}
