{
  if ((data == null) || (data.length >= 223))   throw new IllegalArgumentException("Data to encrypt must be < 223 bytes at the moment");
  if (publicKey == null)   throw new IllegalArgumentException("Null public key specified");
  ByteArrayOutputStream baos=new ByteArrayOutputStream(256);
  try {
    baos.write(0xFF);
    Hash hash=SHA256Generator.getInstance().calculateHash(data);
    hash.writeBytes(baos);
    baos.write(data);
    baos.flush();
  }
 catch (  Exception e) {
    _log.error("Internal error writing to buffer",e);
    return null;
  }
  byte d2[]=baos.toByteArray();
  byte[] out=new byte[514];
  System.arraycopy(d2,0,out,(d2.length < 257 ? 257 - d2.length : 0),(d2.length > 257 ? 257 : d2.length));
  return out;
}
