{
  if ((key == null) || (key.getData() == null) || (data == null))   throw new NullPointerException("Null arguments for HMAC");
  byte rv[]=new byte[Hash.HASH_LENGTH];
  System.arraycopy(key.getData(),0,rv,0,Hash.HASH_LENGTH);
  if (Hash.HASH_LENGTH >= length)   DataHelper.xor(data,offset,rv,0,rv,0,length);
 else   DataHelper.xor(data,offset,rv,0,rv,0,Hash.HASH_LENGTH);
  return new Hash(rv);
}
