{
  byte preIV[]=new byte[32];
  System.arraycopy(data,0,preIV,0,preIV.length);
  SHA256EntryCache.CacheEntry cache=_context.sha().cache().acquire(32);
  Hash ivHash=_context.sha().calculateHash(preIV,cache);
  byte iv[]=new byte[16];
  System.arraycopy(ivHash.getData(),0,iv,0,16);
  _context.sha().cache().release(cache);
  usedKey.setData(key.getData());
  byte decrypted[]=decryptAESBlock(data,32,data.length - 32,key,iv,preIV,foundTags,foundKey);
  if (decrypted == null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Decrypt with a non session tag, but tags read: " + foundTags.size());
    return decryptNewSession(data,targetPrivateKey,foundTags,usedKey,foundKey);
  }
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Decrypt with an EXISTING session tag successfull, # tags read: " + foundTags.size(),new Exception("Decrypted by"));
  return decrypted;
}
