{
  byte preIV[]=new byte[32];
  System.arraycopy(data,0,preIV,0,preIV.length);
  byte encr[]=new byte[data.length - 32];
  System.arraycopy(data,32,encr,0,encr.length);
  Hash ivHash=SHA256Generator.getInstance().calculateHash(preIV);
  byte iv[]=new byte[16];
  System.arraycopy(ivHash.getData(),0,iv,0,16);
  usedKey.setData(key.getData());
  byte decrypted[]=decryptAESBlock(encr,key,iv,preIV,foundTags,foundKey);
  if (decrypted == null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Decrypt with a non session tag, but tags read: " + foundTags.size());
    return decryptNewSession(data,targetPrivateKey,foundTags,usedKey,foundKey);
  }
 else {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Decrypt with an EXISTING session tag successfull, # tags read: " + foundTags.size(),new Exception("Decrypted by"));
    return decrypted;
  }
}
