{
  if (currentTag == null) {
    if (_log.shouldLog(Log.INFO))     _log.info("Current tag is null, encrypting as new session",new Exception("encrypt new"));
    StatManager.getInstance().updateFrequency("crypto.elGamalAES.encryptNewSession");
    return encryptNewSession(data,target,key,tagsForDelivery,newKey,paddedSize);
  }
 else {
    if (_log.shouldLog(Log.INFO))     _log.info("Current tag is NOT null, encrypting as existing session",new Exception("encrypt existing"));
    StatManager.getInstance().updateFrequency("crypto.elGamalAES.encryptExistingSession");
    return encryptExistingSession(data,target,key,tagsForDelivery,currentTag,newKey,paddedSize);
  }
}
