{
  byte rawTag[]=currentTag.getData();
  SHA256EntryCache.CacheEntry cache=_context.sha().cache().acquire(rawTag.length);
  Hash ivHash=_context.sha().calculateHash(rawTag,cache);
  byte iv[]=new byte[16];
  System.arraycopy(ivHash.getData(),0,iv,0,16);
  _context.sha().cache().release(cache);
  byte aesEncr[]=encryptAESBlock(data,key,iv,tagsForDelivery,newKey,paddedSize,SessionTag.BYTE_LENGTH);
  System.arraycopy(rawTag,0,aesEncr,0,rawTag.length);
  return aesEncr;
}
