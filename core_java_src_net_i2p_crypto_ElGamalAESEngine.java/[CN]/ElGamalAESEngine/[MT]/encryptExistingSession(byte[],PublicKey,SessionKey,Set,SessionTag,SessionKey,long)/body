{
  byte rawTag[]=currentTag.getData();
  Hash ivHash=_context.sha().calculateHash(rawTag);
  byte iv[]=new byte[16];
  System.arraycopy(ivHash.getData(),0,iv,0,16);
  byte aesEncr[]=encryptAESBlock(data,key,iv,tagsForDelivery,newKey,paddedSize);
  byte rv[]=new byte[rawTag.length + aesEncr.length];
  System.arraycopy(rawTag,0,rv,0,rawTag.length);
  System.arraycopy(aesEncr,0,rv,rawTag.length,aesEncr.length);
  return rv;
}
