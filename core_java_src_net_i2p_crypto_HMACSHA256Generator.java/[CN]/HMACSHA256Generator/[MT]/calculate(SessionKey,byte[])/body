{
  if ((key == null) || (key.getData() == null) || (data == null))   throw new NullPointerException("Null arguments for HMAC");
  Hash hkey=SHA256Generator.getInstance().calculateHash(key.getData());
  Hash hdata=SHA256Generator.getInstance().calculateHash(data);
  return SHA256Generator.getInstance().calculateHash(DataHelper.xor(hkey.getData(),hdata.getData()));
}
