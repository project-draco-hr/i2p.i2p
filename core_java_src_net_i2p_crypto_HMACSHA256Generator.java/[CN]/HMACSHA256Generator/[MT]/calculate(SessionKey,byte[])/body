{
  if ((key == null) || (key.getData() == null) || (data == null))   throw new NullPointerException("Null arguments for HMAC");
  Buffer buf=new Buffer(data.length);
  calculate(key,data,buf);
  Hash rv=new Hash(buf.rv);
  buf.releaseCached();
  return rv;
}
