{
  if ((key == null) || (key.getData() == null) || (data == null))   throw new NullPointerException("Null arguments for HMAC");
  Buffer buf=new Buffer(length);
  calculate(key,data,offset,length,buf);
  Hash rv=new Hash(buf.rv);
  buf.releaseCached();
  return rv;
}
