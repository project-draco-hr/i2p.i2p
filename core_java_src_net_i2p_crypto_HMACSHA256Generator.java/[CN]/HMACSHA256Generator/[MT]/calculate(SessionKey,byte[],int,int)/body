{
  if ((key == null) || (key.getData() == null) || (data == null))   throw new NullPointerException("Null arguments for HMAC");
  HMac mac=acquire();
  mac.init(key.getData());
  mac.update(data,offset,length);
  byte rv[]=new byte[Hash.HASH_LENGTH];
  mac.doFinal(rv,0);
  release(mac);
  return new Hash(rv);
}
