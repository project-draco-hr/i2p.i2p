{
  padKey(key.getData(),_IPAD,buf.padded);
  System.arraycopy(buf.padded,0,buf.innerBuf,0,PAD_LENGTH);
  System.arraycopy(data,offset,buf.innerBuf,PAD_LENGTH,length);
  Hash h=_context.sha().calculateHash(buf.innerBuf,buf.innerEntry);
  padKey(key.getData(),_OPAD,buf.padded);
  System.arraycopy(buf.padded,0,buf.outerBuf,0,PAD_LENGTH);
  System.arraycopy(h.getData(),0,buf.outerBuf,PAD_LENGTH,Hash.HASH_LENGTH);
  h=_context.sha().calculateHash(buf.outerBuf,buf.outerEntry);
  System.arraycopy(h.getData(),0,buf.rv,0,Hash.HASH_LENGTH);
}
