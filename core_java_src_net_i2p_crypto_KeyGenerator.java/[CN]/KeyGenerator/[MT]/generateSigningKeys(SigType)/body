{
  if (type == SigType.DSA_SHA1)   return generateSigningKeys();
  KeyPairGenerator kpg=KeyPairGenerator.getInstance("EC");
  kpg.initialize(type.getParams(),_context.random());
  KeyPair kp=kpg.generateKeyPair();
  ECPublicKey pubkey=(ECPublicKey)kp.getPublic();
  ECPrivateKey privkey=(ECPrivateKey)kp.getPrivate();
  SimpleDataStructure[] keys=new SimpleDataStructure[2];
  keys[0]=SigUtil.fromJavaKey(pubkey,type);
  keys[1]=SigUtil.fromJavaKey(privkey,type);
  return keys;
}
