{
  InputStream fis=null;
  try {
    fis=new FileInputStream(file);
    CertificateFactory cf=CertificateFactory.getInstance("X.509");
    X509Certificate cert=(X509Certificate)cf.generateCertificate(fis);
    info("Read X509 Certificate from " + file.getAbsolutePath() + " Issuer: "+ cert.getIssuerX500Principal()+ "; Valid From: "+ cert.getNotBefore()+ " To: "+ cert.getNotAfter());
    try {
      cert.checkValidity();
    }
 catch (    CertificateExpiredException cee) {
      String s="Rejecting expired X509 Certificate: " + file.getAbsolutePath();
      if (SystemVersion.isAndroid())       warn(s,cee);
 else       error(s,cee);
      return false;
    }
catch (    CertificateNotYetValidException cnyve) {
      error("Rejecting X509 Certificate not yet valid: " + file.getAbsolutePath(),cnyve);
      return false;
    }
    ks.setCertificateEntry(alias,cert);
    info("Now trusting X509 Certificate, Issuer: " + cert.getIssuerX500Principal());
  }
 catch (  GeneralSecurityException gse) {
    error("Error reading X509 Certificate: " + file.getAbsolutePath(),gse);
    return false;
  }
catch (  IOException ioe) {
    error("Error reading X509 Certificate: " + file.getAbsolutePath(),ioe);
    return false;
  }
 finally {
    try {
      if (fis != null)       fis.close();
    }
 catch (    IOException foo) {
    }
  }
  return true;
}
