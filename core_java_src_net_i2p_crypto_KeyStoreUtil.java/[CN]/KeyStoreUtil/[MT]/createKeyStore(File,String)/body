{
  boolean exists=ksFile != null && ksFile.exists();
  char[] pwchars=password != null ? password.toCharArray() : null;
  KeyStore ks=KeyStore.getInstance(KeyStore.getDefaultType());
  if (exists) {
    InputStream fis=new FileInputStream(ksFile);
    ks.load(fis,pwchars);
  }
  if (ksFile != null && !exists)   ks.store(new SecureFileOutputStream(ksFile),pwchars);
  return ks;
}
