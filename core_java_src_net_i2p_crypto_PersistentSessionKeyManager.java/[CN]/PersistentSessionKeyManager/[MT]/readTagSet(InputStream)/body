{
  SessionKey key=new SessionKey();
  key.readBytes(in);
  Date date=DataHelper.readDate(in);
  int numTags=(int)DataHelper.readLong(in,2);
  Set tags=new HashSet(numTags);
  for (int i=0; i < numTags; i++) {
    SessionTag tag=new SessionTag();
    byte val[]=new byte[SessionTag.BYTE_LENGTH];
    int read=DataHelper.read(in,val);
    if (read != SessionTag.BYTE_LENGTH)     throw new IOException("Unable to fully read a session tag [" + read + " not "+ SessionTag.BYTE_LENGTH+ ")");
    tag.setData(val);
    tags.add(tag);
  }
  TagSet ts=new TagSet(tags,key,_context.clock().now());
  ts.setDate(date.getTime());
  return ts;
}
