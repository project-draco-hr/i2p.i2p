{
  digest.reset();
  if (publicKey instanceof ElGamalPublicKey) {
    key=(ElGamalPublicKey)publicKey;
  }
 else {
    throw new InvalidKeyException("cannot identify ElGamal public key: " + publicKey.getClass());
  }
}
