{
  if (_type < 0)   throw new DataFormatException("Invalid certificate type: " + _type);
  if ((_type != 0) && (_payload == null))   throw new DataFormatException("Payload is required for non null type");
  DataHelper.writeLong(out,1,(long)_type);
  if (_payload != null) {
    DataHelper.writeLong(out,2,(long)_payload.length);
    out.write(_payload);
  }
 else {
    DataHelper.writeLong(out,2,0L);
  }
}
