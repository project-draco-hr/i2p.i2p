{
  int cur=offset;
  while (cur < length) {
    int numRead=in.read(target,cur,length - cur);
    if (numRead == -1) {
      if (cur == offset)       return -1;
      return cur;
    }
    cur+=numRead;
  }
  return cur;
}
