{
  if (props != null) {
    OrderedProperties p=new OrderedProperties();
    p.putAll(props);
    ByteArrayOutputStream baos=new ByteArrayOutputStream(32);
    for (Iterator iter=p.keySet().iterator(); iter.hasNext(); ) {
      String key=(String)iter.next();
      String val=p.getProperty(key);
      writeString(baos,key);
      baos.write(EQUAL_BYTES);
      writeString(baos,val);
      baos.write(SEMICOLON_BYTES);
    }
    baos.close();
    byte propBytes[]=baos.toByteArray();
    toLong(target,offset,2,propBytes.length);
    offset+=2;
    System.arraycopy(propBytes,0,target,offset,propBytes.length);
    offset+=propBytes.length;
    return offset;
  }
 else {
    toLong(target,offset,2,0);
    return offset + 2;
  }
}
