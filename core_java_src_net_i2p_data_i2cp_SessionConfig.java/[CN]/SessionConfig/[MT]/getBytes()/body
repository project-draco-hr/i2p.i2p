{
  if (_destination == null)   return null;
  if (_options == null)   return null;
  if (_creationDate == null)   return null;
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  try {
    _log.debug("PubKey size for destination: " + _destination.getPublicKey().getData().length);
    _log.debug("SigningKey size for destination: " + _destination.getSigningPublicKey().getData().length);
    _destination.writeBytes(out);
    DataHelper.writeProperties(out,_options);
    DataHelper.writeDate(out,_creationDate);
  }
 catch (  IOException ioe) {
    _log.error("IOError signing",ioe);
    return null;
  }
catch (  DataFormatException dfe) {
    _log.error("Error writing out the bytes for signing/verification",dfe);
    return null;
  }
  return out.toByteArray();
}
