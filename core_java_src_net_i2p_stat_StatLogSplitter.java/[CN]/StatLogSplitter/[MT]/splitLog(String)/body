{
  Map outputFiles=new HashMap(4);
  try {
    BufferedReader in=new BufferedReader(new FileReader(filename));
    String line;
    long first=0;
    while ((line=in.readLine()) != null) {
      String date=line.substring(0,DATE_FORMAT.length()).trim();
      int endGroup=line.indexOf(' ',DATE_FORMAT.length() + 1);
      int endStat=line.indexOf(' ',endGroup + 1);
      int endValue=line.indexOf(' ',endStat + 1);
      String group=line.substring(DATE_FORMAT.length() + 1,endGroup).trim();
      String stat=line.substring(endGroup,endStat).trim();
      String value=line.substring(endStat,endValue).trim();
      String duration=line.substring(endValue).trim();
      try {
        Date when=_fmt.parse(date);
        if (first <= 0)         first=when.getTime();
        long val=Long.parseLong(value);
        long time=Long.parseLong(duration);
        if (!outputFiles.containsKey(stat)) {
          outputFiles.put(stat,new FileWriter(stat + ".dat"));
          System.out.println("Including data to " + stat + ".dat");
        }
        FileWriter out=(FileWriter)outputFiles.get(stat);
        double s=(when.getTime() - first) / 1000.0;
        out.write(s + " " + val+ " ["+ line+ "]\n");
        out.flush();
      }
 catch (      ParseException pe) {
        continue;
      }
catch (      NumberFormatException nfe) {
        continue;
      }
    }
  }
 catch (  IOException ioe) {
    ioe.printStackTrace();
  }
  for (Iterator iter=outputFiles.values().iterator(); iter.hasNext(); ) {
    FileWriter out=(FileWriter)iter.next();
    try {
      out.close();
    }
 catch (    IOException ioe) {
    }
  }
}
