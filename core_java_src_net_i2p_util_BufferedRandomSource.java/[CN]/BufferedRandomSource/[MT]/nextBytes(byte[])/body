{
  int outOffset=0;
  while (outOffset < buf.length) {
    int availableBytes=BUFFER_SIZE - _nextByte - (_nextBit != 0 ? 1 : 0);
    if (availableBytes <= 0)     refillBuffer();
    int start=BUFFER_SIZE - availableBytes;
    int writeSize=Math.min(buf.length - outOffset,availableBytes);
    System.arraycopy(_buffer,start,buf,outOffset,writeSize);
    outOffset+=writeSize;
    _nextByte+=writeSize;
    _nextBit=0;
  }
}
