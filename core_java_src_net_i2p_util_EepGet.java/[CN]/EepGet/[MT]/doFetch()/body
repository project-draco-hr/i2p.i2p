{
  readHeaders();
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Headers read completely, reading " + _bytesRemaining);
  byte buf[]=new byte[1024];
  while (_keepFetching) {
    int read=_proxyIn.read(buf);
    if (read == -1)     break;
    _out.write(buf,0,read);
    _bytesTransferred+=read;
    if (read > 0)     for (int i=0; i < _listeners.size(); i++)     ((StatusListener)_listeners.get(i)).bytesTransferred(_alreadyTransferred,read,_bytesTransferred,_bytesRemaining,_url);
  }
  if (_out != null)   _out.close();
  _out=null;
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Done transferring " + _bytesTransferred);
  if (_bytesRemaining == _bytesTransferred) {
    for (int i=0; i < _listeners.size(); i++)     ((StatusListener)_listeners.get(i)).transferComplete(_alreadyTransferred,_bytesTransferred,_bytesRemaining,_url,_outputFile);
  }
 else {
    throw new IOException("Disconnection on attempt " + _currentAttempt + " after "+ _bytesTransferred);
  }
}
