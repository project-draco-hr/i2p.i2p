{
  ZipFile zip=null;
  try {
    byte buf[]=new byte[16 * 1024];
    zip=new ZipFile(zipfile);
    Enumeration entries=zip.entries();
    while (entries.hasMoreElements()) {
      ZipEntry entry=(ZipEntry)entries.nextElement();
      if (entry.getName().indexOf("..") != -1) {
        return false;
      }
      if (entry.isDirectory()) {
      }
 else {
        try {
          InputStream in=zip.getInputStream(entry);
          int read=0;
          while ((read=in.read(buf)) != -1) {
          }
          in.close();
        }
 catch (        IOException ioe) {
          return false;
        }
      }
    }
    return true;
  }
 catch (  IOException ioe) {
    return false;
  }
 finally {
    if (zip != null) {
      try {
        zip.close();
      }
 catch (      IOException ioe) {
      }
    }
  }
}
