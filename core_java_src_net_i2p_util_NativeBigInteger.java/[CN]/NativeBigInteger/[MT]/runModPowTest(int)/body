{
  System.out.println("DEBUG: Warming up the random number generator...");
  SecureRandom rand=new SecureRandom();
  rand.nextBoolean();
  System.out.println("DEBUG: Random number generator warmed up");
  byte[] _sampleGenerator=CryptoConstants.elgg.toByteArray();
  byte[] _samplePrime=CryptoConstants.elgp.toByteArray();
  BigInteger jg=new BigInteger(_sampleGenerator);
  BigInteger jp=new BigInteger(_samplePrime);
  long totalTime=0;
  long javaTime=0;
  int runsProcessed=0;
  for (runsProcessed=0; runsProcessed < numRuns; runsProcessed++) {
    BigInteger bi=new BigInteger(226,rand);
    NativeBigInteger g=new NativeBigInteger(_sampleGenerator);
    NativeBigInteger p=new NativeBigInteger(_samplePrime);
    NativeBigInteger k=new NativeBigInteger(1,bi.toByteArray());
    long beforeModPow=System.currentTimeMillis();
    BigInteger myValue=g.modPow(k,p);
    long afterModPow=System.currentTimeMillis();
    BigInteger jval=jg.modPow(bi,jp);
    long afterJavaModPow=System.currentTimeMillis();
    totalTime+=(afterModPow - beforeModPow);
    javaTime+=(afterJavaModPow - afterModPow);
    if (!myValue.equals(jval)) {
      System.err.println("ERROR: [" + runsProcessed + "]\tnative modPow != java modPow");
      System.err.println("ERROR: native modPow value: " + myValue.toString());
      System.err.println("ERROR: java modPow value: " + jval.toString());
      System.err.println("ERROR: run time: " + totalTime + "ms ("+ (totalTime / (runsProcessed + 1))+ "ms each)");
      break;
    }
 else {
      System.out.println("DEBUG: current run time: " + (afterModPow - beforeModPow) + "ms (total: "+ totalTime+ "ms, "+ (totalTime / (runsProcessed + 1))+ "ms each)");
    }
  }
  System.out.println("INFO: run time: " + totalTime + "ms ("+ (totalTime / (runsProcessed + 1))+ "ms each)");
  if (numRuns == runsProcessed)   System.out.println("INFO: " + runsProcessed + " runs complete without any errors");
 else   System.out.println("ERROR: " + runsProcessed + " runs until we got an error");
  if (_nativeOk) {
    System.out.println("native run time: \t" + totalTime + "ms ("+ (totalTime / (runsProcessed + 1))+ "ms each)");
    System.out.println("java run time:   \t" + javaTime + "ms ("+ (javaTime / (runsProcessed + 1))+ "ms each)");
    System.out.println("native = " + ((totalTime * 100.0d) / (double)javaTime) + "% of pure java time");
  }
 else {
    System.out.println("java run time: \t" + javaTime + "ms ("+ (javaTime / (runsProcessed + 1))+ "ms each)");
    System.out.println("However, we couldn't load the native library, so this doesn't test much");
  }
}
