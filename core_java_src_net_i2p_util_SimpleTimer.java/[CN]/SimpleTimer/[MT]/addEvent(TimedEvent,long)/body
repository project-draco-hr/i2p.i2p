{
  long eventTime=System.currentTimeMillis() + timeoutMs;
  Long time=new Long(eventTime);
synchronized (_events) {
    if (_eventTimes.containsKey(event))     _events.remove(_eventTimes.get(event));
    while (_events.containsKey(time))     time=new Long(time.longValue() + 1);
    _events.put(time,event);
    _eventTimes.put(event,time);
    if ((_events.size() != _eventTimes.size())) {
      _log.error("Skewed events: " + _events.size() + " for "+ _eventTimes.size());
      for (Iterator iter=_eventTimes.keySet().iterator(); iter.hasNext(); ) {
        TimedEvent evt=(TimedEvent)iter.next();
        Long when=(Long)_eventTimes.get(evt);
        TimedEvent cur=(TimedEvent)_events.get(when);
        if (cur != evt) {
          _log.error("event " + evt + " @ "+ when+ ": "+ cur);
        }
      }
    }
    _events.notifyAll();
  }
}
