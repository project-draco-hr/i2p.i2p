{
  File oldFile=new File(olddir,"i2prouter");
  File newFile=new File(todir,"i2prouter");
  FileInputStream in=null;
  PrintWriter out=null;
  try {
    in=new FileInputStream(oldFile);
    out=new PrintWriter(new BufferedWriter(new FileWriter(newFile)));
    boolean firstTime=true;
    String s=null;
    while ((s=DataHelper.readLine(in)) != null) {
      if (s.equals("WRAPPER_CMD=\"./i2psvc\"")) {
        File f=new File("i2psvc");
        s="WRAPPER_CMD=\"" + f.getAbsolutePath() + "\"";
      }
 else       if (s.equals("WRAPPER_CONF=\"wrapper.config\"")) {
        File f=new File(todir,"wrapper.config");
        s="WRAPPER_CONF=\"" + f.getAbsolutePath() + "\"";
      }
 else       if (s.equals("PIDDIR=\".\"")) {
        s="PIDDIR=\"" + todir.getAbsolutePath() + "\"";
      }
      out.println(s);
      if (firstTime) {
        out.println("# Modified by I2P User dir migration script");
        firstTime=false;
      }
    }
    System.err.println("Copied i2prouter with modifications");
    return true;
  }
 catch (  IOException ioe) {
    if (in != null) {
      System.err.println("FAILED copy i2prouter");
      return false;
    }
    return true;
  }
 finally {
    if (in != null)     try {
      in.close();
    }
 catch (    IOException ioe) {
    }
    if (out != null)     out.close();
  }
}
