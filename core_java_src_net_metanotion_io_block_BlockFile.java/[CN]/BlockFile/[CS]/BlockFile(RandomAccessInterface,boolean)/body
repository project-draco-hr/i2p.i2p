{
  if (rai == null) {
    throw new NullPointerException();
  }
  file=rai;
  if (init) {
    file.setLength(fileLen);
    writeSuperBlock();
    BSkipList.init(this,2,spanSize);
  }
  readSuperBlock();
  if (magicBytes != 0x3141deadbeef0100L) {
    if ((magicBytes & 0x3141deadbeef0000L) == 0x3141deadbeef0000L) {
      throw new BadVersionException();
    }
 else {
      throw new BadFileFormatException();
    }
  }
  if (mounted != 0)   log.warn("Warning - file was not previously closed");
  if (fileLen != file.length()) {
    throw new CorruptFileException();
  }
  mount();
  metaIndex=new BSkipList(spanSize,this,2,new StringBytes(),new IntBytes());
}
