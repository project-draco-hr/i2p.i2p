{
  if (freeListStart != 0) {
    try {
      FreeListBlock flb=new FreeListBlock(file,freeListStart);
      if (!flb.isEmpty()) {
        return flb.takePage();
      }
 else {
        freeListStart=flb.getNextPage();
        writeSuperBlock();
        return flb.page;
      }
    }
 catch (    IOException ioe) {
      log.error("Discarding corrupt free list block page " + freeListStart,ioe);
      freeListStart=0;
    }
  }
  long offset=file.length();
  fileLen=offset + PAGESIZE;
  file.setLength(fileLen);
  writeSuperBlock();
  return (int)((offset / PAGESIZE) + 1);
}
