{
  if (spanSize < 1) {
    throw new RuntimeException("Span size too small");
  }
  this.skipPage=skipPage;
  this.bf=bf;
  BlockFile.pageSeek(bf.file,skipPage);
  long magic=bf.file.readLong();
  if (magic != MAGIC)   throw new IOException("Bad SkipList magic number 0x" + Long.toHexString(magic) + " on page "+ skipPage);
  firstSpanPage=bf.file.readUnsignedInt();
  firstLevelPage=bf.file.readUnsignedInt();
  size=bf.file.readUnsignedInt();
  spans=bf.file.readUnsignedInt();
  levelCount=bf.file.readUnsignedInt();
  this.fileOnly=fileOnly;
  if (fileOnly)   first=new IBSkipSpan(bf,this,firstSpanPage,key,val);
 else   first=new BSkipSpan(bf,this,firstSpanPage,key,val);
  stack=new BSkipLevels(bf,firstLevelPage,this);
}
