{
  if (key == null) {
    throw new NullPointerException();
  }
  if (val == null) {
    throw new NullPointerException();
  }
  SkipLevels slvls=stack.put(stack.levels.length - 1,key,val,this);
  if (slvls != null) {
    BlockFile.log.info("Top level old hgt " + stack.levels.length + " new hgt "+ slvls.levels.length);
    SkipLevels[] levels=new SkipLevels[slvls.levels.length];
    for (int i=0; i < slvls.levels.length; i++) {
      if (i < stack.levels.length) {
        levels[i]=stack.levels[i];
      }
 else {
        levels[i]=slvls;
      }
    }
    stack.levels=levels;
    stack.flush();
    flush();
  }
}
