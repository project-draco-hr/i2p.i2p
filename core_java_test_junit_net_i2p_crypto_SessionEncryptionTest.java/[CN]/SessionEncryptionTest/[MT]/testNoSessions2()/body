{
  Object keys[]=KeyGenerator.getInstance().generatePKIKeypair();
  PublicKey pubKey=(PublicKey)keys[0];
  PrivateKey privKey=(PrivateKey)keys[1];
  SessionKey curKey=_context.sessionKeyManager().createSession(pubKey);
  byte[] msg="msg 2".getBytes();
  byte emsg[]=_context.elGamalAESEngine().encrypt(msg,pubKey,curKey,64);
  byte dmsg[]=_context.elGamalAESEngine().decrypt(emsg,privKey);
  assertTrue(DataHelper.eq(dmsg,msg));
}
