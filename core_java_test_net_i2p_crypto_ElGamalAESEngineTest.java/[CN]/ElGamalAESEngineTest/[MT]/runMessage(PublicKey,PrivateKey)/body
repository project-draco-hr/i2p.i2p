{
  byte[] msg=new byte[400];
  RandomSource.getInstance().nextBytes(msg);
  SessionKey key=_context.sessionKeyManager().getCurrentKey(pubKey);
  if (key == null)   key=_context.sessionKeyManager().createSession(pubKey);
  long beforeE=Clock.getInstance().now();
  byte[] encrypted=_context.elGamalAESEngine().encrypt(msg,pubKey,key,1024);
  long afterE=Clock.getInstance().now();
  byte[] decrypted=_context.elGamalAESEngine().decrypt(encrypted,privKey);
  long afterD=Clock.getInstance().now();
  if (!DataHelper.eq(msg,decrypted)) {
    _log.error("WTF, D(E(val)) != val");
    return null;
  }
  long rv[]=new long[2];
  rv[0]=afterE - beforeE;
  rv[1]=afterD - afterE;
  return rv;
}
