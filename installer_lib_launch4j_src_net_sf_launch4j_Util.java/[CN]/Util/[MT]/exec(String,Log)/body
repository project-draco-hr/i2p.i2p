{
  BufferedReader is=null;
  try {
    if (WINDOWS_OS) {
      cmd=cmd.replaceAll("/","\\\\");
    }
    Process p=Runtime.getRuntime().exec(cmd);
    is=new BufferedReader(new InputStreamReader(p.getErrorStream()));
    String line;
    while ((line=is.readLine()) != null) {
      log.append(line);
    }
    is.close();
    p.waitFor();
    if (p.exitValue() != 0) {
      String msg="Exec failed (" + p.exitValue() + "): "+ cmd;
      log.append(msg);
      throw new ExecException(msg);
    }
  }
 catch (  IOException e) {
    close(is);
    throw new ExecException(e);
  }
catch (  InterruptedException e) {
    close(is);
    throw new ExecException(e);
  }
}
