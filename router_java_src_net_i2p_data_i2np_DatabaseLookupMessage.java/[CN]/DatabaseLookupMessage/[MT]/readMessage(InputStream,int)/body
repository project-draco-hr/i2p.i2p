{
  if (type != MESSAGE_TYPE)   throw new I2NPMessageException("Message type is incorrect for this message");
  try {
    _key=new Hash();
    _key.readBytes(in);
    _from=new RouterInfo();
    _from.readBytes(in);
    Boolean val=DataHelper.readBoolean(in);
    if (val == null)     throw new I2NPMessageException("Tunnel must be explicitly specified (or not)");
    boolean tunnelSpecified=val.booleanValue();
    if (tunnelSpecified) {
      _replyTunnel=new TunnelId();
      _replyTunnel.readBytes(in);
    }
    int numPeers=(int)DataHelper.readLong(in,2);
    if ((numPeers < 0) || (numPeers >= (1 << 16)))     throw new DataFormatException("Invalid number of peers - " + numPeers);
    Set peers=new HashSet(numPeers);
    for (int i=0; i < numPeers; i++) {
      Hash peer=new Hash();
      peer.readBytes(in);
      peers.add(peer);
    }
    _dontIncludePeers=peers;
  }
 catch (  DataFormatException dfe) {
    throw new I2NPMessageException("Unable to load the message data",dfe);
  }
}
