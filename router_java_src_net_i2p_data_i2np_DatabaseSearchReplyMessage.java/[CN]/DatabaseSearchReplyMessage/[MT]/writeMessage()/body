{
  if (_key == null)   throw new I2NPMessageException("Key in reply to not specified");
  if (_routerInfoStructures == null)   throw new I2NPMessageException("RouterInfo replies are null");
  if (_routerInfoStructures.size() <= 0)   throw new I2NPMessageException("No replies specified in SearchReply!  Always include oneself!");
  if (_from == null)   throw new I2NPMessageException("No 'from' address specified!");
  ByteArrayOutputStream os=new ByteArrayOutputStream(32);
  try {
    _key.writeBytes(os);
    ByteArrayOutputStream baos=new ByteArrayOutputStream(512);
    DataHelper.writeLong(baos,1,_routerInfoStructures.size());
    for (int i=0; i < getNumReplies(); i++) {
      RouterInfo info=getReply(i);
      info.writeBytes(baos);
    }
    byte compressed[]=DataHelper.compress(baos.toByteArray());
    DataHelper.writeLong(os,2,compressed.length);
    os.write(compressed);
    _from.writeBytes(os);
  }
 catch (  DataFormatException dfe) {
    throw new I2NPMessageException("Error writing out the message data",dfe);
  }
  return os.toByteArray();
}
