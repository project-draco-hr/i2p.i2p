{
  if (_key == null)   throw new I2NPMessageException("Key in reply to not specified");
  if (_peerHashes == null)   throw new I2NPMessageException("Peer replies are null");
  if (_from == null)   throw new I2NPMessageException("No 'from' address specified!");
  byte rv[]=null;
  ByteArrayOutputStream os=new ByteArrayOutputStream(32);
  try {
    _key.writeBytes(os);
    DataHelper.writeLong(os,1,_peerHashes.size());
    for (int i=0; i < getNumReplies(); i++) {
      Hash peer=getReply(i);
      peer.writeBytes(os);
    }
    _from.writeBytes(os);
    rv=os.toByteArray();
    _context.statManager().addRateData("netDb.searchReplyMessageSendSize",rv.length,1);
  }
 catch (  DataFormatException dfe) {
    throw new I2NPMessageException("Error writing out the message data",dfe);
  }
  return rv;
}
