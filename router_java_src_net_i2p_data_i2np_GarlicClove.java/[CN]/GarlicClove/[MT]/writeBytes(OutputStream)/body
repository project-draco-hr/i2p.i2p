{
  StringBuffer error=new StringBuffer();
  if (_instructions == null)   error.append("No instructions ");
  if (_msg == null)   error.append("No message ");
  if (_cloveId < 0)   error.append("CloveID < 0 [").append(_cloveId).append("] ");
  if (_expiration == null)   error.append("Expiration is null ");
  if (_certificate == null)   error.append("Certificate is null ");
  if (_replyAction < 0)   error.append("Reply action is < 0 [").append(_replyAction).append("] ");
  ;
  if (error.length() > 0)   throw new DataFormatException(error.toString());
  if ((_replyAction != 0) && (_sourceRouteBlock == null))   throw new DataFormatException("Source route block must be specified for non-null action");
  _instructions.writeBytes(out);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Wrote instructions: " + _instructions);
  _msg.writeBytes(out);
  DataHelper.writeLong(out,4,_cloveId);
  DataHelper.writeDate(out,_expiration);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("CloveID written: " + _cloveId + " expiration written: "+ _expiration);
  _certificate.writeBytes(out);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Written cert: " + _certificate);
  DataHelper.writeLong(out,1,_replyAction);
  if ((_replyAction != 0) && (_sourceRouteBlock != null))   _sourceRouteBlock.writeBytes(out);
}
