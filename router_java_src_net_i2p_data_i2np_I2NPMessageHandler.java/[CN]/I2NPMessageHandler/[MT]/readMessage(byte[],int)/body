{
  int cur=offset;
  int type=(int)DataHelper.fromLong(data,cur,1);
  cur++;
  _lastReadBegin=System.currentTimeMillis();
  I2NPMessage msg=I2NPMessageImpl.createMessage(_context,type);
  try {
    _lastSize=msg.readBytes(data,type,cur);
    cur+=_lastSize;
  }
 catch (  IOException ioe) {
    throw ioe;
  }
catch (  I2NPMessageException ime) {
    throw ime;
  }
catch (  Exception e) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Error reading the stream",e);
    throw new IOException("Unknown error reading the " + msg.getClass().getName() + ": "+ e.getMessage());
  }
  _lastReadEnd=System.currentTimeMillis();
  _lastRead=msg;
  return cur - offset;
}
