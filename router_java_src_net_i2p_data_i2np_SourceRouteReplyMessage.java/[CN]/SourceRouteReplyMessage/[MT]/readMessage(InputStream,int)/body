{
  if (type != MESSAGE_TYPE)   throw new I2NPMessageException("Message type is incorrect for this message");
  try {
    int headerSize=(int)DataHelper.readLong(in,2);
    _encryptedHeader=new byte[headerSize];
    int read=read(in,_encryptedHeader);
    if (read != headerSize)     throw new DataFormatException("Not enough bytes to read the header (read = " + read + ", required = "+ headerSize+ ")");
    _message=new I2NPMessageHandler().readMessage(in);
  }
 catch (  DataFormatException dfe) {
    throw new I2NPMessageException("Unable to load the message data",dfe);
  }
}
