{
  if ((_tunnelId <= 0) || (_data == null))   throw new I2NPMessageException("Not enough data to write out (id=" + _tunnelId + " data="+ _data+ ")");
  if (_data.length <= 0)   throw new I2NPMessageException("Not enough data to write out (data.length=" + _data.length + ")");
  DataHelper.toLong(out,curIndex,4,_tunnelId);
  curIndex+=4;
  System.arraycopy(_data,0,out,curIndex,DATA_SIZE);
  curIndex+=_data.length;
  if (PIPELINED_CACHE)   _cache.release(_dataBuf);
  return curIndex;
}
