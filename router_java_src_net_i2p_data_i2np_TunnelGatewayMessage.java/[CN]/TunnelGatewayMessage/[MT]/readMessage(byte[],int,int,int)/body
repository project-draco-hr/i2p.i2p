{
  if (type != MESSAGE_TYPE)   throw new I2NPMessageException("Message type is incorrect for this message");
  int curIndex=offset;
  _tunnelId=new TunnelId(DataHelper.fromLong(data,curIndex,4));
  curIndex+=4;
  if (_tunnelId.getTunnelId() <= 0)   throw new I2NPMessageException("Invalid tunnel Id " + _tunnelId);
  int size=(int)DataHelper.fromLong(data,curIndex,2);
  curIndex+=2;
  I2NPMessageHandler h=new I2NPMessageHandler(_context);
  curIndex=h.readMessage(data,curIndex);
  _msg=h.lastRead();
  if (_msg == null)   throw new I2NPMessageException("wtf, message read has no payload?");
}
