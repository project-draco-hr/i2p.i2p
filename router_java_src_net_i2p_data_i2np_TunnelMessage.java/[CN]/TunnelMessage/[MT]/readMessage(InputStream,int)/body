{
  if (type != MESSAGE_TYPE)   throw new I2NPMessageException("Message type is incorrect for this message");
  try {
    _tunnelId=new TunnelId();
    _tunnelId.readBytes(in);
    _log.debug("Read tunnel message for tunnel " + _tunnelId);
    _size=DataHelper.readLong(in,4);
    _log.debug("Read tunnel message size: " + _size);
    if (_size < 0)     throw new I2NPMessageException("Invalid size in the structure: " + _size);
    _data=new byte[(int)_size];
    int read=read(in,_data);
    if (read != _size)     throw new I2NPMessageException("Incorrect number of bytes read (" + read + ", expected "+ _size);
    int includeVerification=(int)DataHelper.readLong(in,1);
    if (includeVerification == FLAG_INCLUDESTRUCTURE) {
      _verification=new TunnelVerificationStructure();
      _verification.readBytes(in);
      int len=(int)DataHelper.readLong(in,2);
      _encryptedInstructions=new byte[len];
      read=read(in,_encryptedInstructions);
      if (read != len)       throw new I2NPMessageException("Incorrect number of bytes read for instructions (" + read + ", expected "+ len+ ")");
    }
  }
 catch (  DataFormatException dfe) {
    throw new I2NPMessageException("Unable to load the message data",dfe);
  }
}
