{
  Set toRemoveIds=new HashSet(4);
  Set toRemoveDates=new HashSet(4);
  for (Iterator iter=_receivedIdExpirations.keySet().iterator(); iter.hasNext(); ) {
    Long date=(Long)iter.next();
    if (date.longValue() <= now) {
      toRemoveDates.add(date);
      toRemoveIds.add(_receivedIdExpirations.get(date));
    }
 else {
      break;
    }
  }
  for (Iterator iter=toRemoveDates.iterator(); iter.hasNext(); )   _receivedIdExpirations.remove(iter.next());
  for (Iterator iter=toRemoveIds.iterator(); iter.hasNext(); )   _receivedIds.remove(iter.next());
  if (_log.shouldLog(Log.INFO))   _log.info("Cleaned out " + toRemoveDates.size() + " expired messageIds, leaving "+ _receivedIds.size()+ " remaining");
}
