{
  if ((args == null) || (args.length < 1)) {
    usage();
    return;
  }
  Scanner scan=new Scanner(args[0]);
  if (!scan.hasNextInt()) {
    usage();
    return;
  }
  nbrRouters=scan.nextInt();
  if (nbrRouters < 0) {
    usage();
    return;
  }
  _out=System.out;
  buildClientProps(0);
  _defaultContext=new I2PAppContext(buildRouterProps(0));
  _defaultContext.clock().setOffset(0);
  Runtime.getRuntime().addShutdownHook(new Thread(){
    @Override public void run(){
      _out.println("Shutting down in a few moments..");
      for (      Router r : _routers) {
        r.shutdown(-1);
      }
      try {
        Thread.sleep(1500);
      }
 catch (      InterruptedException ie) {
      }
      Runtime.getRuntime().halt(0);
    }
  }
);
  for (int i=0; i < nbrRouters; i++) {
    Router router=new Router(buildRouterProps(i));
    router.setKillVMOnEnd(false);
    _routers.add(router);
    _out.println("Router " + i + " was created");
  }
  for (int i=0; i < nbrRouters; i++) {
    Router r=_routers.get(i);
    long offset=r.getContext().random().nextLong(Router.CLOCK_FUDGE_FACTOR / 2);
    if (r.getContext().random().nextBoolean())     offset=0 - offset;
    r.getContext().clock().setOffset(offset,true);
    r.runRouter();
    _out.println("Router " + i + " was started with time offset "+ offset);
  }
  _out.println("All routers have been started");
  try {
    Thread.sleep(1000);
  }
 catch (  InterruptedException ie) {
  }
  internalReseed();
  waitForCompletion();
}
