{
  clearCaches();
  _log.log(Log.CRIT,"Shutdown(" + exitCode + ") complete");
  try {
    _context.logManager().shutdown();
  }
 catch (  Throwable t) {
  }
  if (ALLOW_DYNAMIC_KEYS) {
    if (Boolean.valueOf(_context.getProperty(PROP_DYNAMIC_KEYS)).booleanValue())     killKeys();
  }
  File f=getPingFile();
  f.delete();
  if (RouterContext.getContexts().isEmpty())   RouterContext.killGlobalContext();
  for (  Runnable task : _context.getFinalShutdownTasks()) {
    System.err.println("Running final shutdown task " + task.getClass());
    try {
      task.run();
    }
 catch (    Throwable t) {
      System.err.println("Running final shutdown task " + t);
    }
  }
  _context.getFinalShutdownTasks().clear();
  if (_killVMOnEnd) {
    try {
      Thread.sleep(1000);
    }
 catch (    InterruptedException ie) {
    }
    Runtime.getRuntime().halt(exitCode);
  }
 else {
    Runtime.getRuntime().gc();
  }
}
