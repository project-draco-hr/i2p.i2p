{
  if (_isAlive)   throw new IllegalStateException();
  String last=_config.get("router.previousFullVersion");
  if (last != null) {
    _eventLog.addEvent(EventLog.UPDATED,"from " + last + " to "+ RouterVersion.FULL_VERSION);
    saveConfig("router.previousFullVersion",null);
  }
  _eventLog.addEvent(EventLog.STARTED,RouterVersion.FULL_VERSION);
  startupStuff();
  _isAlive=true;
  _started=_context.clock().now();
  try {
    Runtime.getRuntime().addShutdownHook(_shutdownHook);
  }
 catch (  IllegalStateException ise) {
  }
  I2PThread.addOOMEventListener(_oomListener);
  _context.keyManager().startup();
  setupHandlers();
  _context.messageValidator().startup();
  _context.tunnelDispatcher().startup();
  _context.inNetMessagePool().startup();
  startupQueue();
  _context.simpleScheduler().addPeriodicEvent(new CoalesceStatsEvent(_context),COALESCE_TIME);
  _context.jobQueue().addJob(new UpdateRoutingKeyModifierJob(_context));
  warmupCrypto();
  _context.blocklist().startup();
  long before=System.currentTimeMillis();
  _context.clock().getTimestamper().waitForInitialization();
  long waited=System.currentTimeMillis() - before;
  if (_log.shouldLog(Log.INFO))   _log.info("Waited " + waited + "ms to initialize");
  _context.jobQueue().addJob(new StartupJob(_context));
}
