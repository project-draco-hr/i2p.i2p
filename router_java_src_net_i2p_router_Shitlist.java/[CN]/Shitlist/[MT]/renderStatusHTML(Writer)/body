{
  StringBuffer buf=new StringBuffer(1024);
  buf.append("<h2>Shitlist</h2>");
  Map entries=new TreeMap(new HashComparator());
synchronized (_entries) {
    entries.putAll(_entries);
  }
  buf.append("<ul>");
  int partial=0;
  for (Iterator iter=entries.keySet().iterator(); iter.hasNext(); ) {
    Hash key=(Hash)iter.next();
    Entry entry=(Entry)entries.get(key);
    if ((entry.transports != null) && (entry.transports.size() > 0)) {
      partial++;
      continue;
    }
    buf.append("<li><b>").append(key.toBase64()).append("</b>");
    buf.append(" (<a href=\"netdb.jsp#").append(key.toBase64().substring(0,6)).append("\">netdb</a>)");
    buf.append(" expiring in ");
    buf.append(DataHelper.formatDuration(entry.expireOn - _context.clock().now()));
    Set transports=entry.transports;
    if ((transports != null) && (transports.size() > 0))     buf.append(" on the following transports: ").append(transports);
    if (entry.cause != null) {
      buf.append("<br />\n");
      buf.append(entry.cause);
    }
    buf.append(" (<a href=\"configpeer.jsp?peer=").append(key.toBase64()).append("#unsh\">unshitlist now</a>)");
    buf.append("</li>\n");
  }
  buf.append("</ul>\n");
  if (partial > 0) {
    buf.append("<i>Partial shitlisted peers (only blocked on some transports): ");
    buf.append(partial);
    buf.append("</i>\n");
  }
  out.write(buf.toString());
  out.flush();
}
