{
  if (peer == null) {
    _log.error("wtf, why did we try to shitlist null?",new Exception("shitfaced"));
    return false;
  }
  if (_context.routerHash().equals(peer)) {
    _log.error("wtf, why did we try to shitlist ourselves?",new Exception("shitfaced"));
    return false;
  }
  boolean wasAlready=false;
  if (_log.shouldLog(Log.INFO))   _log.info("Shitlisting router " + peer.toBase64(),new Exception("Shitlist cause"));
  long period=SHITLIST_DURATION_MS;
  PeerProfile prof=_context.profileOrganizer().getProfile(peer);
  if (prof != null)   period=SHITLIST_DURATION_MS << prof.incrementShitlists();
  if (period > 60 * 60 * 1000)   period=60 * 60 * 1000;
synchronized (_shitlist) {
    Date oldDate=(Date)_shitlist.put(peer,new Date(_context.clock().now() + period));
    wasAlready=(null == oldDate);
    if (reason != null) {
      _shitlistCause.put(peer,reason);
    }
 else {
      _shitlistCause.remove(peer);
    }
  }
  _context.tunnelManager().peerFailed(peer);
  _context.messageRegistry().peerFailed(peer);
  return wasAlready;
}
