{
  PrintWriter pw=new PrintWriter(out);
  pw.println("<html><head><title>I2P Router Stats</title></head><body>");
  pw.println("<h1>Router statistics</h1>");
  pw.println("<i><a href=\"/routerConsole.html\">console</a> | <a href=\"/routerStats.html\">stats</a></i><hr />");
  Map groups=StatManager.getInstance().getStatsByGroup();
  pw.println("<form action=\"/routerStats.html\">");
  pw.println("<select name=\"go\" onChange='location.href=this.value'>");
  for (Iterator iter=groups.keySet().iterator(); iter.hasNext(); ) {
    String group=(String)iter.next();
    Set stats=(Set)groups.get(group);
    pw.print("<option value=\"/routerStats.html#");
    pw.print(group);
    pw.print("\">");
    pw.print(group);
    pw.println("</option>\n");
    for (Iterator statIter=stats.iterator(); statIter.hasNext(); ) {
      String stat=(String)statIter.next();
      pw.print("<option value=\"/routerStats.html#");
      pw.print(stat);
      pw.print("\">...");
      pw.print(stat);
      pw.println("</option>\n");
    }
  }
  pw.println("</select>");
  pw.println("</form>");
  pw.print("Statistics gathered during this router's uptime (");
  long uptime=Router.getInstance().getUptime();
  pw.print(DataHelper.formatDuration(uptime));
  pw.println(").  The data gathered is quantized over a 1 minute period, so should just be used as an estimate<p />");
  for (Iterator iter=groups.keySet().iterator(); iter.hasNext(); ) {
    String group=(String)iter.next();
    Set stats=(Set)groups.get(group);
    pw.print("<h2><a name=\"");
    pw.print(group);
    pw.print("\">");
    pw.print(group);
    pw.println("</a></h2>");
    pw.println("<ul>");
    for (Iterator statIter=stats.iterator(); statIter.hasNext(); ) {
      String stat=(String)statIter.next();
      pw.print("<li><b><a name=\"");
      pw.print(stat);
      pw.print("\">");
      pw.print(stat);
      pw.println("</a></b><br />");
      if (StatManager.getInstance().isFrequency(stat))       renderFrequency(stat,pw);
 else       renderRate(stat,pw);
    }
    pw.println("</ul><hr />");
  }
  pw.println("</body></html>");
  pw.flush();
}
