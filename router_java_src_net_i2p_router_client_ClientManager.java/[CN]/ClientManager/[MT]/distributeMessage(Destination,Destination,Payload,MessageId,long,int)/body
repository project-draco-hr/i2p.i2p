{
  ClientConnectionRunner runner=getRunner(toDest);
  if (runner != null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Message " + msgId + " is targeting a local destination.  distribute it as such");
    ClientConnectionRunner sender=getRunner(fromDest);
    if (sender == null) {
      return;
    }
    _ctx.jobQueue().addJob(new DistributeLocal(toDest,runner,sender,fromDest,payload,msgId));
  }
 else {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Message " + msgId + " is targeting a REMOTE destination!  Added to the client message pool");
    runner=getRunner(fromDest);
    if (runner == null) {
      return;
    }
    ClientMessage msg=new ClientMessage();
    msg.setDestination(toDest);
    msg.setPayload(payload);
    msg.setSenderConfig(runner.getConfig());
    msg.setFromDestination(runner.getConfig().getDestination());
    msg.setMessageId(msgId);
    msg.setExpiration(expiration);
    msg.setFlags(flags);
    _ctx.clientMessagePool().add(msg,true);
  }
}
