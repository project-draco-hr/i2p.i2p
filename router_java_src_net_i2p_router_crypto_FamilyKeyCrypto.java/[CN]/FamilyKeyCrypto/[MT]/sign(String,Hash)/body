{
  if (_privkey == null)   throw new GeneralSecurityException("family name set, must restart router");
  if (h == null)   throw new GeneralSecurityException("null router hash");
  if (!_fname.equals(family))   throw new GeneralSecurityException("family name changed, must restart router");
  byte[] nb=DataHelper.getUTF8(_fname);
  int len=nb.length + Hash.HASH_LENGTH;
  byte[] b=new byte[len];
  System.arraycopy(nb,0,b,0,nb.length);
  System.arraycopy(h.getData(),0,b,nb.length,Hash.HASH_LENGTH);
  Signature sig=_context.dsa().sign(b,_privkey);
  if (sig == null)   throw new GeneralSecurityException("sig failed");
  return sig.toBase64();
}
