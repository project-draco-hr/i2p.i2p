{
  Set cloves=new HashSet();
  int offset=0;
  CloveSet set=new CloveSet();
  int numCloves=(int)DataHelper.fromLong(data,offset,1);
  offset++;
  if (_log.shouldLog(Log.DEBUG))   _log.debug("# cloves to read: " + numCloves);
  for (int i=0; i < numCloves; i++) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Reading clove " + i);
    GarlicClove clove=new GarlicClove(_context);
    offset+=clove.readBytes(data,offset);
    set.addClove(clove);
    if (_log.shouldLog(Log.WARN))     _log.debug("After reading clove " + i);
  }
  Certificate cert=new Certificate();
  offset+=cert.readBytes(data,offset);
  long msgId=DataHelper.fromLong(data,offset,4);
  offset+=4;
  Date expiration=DataHelper.fromDate(data,offset);
  offset+=DataHelper.DATE_LENGTH;
  set.setCertificate(cert);
  set.setMessageId(msgId);
  set.setExpiration(expiration.getTime());
  return set;
}
