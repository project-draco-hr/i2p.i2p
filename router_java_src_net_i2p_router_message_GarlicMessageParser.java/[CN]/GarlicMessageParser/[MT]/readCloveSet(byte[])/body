{
  Set cloves=new HashSet();
  ByteArrayInputStream bais=new ByteArrayInputStream(data);
  try {
    CloveSet set=new CloveSet();
    int numCloves=(int)DataHelper.readLong(bais,1);
    _log.debug("# cloves to read: " + numCloves);
    for (int i=0; i < numCloves; i++) {
      _log.debug("Reading clove " + i);
      try {
        GarlicClove clove=new GarlicClove();
        clove.readBytes(bais);
        set.addClove(clove);
      }
 catch (      DataFormatException dfe) {
        _log.warn("Unable to read clove " + i,dfe);
      }
catch (      IOException ioe) {
        _log.warn("Unable to read clove " + i,ioe);
      }
      _log.debug("After reading clove " + i);
    }
    Certificate cert=new Certificate();
    cert.readBytes(bais);
    long msgId=DataHelper.readLong(bais,4);
    Date expiration=DataHelper.readDate(bais);
    set.setCertificate(cert);
    set.setMessageId(msgId);
    set.setExpiration(expiration.getTime());
    return set;
  }
 catch (  IOException ioe) {
    _log.error("Error reading clove set",ioe);
    return null;
  }
catch (  DataFormatException dfe) {
    _log.error("Error reading clove set",dfe);
    return null;
  }
}
