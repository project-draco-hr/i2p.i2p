{
  byte iv[]=new byte[16];
  Hash h=getContext().sha().calculateHash(key.getData());
  System.arraycopy(h.getData(),0,iv,0,iv.length);
  byte decrypted[]=getContext().AESEngine().safeDecrypt(encryptedMessage,key,iv);
  if (decrypted == null) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error decrypting the message",getAddedBy());
    return null;
  }
  return getBody(decrypted);
}
