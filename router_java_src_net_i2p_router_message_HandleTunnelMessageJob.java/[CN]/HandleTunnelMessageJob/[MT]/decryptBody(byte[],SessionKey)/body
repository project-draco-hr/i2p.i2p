{
  byte iv[]=new byte[16];
  Hash h=getContext().sha().calculateHash(key.getData());
  System.arraycopy(h.getData(),0,iv,0,iv.length);
  byte decrypted[]=getContext().aes().safeDecrypt(encryptedMessage,key,iv);
  if (decrypted == null) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error decrypting the message",getAddedBy());
    return null;
  }
  if (decrypted.length <= 0) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Received an empty decrypted message?  encrypted length: " + encryptedMessage.length,getAddedBy());
    return null;
  }
  return getBody(decrypted);
}
