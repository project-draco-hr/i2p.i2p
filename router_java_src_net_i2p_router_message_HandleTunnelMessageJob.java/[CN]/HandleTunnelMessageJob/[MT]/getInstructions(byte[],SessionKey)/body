{
  try {
    byte iv[]=new byte[16];
    Hash h=getContext().sha().calculateHash(key.getData());
    System.arraycopy(h.getData(),0,iv,0,iv.length);
    byte decrypted[]=getContext().AESEngine().safeDecrypt(encryptedInstructions,key,iv);
    if (decrypted == null) {
      if (_log.shouldLog(Log.ERROR))       _log.error("Error decrypting the instructions",getAddedBy());
      return null;
    }
    DeliveryInstructions instructions=new DeliveryInstructions();
    instructions.readBytes(new ByteArrayInputStream(decrypted));
    return instructions;
  }
 catch (  DataFormatException dfe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error parsing the decrypted instructions",dfe);
  }
catch (  IOException ioe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error reading the decrypted instructions",ioe);
  }
  return null;
}
