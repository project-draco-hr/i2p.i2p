{
  _context.statManager().addRateData("tunnel.endpointMessageSize",_message.getData().length,0);
switch (instructions.getDeliveryMode()) {
case DeliveryInstructions.DELIVERY_MODE_LOCAL:
    sendToLocal(body);
  break;
case DeliveryInstructions.DELIVERY_MODE_ROUTER:
if (_context.routerHash().equals(instructions.getRouter())) {
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Delivery instructions point at a router, but we're that router, so send to local");
  sendToLocal(body);
}
 else {
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Delivery instructions point at a router, and we're not that router, so forward it off");
  sendToRouter(instructions.getRouter(),body);
}
break;
case DeliveryInstructions.DELIVERY_MODE_TUNNEL:
sendToTunnel(instructions.getRouter(),instructions.getTunnelId(),body);
break;
case DeliveryInstructions.DELIVERY_MODE_DESTINATION:
sendToDest(instructions.getDestination(),body);
break;
}
}
