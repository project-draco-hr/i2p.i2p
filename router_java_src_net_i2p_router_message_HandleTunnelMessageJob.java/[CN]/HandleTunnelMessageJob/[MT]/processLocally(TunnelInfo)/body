{
  if (ourPlace.getEncryptionKey() == null) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Argh, somehow we don't have the decryption key and we have no more steps",getAddedBy());
    return;
  }
  DeliveryInstructions instructions=getInstructions(_message.getEncryptedDeliveryInstructions(),ourPlace.getEncryptionKey().getKey());
  if (instructions == null) {
    if (_log.shouldLog(Log.ERROR))     _log.error("We are the endpoint of a non-zero length tunnel and we don't have instructions.  DROP.",getAddedBy());
    return;
  }
 else {
    I2NPMessage body=null;
    if (instructions.getEncrypted()) {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Body in the tunnel IS encrypted");
      body=decryptBody(_message.getData(),instructions.getEncryptionKey());
    }
 else {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Body in the tunnel is NOT encrypted: " + instructions + "\n"+ _message,new Exception("Hmmm..."));
      body=getBody(_message.getData());
    }
    if (body == null) {
      if (_log.shouldLog(Log.ERROR))       _log.error("Unable to recover the body from the tunnel",getAddedBy());
      return;
    }
 else {
      _context.jobQueue().addJob(new ProcessBodyLocallyJob(body,instructions,ourPlace));
    }
  }
}
