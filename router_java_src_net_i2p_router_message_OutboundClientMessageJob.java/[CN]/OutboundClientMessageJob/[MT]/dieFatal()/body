{
  if (_status.getSuccess())   return;
  boolean alreadyFailed=_status.failed();
  long sendTime=getContext().clock().now() - _status.getStart();
  ClientMessage msg=_status.getMessage();
  if (alreadyFailed) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug(getJobId() + ": dieFatal() - already failed sending " + msg.getMessageId()+ ", no need to do it again",new Exception("Duplicate death?"));
    return;
  }
 else {
    if (_log.shouldLog(Log.WARN))     _log.warn(getJobId() + ": Failed to send the message " + msg.getMessageId()+ " after "+ _status.getNumSent()+ " sends and "+ _status.getNumLookups()+ " lookups (and "+ sendTime+ "ms)",new Exception("Message send failure"));
  }
  getContext().messageHistory().sendPayloadMessage(msg.getMessageId().getMessageId(),false,sendTime);
  getContext().clientManager().messageDeliveryStatusUpdate(msg.getFromDestination(),msg.getMessageId(),false);
  getContext().statManager().updateFrequency("client.sendMessageFailFrequency");
  getContext().statManager().addRateData("client.sendAttemptAverage",_status.getNumSent(),sendTime);
  getContext().statManager().addRateData("client.sendsPerFailure",_status.getNumSent(),sendTime);
}
