{
  if (_log.shouldLog(Log.DEBUG)) {
    _log.debug("sendNext() called with " + _status.getNumSent() + " already sent");
  }
  if (_status.getSuccess()) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("sendNext() - already successful!");
    return;
  }
  if (_status.getFailure()) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("sendNext() - already failed!");
    return;
  }
  long now=_context.clock().now();
  if (now >= _overallExpiration) {
    if (_log.shouldLog(Log.WARN))     _log.warn("sendNext() - Expired");
    dieFatal();
    return;
  }
  Lease nextLease=getNextLease();
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Send outbound client message - next lease found for [" + _status.getTo().calculateHash().toBase64() + "] - "+ nextLease);
  if (nextLease == null) {
    if (_log.shouldLog(Log.WARN))     _log.warn("No more leases, and we still haven't heard back from the peer, refetching the leaseSet to try again");
    _status.setLeaseSet(null);
    long remainingMs=_overallExpiration - _context.clock().now();
    if (_status.getNumLookups() < MAX_LEASE_LOOKUPS) {
      _status.incrementLookups();
      Hash to=_status.getMessage().getDestination().calculateHash();
      _status.clearAlreadySent();
      _context.netDb().fail(to);
      _context.netDb().lookupLeaseSet(to,_nextStep,_lookupLeaseSetFailed,remainingMs);
      return;
    }
 else {
      if (_log.shouldLog(Log.WARN))       _log.warn("sendNext() - max # lease lookups exceeded! " + _status.getNumLookups());
      dieFatal();
      return;
    }
  }
  _context.jobQueue().addJob(new SendJob(nextLease));
}
