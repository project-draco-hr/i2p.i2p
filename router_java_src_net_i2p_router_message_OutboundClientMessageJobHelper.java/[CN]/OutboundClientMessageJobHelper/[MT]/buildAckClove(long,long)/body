{
  PayloadGarlicConfig ackClove=new PayloadGarlicConfig();
  Hash replyToTunnelRouter=null;
  TunnelId replyToTunnelId=null;
  TunnelSelectionCriteria criteria=new TunnelSelectionCriteria();
  criteria.setMaximumTunnelsRequired(1);
  criteria.setMinimumTunnelsRequired(1);
  criteria.setReliabilityPriority(50);
  criteria.setAnonymityPriority(50);
  criteria.setLatencyPriority(50);
  List tunnelIds=TunnelManagerFacade.getInstance().selectInboundTunnelIds(criteria);
  if (tunnelIds.size() <= 0) {
    _log.error("No inbound tunnels to receive an ack through!?");
    return null;
  }
  replyToTunnelId=(TunnelId)tunnelIds.get(0);
  TunnelInfo info=TunnelManagerFacade.getInstance().getTunnelInfo(replyToTunnelId);
  replyToTunnelRouter=info.getThisHop();
  _log.debug("Ack for the data message will come back along tunnel " + replyToTunnelId + ":\n"+ info);
  DeliveryInstructions ackInstructions=new DeliveryInstructions();
  ackInstructions.setDeliveryMode(DeliveryInstructions.DELIVERY_MODE_TUNNEL);
  ackInstructions.setRouter(replyToTunnelRouter);
  ackInstructions.setTunnelId(replyToTunnelId);
  ackInstructions.setDelayRequested(false);
  ackInstructions.setDelaySeconds(0);
  ackInstructions.setEncrypted(false);
  DeliveryStatusMessage msg=new DeliveryStatusMessage();
  msg.setArrival(new Date(Clock.getInstance().now()));
  msg.setMessageId(replyToken);
  _log.debug("Delivery status message key: " + replyToken + " arrival: "+ msg.getArrival());
  ackClove.setCertificate(new Certificate(Certificate.CERTIFICATE_TYPE_NULL,null));
  ackClove.setDeliveryInstructions(ackInstructions);
  ackClove.setExpiration(expiration);
  ackClove.setId(RandomSource.getInstance().nextInt(Integer.MAX_VALUE));
  ackClove.setPayload(msg);
  ackClove.setRecipient(Router.getInstance().getRouterInfo());
  ackClove.setRequestAck(false);
  _log.debug("Delivery status message is targetting us [" + ackClove.getRecipient().getIdentity().getHash().toBase64() + "] via tunnel "+ replyToTunnelId.getTunnelId()+ " on "+ replyToTunnelRouter.toBase64());
  return ackClove;
}
