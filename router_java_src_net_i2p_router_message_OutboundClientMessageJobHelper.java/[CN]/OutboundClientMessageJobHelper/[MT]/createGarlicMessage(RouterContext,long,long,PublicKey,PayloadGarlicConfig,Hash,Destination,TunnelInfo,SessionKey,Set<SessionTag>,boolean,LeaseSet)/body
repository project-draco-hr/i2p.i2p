{
  GarlicConfig config=createGarlicConfig(ctx,replyToken,expiration,recipientPK,dataClove,from,dest,replyTunnel,requireAck,bundledReplyLeaseSet);
  if (config == null)   return null;
  SessionKeyManager skm=ctx.clientManager().getClientSessionKeyManager(from);
  if (skm == null)   return null;
  int tagsToSend=replyToken >= 0 ? skm.getTagsToSend() : 0;
  GarlicMessage msg=GarlicMessageBuilder.buildMessage(ctx,config,wrappedKey,wrappedTags,tagsToSend,skm);
  return msg;
}
