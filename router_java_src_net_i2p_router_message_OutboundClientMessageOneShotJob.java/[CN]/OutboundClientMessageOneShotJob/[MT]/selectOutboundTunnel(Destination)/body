{
  TunnelInfo tunnel;
  long now=getContext().clock().now();
synchronized (_tunnelCache) {
    if (now - _cleanTime > 5 * 60 * 1000) {
      List deleteList=new ArrayList();
      for (Iterator iter=_tunnelCache.keySet().iterator(); iter.hasNext(); ) {
        Destination dest=(Destination)iter.next();
        tunnel=(TunnelInfo)_tunnelCache.get(dest);
        if (!getContext().tunnelManager().isValidTunnel(_from.calculateHash(),tunnel))         deleteList.add(dest);
      }
      for (Iterator iter=deleteList.iterator(); iter.hasNext(); ) {
        Destination dest=(Destination)iter.next();
        _tunnelCache.remove(dest);
      }
      _cleanTime=now;
    }
    tunnel=(TunnelInfo)_tunnelCache.get(to);
    if (tunnel != null) {
      if (getContext().tunnelManager().isValidTunnel(_from.calculateHash(),tunnel))       return (tunnel);
 else       _tunnelCache.remove(to);
    }
    tunnel=selectOutboundTunnel();
    if (tunnel != null)     _tunnelCache.put(to,tunnel);
  }
  return tunnel;
}
