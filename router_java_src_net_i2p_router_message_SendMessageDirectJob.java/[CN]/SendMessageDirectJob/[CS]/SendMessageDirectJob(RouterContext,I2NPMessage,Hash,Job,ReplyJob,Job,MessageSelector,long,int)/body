{
  super(ctx);
  _log=_context.logManager().getLog(SendMessageDirectJob.class);
  _message=message;
  _targetHash=toPeer;
  _router=null;
  _expiration=expiration;
  _priority=priority;
  _alreadySearched=false;
  _onSend=onSend;
  _onSuccess=onSuccess;
  _onFail=onFail;
  _selector=selector;
  if (message == null)   throw new IllegalArgumentException("Attempt to send a null message");
  if (_targetHash == null)   throw new IllegalArgumentException("Attempt to send a message to a null peer");
  _sent=false;
  long remaining=expiration - _context.clock().now();
  if (remaining < 50 * 1000) {
    _log.info("Sending message to expire in " + remaining + "ms containing "+ message.getUniqueId()+ " (a "+ message.getClass().getName()+ ")",new Exception("SendDirect from"));
  }
}
