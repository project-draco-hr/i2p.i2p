{
  super(ctx);
  _log=ctx.logManager().getLog(SendTunnelMessageJob.class);
  if (msg == null)   throw new IllegalArgumentException("wtf, null message?  sod off");
  if (tunnelId == null)   throw new IllegalArgumentException("wtf, no tunnelId? nuh uh");
  _message=msg;
  _destRouter=targetRouter;
  _tunnelId=tunnelId;
  _targetTunnelId=targetTunnelId;
  _onSend=onSend;
  _onReply=onReply;
  _onFailure=onFailure;
  _selector=selector;
  _timeout=timeoutMs;
  _priority=priority;
  if (timeoutMs < 50 * 1000) {
    if (_log.shouldLog(Log.INFO))     _log.info("Sending tunnel message to expire in " + timeoutMs + "ms containing "+ msg.getUniqueId()+ " (a "+ msg.getClass().getName()+ ")",new Exception("SendTunnel from"));
  }
  if (timeoutMs < 5 * 1000) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Very little time given [" + timeoutMs + "], resetting to 5s",new Exception("stingy bastard"));
    _expiration=getContext().clock().now() + 5 * 1000;
  }
 else {
    _expiration=getContext().clock().now() + timeoutMs;
  }
}
