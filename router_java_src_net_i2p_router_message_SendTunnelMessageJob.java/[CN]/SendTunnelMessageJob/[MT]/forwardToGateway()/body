{
  _state=8;
  TunnelMessage msg=new TunnelMessage(getContext());
  msg.setData(_message.toByteArray());
  msg.setTunnelId(_tunnelId);
  msg.setMessageExpiration(new Date(_expiration));
  getContext().jobQueue().addJob(new SendMessageDirectJob(getContext(),msg,_destRouter,_onSend,_onReply,_onFailure,_selector,(int)(_expiration - getContext().clock().now()),_priority));
  String bodyType=_message.getClass().getName();
  getContext().messageHistory().wrap(bodyType,_message.getUniqueId(),TunnelMessage.class.getName(),msg.getUniqueId());
  _state=9;
  return;
}
