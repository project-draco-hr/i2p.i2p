{
  TunnelMessage msg=new TunnelMessage(_context);
  try {
    ByteArrayOutputStream baos=new ByteArrayOutputStream(1024);
    _message.writeBytes(baos);
    msg.setData(baos.toByteArray());
    msg.setTunnelId(_tunnelId);
    msg.setMessageExpiration(new Date(_expiration));
    _context.jobQueue().addJob(new SendMessageDirectJob(_context,msg,_destRouter,_onSend,_onReply,_onFailure,_selector,_expiration,_priority));
    String bodyType=_message.getClass().getName();
    _context.messageHistory().wrap(bodyType,_message.getUniqueId(),TunnelMessage.class.getName(),msg.getUniqueId());
  }
 catch (  IOException ioe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error writing out the tunnel message to send to the tunnel",ioe);
  }
catch (  DataFormatException dfe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error writing out the tunnel message to send to the tunnel",dfe);
  }
  return;
}
