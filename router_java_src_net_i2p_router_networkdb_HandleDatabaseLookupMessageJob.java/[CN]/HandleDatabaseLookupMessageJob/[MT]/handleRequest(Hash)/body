{
  LeaseSet ls=getContext().netDb().lookupLeaseSetLocally(_message.getSearchKey());
  if (ls != null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("We do have key " + _message.getSearchKey().toBase64() + " locally as a lease set.  sending to "+ fromKey.toBase64());
    sendData(_message.getSearchKey(),ls,fromKey,_message.getReplyTunnel());
  }
 else {
    RouterInfo info=getContext().netDb().lookupRouterInfoLocally(_message.getSearchKey());
    if (info != null) {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("We do have key " + _message.getSearchKey().toBase64() + " locally as a router info.  sending to "+ fromKey.toBase64());
      sendData(_message.getSearchKey(),info,fromKey,_message.getReplyTunnel());
    }
 else {
      Set routerInfoSet=getContext().netDb().findNearestRouters(_message.getSearchKey(),MAX_ROUTERS_RETURNED,_message.getDontIncludePeers());
      if (_log.shouldLog(Log.DEBUG))       _log.debug("We do not have key " + _message.getSearchKey().toBase64() + " locally.  sending back "+ routerInfoSet.size()+ " peers to "+ fromKey.toBase64());
      sendClosest(_message.getSearchKey(),routerInfoSet,fromKey,_message.getReplyTunnel());
    }
  }
}
