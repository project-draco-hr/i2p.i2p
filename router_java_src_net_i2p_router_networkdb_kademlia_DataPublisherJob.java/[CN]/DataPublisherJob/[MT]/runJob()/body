{
  Set toSend=selectKeysToSend();
  if (_log.shouldLog(Log.INFO))   _log.info("Keys being published in this timeslice: " + toSend);
  for (Iterator iter=toSend.iterator(); iter.hasNext(); ) {
    Hash key=(Hash)iter.next();
    DataStructure data=_facade.getDataStore().get(key);
    if (data == null) {
      if (_log.shouldLog(Log.WARN))       _log.warn("Trying to send a key we dont have? " + key);
      continue;
    }
    if (data instanceof LeaseSet) {
      LeaseSet ls=(LeaseSet)data;
      if (!ls.isCurrent(Router.CLOCK_FUDGE_FACTOR)) {
        if (_log.shouldLog(Log.WARN))         _log.warn("Not publishing a lease that isn't current - " + key,new Exception("Publish expired lease?"));
      }
    }
    StoreJob store=new StoreJob(getContext(),_facade,key,data,null,null,STORE_TIMEOUT);
    getContext().jobQueue().addJob(store);
  }
  requeue(RERUN_DELAY_MS);
}
