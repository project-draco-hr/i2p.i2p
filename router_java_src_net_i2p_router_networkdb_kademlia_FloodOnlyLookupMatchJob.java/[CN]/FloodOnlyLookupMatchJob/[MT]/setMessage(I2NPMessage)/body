{
  if (message instanceof DatabaseSearchReplyMessage) {
    _dsrm=(DatabaseSearchReplyMessage)message;
    _search.failed();
    return;
  }
  try {
    DatabaseStoreMessage dsm=(DatabaseStoreMessage)message;
    if (_log.shouldLog(Log.INFO))     _log.info(_search.getJobId() + ": got a DSM for " + dsm.getKey().toBase64());
    if (dsm.getValueType() == DatabaseStoreMessage.KEY_TYPE_LEASESET) {
      dsm.getLeaseSet().setReceivedAsReply();
      getContext().netDb().store(dsm.getKey(),dsm.getLeaseSet());
    }
 else {
      getContext().netDb().store(dsm.getKey(),dsm.getRouterInfo());
    }
  }
 catch (  IllegalArgumentException iae) {
    if (_log.shouldLog(Log.WARN))     _log.warn(_search.getJobId() + ": Received an invalid store reply",iae);
  }
}
