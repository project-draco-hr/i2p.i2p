{
  TunnelInfo replyTunnelInfo;
  if (_isRouterInfo || getContext().keyRing().get(_key) != null)   replyTunnelInfo=getContext().tunnelManager().selectInboundExploratoryTunnel(_target);
 else   replyTunnelInfo=getContext().tunnelManager().selectInboundTunnel(_key,_target);
  if (replyTunnelInfo == null) {
    if (_log.shouldLog(Log.WARN))     _log.warn("No inbound tunnels to get a reply from!");
    return null;
  }
  DatabaseLookupMessage m=new DatabaseLookupMessage(getContext(),true);
  m.setMessageExpiration(getContext().clock().now() + VERIFY_TIMEOUT);
  m.setReplyTunnel(replyTunnelInfo.getReceiveTunnelId(0));
  m.setFrom(replyTunnelInfo.getPeer(0));
  m.setSearchKey(_key);
  return m;
}
