{
  long now=getContext().clock().now();
  if (harvestDirectly()) {
    DatabaseLookupMessage msg=new DatabaseLookupMessage(getContext(),true);
    msg.setFrom(getContext().routerHash());
    msg.setMessageExpiration(10 * 1000 + now);
    msg.setSearchKey(peer);
    msg.setReplyTunnel(null);
    SendMessageDirectJob job=new SendMessageDirectJob(getContext(),msg,peer,10 * 1000,PRIORITY);
    job.runJob();
  }
 else {
    TunnelInfo replyTunnel=getContext().tunnelManager().selectInboundTunnel();
    TunnelInfo sendTunnel=getContext().tunnelManager().selectOutboundTunnel();
    if ((replyTunnel != null) && (sendTunnel != null)) {
      DatabaseLookupMessage msg=new DatabaseLookupMessage(getContext(),true);
      msg.setFrom(replyTunnel.getPeer(0));
      msg.setMessageExpiration(10 * 1000 + now);
      msg.setSearchKey(peer);
      msg.setReplyTunnel(replyTunnel.getReceiveTunnelId(0));
      getContext().tunnelDispatcher().dispatchOutbound(msg,sendTunnel.getSendTunnelId(0),peer);
    }
  }
}
