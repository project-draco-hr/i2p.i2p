{
  if (!_initialized)   return null;
  RouterInfo rv=(RouterInfo)_ds.get(key);
  if ((rv != null) && (rv.equals(routerInfo))) {
    return rv;
  }
  String err=validate(key,routerInfo);
  if (err != null)   throw new IllegalArgumentException("Invalid store attempt - " + err);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("RouterInfo " + key.toBase64() + " is stored with "+ routerInfo.getOptions().size()+ " options on "+ new Date(routerInfo.getPublished()));
  _context.peerManager().setCapabilities(key,routerInfo.getCapabilities());
  _ds.put(key,routerInfo);
  if (rv == null)   _kb.add(key);
  return rv;
}
