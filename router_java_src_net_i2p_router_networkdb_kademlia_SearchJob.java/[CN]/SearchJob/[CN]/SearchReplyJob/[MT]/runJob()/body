{
  if (_curIndex >= _msg.getNumReplies()) {
    _context.profileManager().dbLookupReply(_peer,_newPeers,_seenPeers,_invalidPeers,_duplicatePeers,_duration);
    if (_newPeers > 0)     newPeersFound(_newPeers);
  }
 else {
    RouterInfo ri=_msg.getReply(_curIndex);
    if (ri.isValid()) {
      if (_state.wasAttempted(ri.getIdentity().getHash())) {
        _duplicatePeers++;
      }
      if (_log.shouldLog(Log.DEBUG))       _log.debug(getJobId() + ": dbSearchReply received on search containing router " + ri.getIdentity().getHash()+ " with publishDate of "+ new Date(ri.getPublished()));
      _facade.store(ri.getIdentity().getHash(),ri);
      if (_facade.getKBuckets().add(ri.getIdentity().getHash()))       _newPeers++;
 else       _seenPeers++;
    }
 else {
      if (_log.shouldLog(Log.ERROR))       _log.error(getJobId() + ": Received an invalid peer from " + _peer+ ": "+ ri);
      _invalidPeers++;
    }
    _curIndex++;
    requeue(0);
  }
}
