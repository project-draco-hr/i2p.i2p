{
  Rate curAccepted=acceptStat.getRate(period);
  Rate curRejected=rejectStat.getRate(period);
  Rate curFailed=failedStat.getRate(period);
  long eventCount=0;
  if (curAccepted != null)   eventCount=curAccepted.getCurrentEventCount() + curAccepted.getLastEventCount();
  double stretch=((double)ESTIMATE_PERIOD) / period;
  double val=eventCount * stretch;
  long failed=0;
  if (curFailed != null)   failed=(long)(0.5 + (4.0 * (curFailed.getCurrentTotalValue() + curFailed.getLastTotalValue()) / 100.0));
  if (failed > 0) {
    val-=failed * stretch;
  }
  val-=stretch * (curRejected.getCurrentEventCount() + curRejected.getLastEventCount());
  val+=GROWTH_FACTOR;
  if (val >= 0) {
    return val;
  }
 else {
    return 0.0d;
  }
}
