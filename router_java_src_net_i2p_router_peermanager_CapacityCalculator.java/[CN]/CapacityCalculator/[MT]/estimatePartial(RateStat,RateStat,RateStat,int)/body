{
  Rate curAccepted=acceptStat.getRate(period);
  Rate curRejected=rejectStat.getRate(period);
  Rate curFailed=failedStat.getRate(period);
  if (curRejected.getCurrentEventCount() + curRejected.getLastEventCount() > 0)   return 0.0d;
  long eventCount=0;
  if (curAccepted != null)   eventCount=curAccepted.getCurrentEventCount() + curAccepted.getLastEventCount();
  double stretch=ESTIMATE_PERIOD / period;
  double val=eventCount * stretch;
  long failed=0;
  if (curFailed != null)   failed=curFailed.getCurrentEventCount() + curFailed.getLastEventCount();
  if (failed > 0)   val-=failed * stretch;
  if (val >= 0) {
    return (val + GROWTH_FACTOR) * periodWeight(period);
  }
 else {
    return 0.0d;
  }
}
