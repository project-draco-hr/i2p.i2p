{
  try {
    long start=getContext().clock().now();
    Set allPeers=getContext().profileOrganizer().selectAllPeers();
    long afterSelect=getContext().clock().now();
    for (Iterator iter=allPeers.iterator(); iter.hasNext(); ) {
      Hash peer=(Hash)iter.next();
      PeerProfile profile=getContext().profileOrganizer().getProfile(peer);
      if (profile != null)       profile.coallesceStats();
    }
    long afterCoallesce=getContext().clock().now();
    getContext().profileOrganizer().reorganize();
    long afterReorganize=getContext().clock().now();
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Profiles coallesced and reorganized.  total: " + allPeers.size() + ", selectAll: "+ (afterSelect - start)+ "ms, coallesce: "+ (afterCoallesce - afterSelect)+ "ms, reorganize: "+ (afterReorganize - afterSelect));
  }
 catch (  Throwable t) {
    _log.log(Log.CRIT,"Error evaluating profiles",t);
  }
 finally {
    requeue(30 * 1000);
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Requeued for " + new Date(getTiming().getStartAfter()));
  }
}
