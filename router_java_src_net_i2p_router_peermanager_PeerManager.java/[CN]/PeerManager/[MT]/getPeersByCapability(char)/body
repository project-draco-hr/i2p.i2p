{
  if (true) {
    Set<Hash> peers=locked_getPeers(capability);
    if (peers != null)     return new ArrayList(peers);
    return null;
  }
 else {
    FloodfillNetworkDatabaseFacade f=(FloodfillNetworkDatabaseFacade)_context.netDb();
    List<RouterInfo> routerInfos=f.getKnownRouterData();
    List<Hash> rv=new ArrayList();
    for (Iterator<RouterInfo> iter=routerInfos.iterator(); iter.hasNext(); ) {
      RouterInfo ri=iter.next();
      String caps=ri.getCapabilities();
      if (caps.indexOf(capability) >= 0)       rv.add(ri.getIdentity().calculateHash());
    }
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Peers with capacity " + capability + ": "+ rv.size());
    return rv;
  }
}
