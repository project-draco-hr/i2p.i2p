{
synchronized (_reorganizeLock) {
    int activePeers=0;
    long hideBefore=_context.clock().now() - 6 * 60 * 60* 1000;
    for (Iterator iter=_failingPeers.values().iterator(); iter.hasNext(); ) {
      PeerProfile profile=(PeerProfile)iter.next();
      if (profile.getLastSendSuccessful() >= hideBefore)       activePeers++;
 else       if (profile.getLastHeardFrom() >= hideBefore)       activePeers++;
    }
    for (Iterator iter=_notFailingPeers.values().iterator(); iter.hasNext(); ) {
      PeerProfile profile=(PeerProfile)iter.next();
      if (profile.getLastSendSuccessful() >= hideBefore)       activePeers++;
 else       if (profile.getLastHeardFrom() >= hideBefore)       activePeers++;
    }
    return activePeers;
  }
}
