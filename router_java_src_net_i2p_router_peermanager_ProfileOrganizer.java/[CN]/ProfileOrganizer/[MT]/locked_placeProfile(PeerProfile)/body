{
  if (profile.getIsFailing()) {
    if (!shouldDrop(profile))     _failingPeers.put(profile.getPeer(),profile);
    _fastPeers.remove(profile.getPeer());
    _highCapacityPeers.remove(profile.getPeer());
    _wellIntegratedPeers.remove(profile.getPeer());
    _notFailingPeers.remove(profile.getPeer());
    _notFailingPeersList.remove(profile.getPeer());
  }
 else {
    _failingPeers.remove(profile.getPeer());
    _fastPeers.remove(profile.getPeer());
    _highCapacityPeers.remove(profile.getPeer());
    _wellIntegratedPeers.remove(profile.getPeer());
    _notFailingPeers.put(profile.getPeer(),profile);
    _notFailingPeersList.add(profile.getPeer());
    if (_thresholdCapacityValue <= profile.getCapacityValue() && isSelectable(profile.getPeer())) {
      _highCapacityPeers.put(profile.getPeer(),profile);
      if (_log.shouldLog(Log.DEBUG))       _log.debug("High capacity: \t" + profile.getPeer().toBase64());
      if (_thresholdSpeedValue <= profile.getSpeedValue()) {
        if (!profile.getIsActive()) {
          if (_log.shouldLog(Log.INFO))           _log.info("Skipping fast mark [!active] for " + profile.getPeer().toBase64());
        }
 else {
          _fastPeers.put(profile.getPeer(),profile);
          if (_log.shouldLog(Log.DEBUG))           _log.debug("Fast: \t" + profile.getPeer().toBase64());
        }
      }
    }
 else {
    }
    if (_thresholdIntegrationValue <= profile.getIntegrationValue()) {
      _wellIntegratedPeers.put(profile.getPeer(),profile);
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Integrated: \t" + profile.getPeer().toBase64());
    }
  }
}
