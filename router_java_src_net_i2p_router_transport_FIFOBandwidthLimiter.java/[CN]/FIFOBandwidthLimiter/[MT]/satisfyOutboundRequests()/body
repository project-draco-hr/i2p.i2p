{
synchronized (_pendingOutboundRequests) {
    while (_pendingOutboundRequests.size() > 0) {
      BandwidthRequest req=(BandwidthRequest)_pendingOutboundRequests.get(0);
      if ((req.getRequestedOutboundBytes() <= _availableOutboundBytes) || (_outboundUnlimited)) {
        _pendingOutboundRequests.remove(0);
        if (!_outboundUnlimited)         _availableOutboundBytes-=req.getRequestedOutboundBytes();
        _totalAllocatedOutboundBytes+=req.getRequestedOutboundBytes();
        if (_log.shouldLog(Log.INFO))         _log.info("Granting outbound request " + req.getRequestName() + " for "+ req.getRequestedOutboundBytes()+ " bytes (waited "+ (_context.clock().now() - req.getRequestTime())+ "ms) pending "+ (_pendingOutboundRequests.size() - 1));
synchronized (req.getAvailabilityMonitor()) {
          req.grantRequest();
          req.getAvailabilityMonitor().notifyAll();
        }
      }
 else {
        if (_log.shouldLog(Log.WARN))         _log.warn("Still denying the first outbound request (" + req.getRequestName() + " for "+ req.getRequestedOutboundBytes()+ " bytes (available "+ _availableInboundBytes+ "/"+ _availableOutboundBytes+ " in/out) (waited "+ (_context.clock().now() - req.getRequestTime())+ "ms so far) pending "+ (_pendingOutboundRequests.size()));
        return;
      }
    }
  }
}
