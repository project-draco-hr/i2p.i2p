{
  if (_msg.getOnFailedSendJob() != null) {
    getContext().jobQueue().addJob(_msg.getOnFailedSendJob());
  }
  if (_msg.getOnFailedReplyJob() != null) {
    getContext().jobQueue().addJob(_msg.getOnFailedReplyJob());
  }
  MessageSelector selector=_msg.getReplySelector();
  if (selector != null) {
    getContext().messageRegistry().unregisterPending(_msg);
  }
  if (_msg.getTargetHash() != null)   getContext().profileManager().messageFailed(_msg.getTargetHash());
 else   getContext().profileManager().messageFailed(_msg.getTarget().getIdentity().getHash());
  _msg.discardData();
}
