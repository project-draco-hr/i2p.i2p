{
  Log log=context.logManager().getLog(GetBidsJob.class);
  Hash to=msg.getTarget().getIdentity().getHash();
  msg.timestamp("bid");
  if (context.shitlist().isShitlisted(to)) {
    if (log.shouldLog(Log.WARN))     log.warn("Attempt to send a message to a shitlisted peer - " + to);
    fail(context,msg);
    return;
  }
  Hash us=context.routerHash();
  if (to.equals(us)) {
    if (log.shouldLog(Log.ERROR))     log.error("wtf, send a message to ourselves?  nuh uh. msg = " + msg);
    fail(context,msg);
    return;
  }
  TransportBid bid=facade.getNextBid(msg);
  if (bid == null) {
    if (msg.getFailedTransports().size() == 0) {
      context.shitlist().shitlistRouter(to,"We share no common transports with them");
      context.netDb().fail(to);
    }
    fail(context,msg);
  }
 else {
    if (log.shouldLog(Log.INFO))     log.info("Attempting to send on transport " + bid.getTransport().getStyle() + ": "+ bid);
    bid.getTransport().send(msg);
  }
}
