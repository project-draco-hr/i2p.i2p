{
  Hash to=_msg.getTarget().getIdentity().getHash();
  if (getContext().shitlist().isShitlisted(to)) {
    _log.warn("Attempt to send a message to a shitlisted peer - " + to);
    fail();
    return;
  }
  Hash us=getContext().routerHash();
  if (_msg.getTarget().getIdentity().getHash().equals(us)) {
    _log.error("wtf, send a message to ourselves?  nuh uh. msg = " + _msg,getAddedBy());
    fail();
    return;
  }
  List bids=_facade.getBids(_msg);
  if (bids.size() <= 0) {
    _log.warn("No bids available for the message " + _msg);
    Hash target=_msg.getTargetHash();
    if (target == null)     target=_msg.getTarget().getIdentity().getHash();
    getContext().shitlist().shitlistRouter(target,"No bids");
    getContext().netDb().fail(target);
    fail();
  }
 else {
    TransportBid bid=(TransportBid)bids.get(0);
    bid.getTransport().send(_msg);
  }
}
