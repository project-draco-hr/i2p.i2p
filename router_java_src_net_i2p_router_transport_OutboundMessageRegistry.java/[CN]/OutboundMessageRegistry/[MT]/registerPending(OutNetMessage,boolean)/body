{
  if ((!allowEmpty) && (msg.getMessage() == null))   throw new IllegalArgumentException("OutNetMessage doesn't contain an I2NPMessage? wtf");
  MessageSelector sel=msg.getReplySelector();
  if (sel == null)   throw new IllegalArgumentException("No reply selector?  wtf");
  boolean alreadyPending=false;
synchronized (_activeMessages) {
    if (!_activeMessages.add(msg))     return;
  }
synchronized (_selectorToMessage) {
    _selectorToMessage.put(sel,msg);
  }
synchronized (_selectors) {
    _selectors.add(sel);
  }
  _cleanupTask.scheduleExpiration(sel);
}
