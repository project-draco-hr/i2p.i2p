{
  String udn=dev.getUDN();
  if (_log.shouldLog(Log.WARN))   _log.warn("UP&P device removed : " + dev.getFriendlyName() + " UDN: "+ udn);
synchronized (lock) {
    if (_router == null)     return;
    if (udn != null)     _otherUDNs.remove(udn);
 else     _otherUDNs.remove("???");
    if (ROUTER_DEVICE.equals(dev.getDeviceType()) && dev.isRootDevice() && stringEquals(_router.getFriendlyName(),dev.getFriendlyName())&& stringEquals(_router.getUDN(),udn)) {
      if (_log.shouldLog(Log.WARN))       _log.warn("UP&P IGD device removed : " + dev.getFriendlyName());
      _router=null;
      _service=null;
      _serviceLacksAPM=false;
    }
  }
}
