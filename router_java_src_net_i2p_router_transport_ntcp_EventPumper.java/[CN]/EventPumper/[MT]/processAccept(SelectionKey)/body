{
  ServerSocketChannel servChan=(ServerSocketChannel)key.attachment();
  try {
    SocketChannel chan=servChan.accept();
    if (chan == null)     return;
    chan.configureBlocking(false);
    if (!_transport.allowConnection()) {
      if (_log.shouldLog(Log.WARN))       _log.warn("Receive session request but at connection limit: " + chan.socket().getInetAddress());
      try {
        chan.close();
      }
 catch (      IOException ioe) {
      }
      return;
    }
    if (_context.blocklist().isBlocklisted(chan.socket().getInetAddress().getAddress())) {
      if (_log.shouldLog(Log.WARN))       _log.warn("Receive session request from blocklisted IP: " + chan.socket().getInetAddress());
      try {
        chan.close();
      }
 catch (      IOException ioe) {
      }
      return;
    }
    chan.socket().setKeepAlive(true);
    SelectionKey ckey=chan.register(_selector,SelectionKey.OP_READ);
    NTCPConnection con=new NTCPConnection(_context,_transport,chan,ckey);
  }
 catch (  IOException ioe) {
    _log.error("Error accepting",ioe);
  }
}
