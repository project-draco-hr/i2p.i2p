{
  NTCPConnection con=(NTCPConnection)key.attachment();
  try {
    SocketChannel chan=con.getChannel();
    boolean connected=chan.finishConnect();
    if (_log.shouldLog(Log.DEBUG))     _log.debug("processing connect for " + key + " / "+ con+ ": connected? "+ connected);
    if (connected) {
      chan.socket().setKeepAlive(true);
      con.setKey(key);
      con.outboundConnected();
      _context.statManager().addRateData("ntcp.connectSuccessful",1,0);
    }
 else {
      con.close();
      _transport.markUnreachable(con.getRemotePeer().calculateHash());
      _context.statManager().addRateData("ntcp.connectFailedTimeout",1,0);
    }
  }
 catch (  IOException ioe) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Failed outbound connection to " + con.getRemotePeer().calculateHash(),ioe);
    con.close();
    _transport.markUnreachable(con.getRemotePeer().calculateHash());
    _context.statManager().addRateData("ntcp.connectFailedTimeoutIOE",1,0);
  }
catch (  NoConnectionPendingException ncpe) {
  }
}
