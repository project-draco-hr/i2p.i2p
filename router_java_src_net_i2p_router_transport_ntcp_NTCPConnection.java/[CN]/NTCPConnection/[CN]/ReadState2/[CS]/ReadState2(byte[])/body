{
  _stateBegin=System.currentTimeMillis();
  _size=(int)DataHelper.fromLong(buf,0,2);
  if (_size == 0) {
    readMeta(buf);
    _wasMeta=true;
    return;
  }
 else {
    _wasMeta=false;
  }
  _dataBegin=new byte[buf.length - 2];
  System.arraycopy(buf,2,_dataBegin,0,_dataBegin.length);
  _dataRemaining=new byte[_size - _dataBegin.length];
  _dataRemainingIndex=0;
  _crc=new Adler32();
  _crc.update(buf);
  _blocks++;
  if (_log.shouldLog(Log.DEBUG))   _log.debug("new read state with size: " + _size + " remaining: "+ _dataRemaining.length+ " for message "+ _messagesRead);
}
