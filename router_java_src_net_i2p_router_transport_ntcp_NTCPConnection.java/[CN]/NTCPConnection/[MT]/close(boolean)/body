{
  if (_log.shouldLog(Log.INFO))   _log.info("Closing connection " + toString(),new Exception("cause"));
  _closed=true;
  if (_chan != null)   try {
    _chan.close();
  }
 catch (  IOException ioe) {
  }
  if (_conKey != null)   _conKey.cancel();
  _establishState=null;
  _transport.removeCon(this);
  _transport.getReader().connectionClosed(this);
  _transport.getWriter().connectionClosed(this);
  List reqs=null;
synchronized (_bwRequests) {
    if (_bwRequests.size() > 0) {
      reqs=new ArrayList(_bwRequests);
      _bwRequests.clear();
    }
  }
  if (reqs != null)   for (Iterator iter=reqs.iterator(); iter.hasNext(); )   ((FIFOBandwidthLimiter.Request)iter.next()).abort();
  List msgs=null;
synchronized (_outbound) {
    msgs=new ArrayList(_outbound);
    _outbound.clear();
  }
  for (int i=0; i < msgs.size(); i++) {
    OutNetMessage msg=(OutNetMessage)msgs.get(i);
    _transport.afterSend(msg,false,allowRequeue,msg.getLifetime());
  }
}
