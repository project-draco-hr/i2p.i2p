{
  if (_log.shouldLog(Log.DEBUG))   _log.debug("outbound established (key=" + key + " skew="+ clockSkew+ " prevWriteEnd="+ Base64.encode(prevWriteEnd)+ ")");
  _sessionKey=key;
  _clockSkew=clockSkew;
  _prevWriteEnd=prevWriteEnd;
  System.arraycopy(prevReadEnd,prevReadEnd.length - 16,_prevReadBlock,0,_prevReadBlock.length);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Outbound established, prevWriteEnd: " + Base64.encode(prevWriteEnd) + " prevReadEnd: "+ Base64.encode(prevReadEnd));
  _established=true;
  _establishedOn=System.currentTimeMillis();
  _establishState=null;
  _transport.markReachable(getRemotePeer().calculateHash(),false);
  boolean msgs=!_outbound.isEmpty();
  _nextMetaTime=System.currentTimeMillis() + (META_FREQUENCY / 2) + _context.random().nextInt(META_FREQUENCY);
  _nextInfoTime=System.currentTimeMillis() + (INFO_FREQUENCY / 2) + _context.random().nextInt(INFO_FREQUENCY);
  if (msgs)   _transport.getWriter().wantsWrite(this,"outbound established");
}
