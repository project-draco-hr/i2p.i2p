{
  _context.statManager().addRateData("ntcp.inboundEstablished",1);
  markReachable(con.getRemotePeer().calculateHash(),true);
  NTCPConnection old=null;
synchronized (_conLock) {
    old=(NTCPConnection)_conByIdent.put(con.getRemotePeer().calculateHash(),con);
  }
  if (old != null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Old connection closed: " + old + " replaced by "+ con);
    _context.statManager().addRateData("ntcp.inboundEstablishedDuplicate",old.getUptime());
    old.close();
  }
}
