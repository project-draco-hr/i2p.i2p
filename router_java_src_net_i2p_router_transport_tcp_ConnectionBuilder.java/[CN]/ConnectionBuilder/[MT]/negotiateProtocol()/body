{
  ConnectionTagManager mgr=_transport.getTagManager();
  ByteArray tag=mgr.getTag(_target.getIdentity().getHash());
  _key=mgr.getKey(_target.getIdentity().getHash());
  _connectionTag=tag;
  boolean ok=sendPreferredProtocol();
  if (!ok)   return;
  ok=receiveAgreedProtocol();
  if (!ok)   return;
}
