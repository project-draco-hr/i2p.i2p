{
  BigInteger myPub=_builder.getMyPublicValue();
  byte myPubBytes[]=myPub.toByteArray();
  DataHelper.writeLong(_out,2,myPubBytes.length);
  _out.write(myPubBytes);
  int rlen=(int)DataHelper.readLong(_in,2);
  byte peerPubBytes[]=new byte[rlen];
  int read=DataHelper.read(_in,peerPubBytes);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("rlen: " + rlen + " peerBytes: "+ DataHelper.toString(peerPubBytes)+ " read: "+ read);
  BigInteger peerPub=new BigInteger(1,peerPubBytes);
  _builder.setPeerPublicValue(peerPub);
  _key=_builder.getSessionKey();
  _extraBytes=_builder.getExtraBytes();
  _iv=new byte[16];
  System.arraycopy(_extraBytes.getData(),0,_iv,0,Math.min(_extraBytes.getData().length,_iv.length));
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Session key: " + _key.toBase64() + " extra bytes: "+ _extraBytes.getData().length);
}
