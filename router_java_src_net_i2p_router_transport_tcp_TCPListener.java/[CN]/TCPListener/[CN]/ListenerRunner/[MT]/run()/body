{
  if (_log.shouldLog(Log.INFO))   _log.info("Beginning TCP listener");
  int curDelay=0;
  while (_isRunning) {
    try {
      if (_transport.shouldListenToAllInterfaces()) {
        _socket=new ServerSocket(_myAddress.getPort());
      }
 else {
        InetAddress listenAddr=getInetAddress(_myAddress.getHost());
        _socket=new ServerSocket(_myAddress.getPort(),5,listenAddr);
      }
      if (_log.shouldLog(Log.INFO))       _log.info("Begin looping for host " + _myAddress.getHost() + ":"+ _myAddress.getPort());
      curDelay=0;
      loop();
    }
 catch (    IOException ioe) {
      if (_isRunning && _context.router().isAlive())       if (_log.shouldLog(Log.ERROR))       _log.error("Error listening to tcp connection " + _myAddress.getHost() + ":"+ _myAddress.getPort(),ioe);
    }
    if (_socket != null) {
      try {
        _socket.close();
      }
 catch (      IOException ioe) {
      }
      _socket=null;
    }
    if (_log.shouldLog(Log.WARN))     _log.warn("Error listening, waiting " + _nextFailDelay + "ms before we try again");
    try {
      Thread.sleep(_nextFailDelay);
    }
 catch (    InterruptedException ie) {
    }
    curDelay+=_nextFailDelay;
    _nextFailDelay*=5;
    if (_nextFailDelay > MAX_FAIL_DELAY)     _nextFailDelay=MAX_FAIL_DELAY;
  }
  if (_isRunning && _context.router().isAlive())   if (_log.shouldLog(Log.ERROR))   _log.error("CANCELING TCP LISTEN.  delay = " + curDelay);
  _isRunning=false;
}
