{
  int connectedPeers=countActivePeers();
  boolean addressSpecified=(null != _context.getProperty(LISTEN_ADDRESS));
  if (addressSpecified) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Not allowing address update, sicne we have one specified (#cons=" + connectedPeers + ")");
    return false;
  }
  if (connectedPeers < 3) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Allowing address update, since the # of connected peers is " + connectedPeers);
    return true;
  }
 else   if (connectedPeers == 3) {
    int agreed=countActiveAgreeingPeers(proposedAddress);
    if (agreed > 1) {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Most common address selected, allowing address update w/ # of connected peers is " + connectedPeers);
      return true;
    }
 else {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Proposed address [" + proposedAddress + "] is only used by "+ agreed+ ", rejecting address update w/ # of connected peers is "+ connectedPeers);
      return false;
    }
  }
 else {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Not allowing address update, since the # of connected peers is " + connectedPeers);
    return false;
  }
}
