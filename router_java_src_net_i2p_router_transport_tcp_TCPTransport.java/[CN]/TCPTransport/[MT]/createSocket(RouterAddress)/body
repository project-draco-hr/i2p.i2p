{
  String host=addr.getOptions().getProperty(TCPAddress.PROP_HOST);
  String portStr=addr.getOptions().getProperty(TCPAddress.PROP_PORT);
  int port=-1;
  try {
    port=Integer.parseInt(portStr);
  }
 catch (  NumberFormatException nfe) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Invalid port number in router address: " + portStr,nfe);
    return null;
  }
  long start=_context.clock().now();
  SocketCreator creator=new SocketCreator(host,port);
  creator.establishConnection(SOCKET_CREATE_TIMEOUT);
  long finish=_context.clock().now();
  long diff=finish - start;
  if (diff > 6000) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Creating a new socket took too long?  wtf?! " + diff + "ms for "+ host+ ':'+ port);
  }
  if (creator.couldEstablish())   return creator.getSocket();
 else   return null;
}
