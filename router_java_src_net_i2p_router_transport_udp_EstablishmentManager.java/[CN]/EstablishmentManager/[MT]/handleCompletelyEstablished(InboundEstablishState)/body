{
  if (state.complete())   return;
  long now=_context.clock().now();
  RouterIdentity remote=state.getConfirmedIdentity();
  PeerState peer=new PeerState(_context,_transport,state.getSentIP(),state.getSentPort(),remote.calculateHash(),true);
  peer.setCurrentCipherKey(state.getCipherKey());
  peer.setCurrentMACKey(state.getMACKey());
  peer.setWeRelayToThemAs(state.getSentRelayTag());
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Handle completely established (inbound): " + state.getRemoteHostId().toString() + " - "+ peer.getRemotePeer().toBase64());
  _transport.addRemotePeerState(peer);
  _transport.inboundConnectionReceived();
  _transport.setIP(remote.calculateHash(),state.getSentIP());
  _context.statManager().addRateData("udp.inboundEstablishTime",state.getLifetime(),0);
  sendInboundComplete(peer);
}
