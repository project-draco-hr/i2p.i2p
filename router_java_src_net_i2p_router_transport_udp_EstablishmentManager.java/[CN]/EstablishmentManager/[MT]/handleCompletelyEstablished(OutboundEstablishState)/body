{
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Handle completely established (outbound): " + state.getRemoteHostInfo());
  long now=_context.clock().now();
  RouterIdentity remote=state.getRemoteIdentity();
  PeerState peer=new PeerState(_context);
  peer.setCurrentCipherKey(state.getCipherKey());
  peer.setCurrentMACKey(state.getMACKey());
  peer.setCurrentReceiveSecond(now - (now % 1000));
  peer.setKeyEstablishedTime(now);
  peer.setLastReceiveTime(now);
  peer.setLastSendTime(now);
  peer.setRemoteAddress(state.getSentIP(),state.getSentPort());
  peer.setRemotePeer(remote.calculateHash());
  if (true)   peer.setRemoteRequiresIntroduction(false);
  peer.setTheyRelayToUsAs(state.getReceivedRelayTag());
  peer.setWeRelayToThemAs(0);
  _transport.addRemotePeerState(peer);
  sendOurInfo(peer);
  while (true) {
    OutNetMessage msg=state.getNextQueuedMessage();
    if (msg == null)     break;
    _transport.send(msg);
  }
  return peer;
}
