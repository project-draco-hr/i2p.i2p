{
  int admitted=0;
  while ((_queuedOutbound.size() > 0) && (_outboundStates.size() < getMaxConcurrentEstablish())) {
    RemoteHostId to=(RemoteHostId)_queuedOutbound.keySet().iterator().next();
    List queued=(List)_queuedOutbound.remove(to);
    if (queued.size() <= 0)     continue;
    OutNetMessage msg=(OutNetMessage)queued.get(0);
    RouterAddress ra=msg.getTarget().getTargetAddress(_transport.getStyle());
    if (ra == null) {
      for (int i=0; i < queued.size(); i++)       _transport.failed((OutNetMessage)queued.get(i));
      continue;
    }
    UDPAddress addr=new UDPAddress(ra);
    InetAddress remAddr=addr.getHostAddress();
    int port=addr.getPort();
    OutboundEstablishState qstate=new OutboundEstablishState(_context,remAddr,port,msg.getTarget().getIdentity(),new SessionKey(addr.getIntroKey()));
    _outboundStates.put(to,qstate);
    for (int i=0; i < queued.size(); i++)     qstate.addMessage((OutNetMessage)queued.get(i));
    admitted++;
  }
  return admitted;
}
