{
  long now=_context.clock().now();
  boolean valid=state.validateSessionCreated();
  if (!valid)   return;
  _transport.externalAddressReceived(state.getReceivedIP(),state.getReceivedPort());
  state.prepareSessionConfirmed();
  UDPPacket packets[]=_builder.buildSessionConfirmedPackets(state,_context.router().getRouterInfo().getIdentity());
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Send confirm to: " + state.getRemoteHostId().toString());
  for (int i=0; i < packets.length; i++)   _transport.send(packets[i]);
  state.confirmedPacketsSent();
}
