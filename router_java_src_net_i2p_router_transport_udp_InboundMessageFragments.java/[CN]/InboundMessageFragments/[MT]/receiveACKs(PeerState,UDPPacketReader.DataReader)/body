{
  if (data.readACKsIncluded()) {
    int fragments=0;
    long acks[]=data.readACKs();
    if (acks != null) {
      _context.statManager().addRateData("udp.receivedACKs",acks.length,0);
      for (int i=0; i < acks.length; i++) {
        if (_log.shouldLog(Log.INFO))         _log.info("Full ACK of message " + acks[i] + " received!");
        fragments+=_outbound.acked(acks[i],from.getRemotePeer());
      }
    }
 else {
      _log.error("Received ACKs with no acks?! " + data);
    }
  }
  if (data.readACKBitfieldsIncluded()) {
    ACKBitfield bitfields[]=data.readACKBitfields();
    if (bitfields != null) {
      for (int i=0; i < bitfields.length; i++) {
        if (_log.shouldLog(Log.INFO))         _log.info("Partial ACK received: " + bitfields[i]);
        _outbound.acked(bitfields[i],from.getRemotePeer());
      }
    }
  }
  if (data.readECN())   from.ECNReceived();
 else   from.dataReceived();
}
