{
  if (_context.router().isHidden())   return;
  long tag=reader.getRelayRequestReader().readTag();
  PeerState charlie=get(tag);
  if (charlie == null) {
    if (_log.shouldLog(Log.INFO))     _log.info("Receive relay request from " + alice + " with unknown tag");
    _context.statManager().addRateData("udp.receiveRelayRequestBadTag",1,0);
    return;
  }
  if (_log.shouldLog(Log.INFO))   _log.info("Receive relay request from " + alice + " for tag "+ tag+ " and relaying with "+ charlie);
  _context.statManager().addRateData("udp.receiveRelayRequest",1,0);
  byte key[]=new byte[SessionKey.KEYSIZE_BYTES];
  reader.getRelayRequestReader().readAliceIntroKey(key,0);
  SessionKey aliceIntroKey=new SessionKey(key);
  _transport.send(_builder.buildRelayIntro(alice,charlie,reader.getRelayRequestReader()));
  _transport.send(_builder.buildRelayResponse(alice,charlie,reader.getRelayRequestReader().readNonce(),aliceIntroKey));
}
