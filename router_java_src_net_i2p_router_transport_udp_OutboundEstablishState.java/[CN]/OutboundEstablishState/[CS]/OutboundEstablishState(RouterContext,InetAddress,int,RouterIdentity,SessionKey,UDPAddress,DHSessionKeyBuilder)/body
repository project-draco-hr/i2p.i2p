{
  _context=ctx;
  _log=ctx.logManager().getLog(OutboundEstablishState.class);
  if ((remoteHost != null) && (remotePort > 0)) {
    _bobIP=remoteHost.getAddress();
    _bobPort=remotePort;
    _remoteHostId=new RemoteHostId(_bobIP,_bobPort);
  }
 else {
    _bobIP=null;
    _bobPort=-1;
    _remoteHostId=new RemoteHostId(remotePeer.calculateHash().getData());
  }
  _remotePeer=remotePeer;
  _introKey=introKey;
  _queuedMessages=new LinkedBlockingQueue();
  _establishBegin=ctx.clock().now();
  _remoteAddress=addr;
  _introductionNonce=-1;
  _keyBuilder=dh;
  _sentX=new byte[UDPPacketReader.SessionRequestReader.X_LENGTH];
  prepareSessionRequest();
  if (addr.getIntroducerCount() > 0) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("new outbound establish to " + remotePeer.calculateHash() + ", with address: "+ addr);
    _currentState=OutboundState.OB_STATE_PENDING_INTRO;
  }
 else {
    _currentState=OutboundState.OB_STATE_UNKNOWN;
  }
}
