{
  if (_fragmentSends != null)   throw new IllegalStateException();
  initBuf();
  int numFragments=_totalSize / fragmentSize;
  if (numFragments * fragmentSize < _totalSize)   numFragments++;
  if (numFragments > InboundMessageState.MAX_FRAGMENTS)   throw new IllegalArgumentException("Fragmenting a " + _totalSize + " message into "+ numFragments+ " fragments - too many!");
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Fragmenting a " + _totalSize + " message into "+ numFragments+ " fragments");
  _fragmentSends=new short[numFragments];
  _fragmentSize=fragmentSize;
}
