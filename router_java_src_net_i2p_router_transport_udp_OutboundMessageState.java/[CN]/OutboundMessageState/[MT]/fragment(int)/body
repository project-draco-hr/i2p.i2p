{
  int totalSize=_messageBuf.getValid();
  int numFragments=totalSize / fragmentSize;
  if (numFragments * fragmentSize != totalSize)   numFragments++;
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Fragmenting a " + totalSize + " message into "+ numFragments+ " fragments");
  _fragmentSends=new short[numFragments];
  Arrays.fill(_fragmentSends,(short)0);
  _fragmentSize=fragmentSize;
}
