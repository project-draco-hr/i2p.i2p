{
  int start=_fragmentSize * fragmentNum;
  int end=start + _fragmentSize;
  if (_messageBuf == null)   return -1;
  if (end > _messageBuf.getValid())   end=_messageBuf.getValid();
  int toSend=end - start;
  System.arraycopy(_messageBuf.getData(),start,out,outOffset,toSend);
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Raw fragment[" + fragmentNum + "] for "+ _messageId+ "["+ start+ "-"+ (start + toSend)+ "/"+ _messageBuf.getValid()+ "/"+ _fragmentSize+ "]: "+ Base64.encode(out,outOffset,toSend));
  return toSend;
}
