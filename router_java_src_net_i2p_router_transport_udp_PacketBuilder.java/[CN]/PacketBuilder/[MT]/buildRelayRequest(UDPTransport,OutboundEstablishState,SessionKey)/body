{
  UDPAddress addr=state.getRemoteAddress();
  int count=addr.getIntroducerCount();
  List<UDPPacket> rv=new ArrayList(count);
  for (int i=0; i < count; i++) {
    InetAddress iaddr=addr.getIntroducerHost(i);
    int iport=addr.getIntroducerPort(i);
    byte ikey[]=addr.getIntroducerKey(i);
    long tag=addr.getIntroducerTag(i);
    if (ikey == null || iport < 1024 || iport > 65535 || iaddr == null || tag <= 0 || (!_transport.isValid(iaddr.getAddress())) || Arrays.equals(iaddr.getAddress(),_transport.getExternalIP())) {
      if (_log.shouldLog(_log.WARN))       _log.warn("Cannot build a relay request to " + state.getRemoteIdentity().calculateHash() + ", as their UDP address is invalid: addr="+ addr+ " index="+ i);
      continue;
    }
    rv.add(buildRelayRequest(iaddr,iport,ikey,tag,ourIntroKey,state.getIntroNonce(),true));
  }
  return rv;
}
