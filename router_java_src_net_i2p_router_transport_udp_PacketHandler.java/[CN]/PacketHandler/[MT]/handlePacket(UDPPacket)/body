{
  if (packet == null)   return;
  InetAddress remAddr=packet.getPacket().getAddress();
  int remPort=packet.getPacket().getPort();
  PeerState state=_transport.getPeerState(remAddr,remPort);
  if (state == null) {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Packet received is not for a connected peer");
    InboundEstablishState est=_establisher.getInboundState(remAddr,remPort);
    if (est != null) {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Packet received IS for an inbound establishment");
      receivePacket(packet,est);
    }
 else {
      if (_log.shouldLog(Log.DEBUG))       _log.debug("Packet received is not for an inbound establishment");
      OutboundEstablishState oest=_establisher.getOutboundState(remAddr,remPort);
      if (oest != null) {
        if (_log.shouldLog(Log.DEBUG))         _log.debug("Packet received IS for an outbound establishment");
        receivePacket(packet,oest);
      }
 else {
        if (_log.shouldLog(Log.DEBUG))         _log.debug("Packet received is not for an inbound or outbound establishment");
        receivePacket(packet);
      }
    }
  }
 else {
    if (_log.shouldLog(Log.DEBUG))     _log.debug("Packet received IS for an existing peer");
    receivePacket(packet,state);
  }
}
