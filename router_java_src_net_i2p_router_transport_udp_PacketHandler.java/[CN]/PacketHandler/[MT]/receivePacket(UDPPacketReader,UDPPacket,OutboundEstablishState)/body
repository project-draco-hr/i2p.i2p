{
  if ((state != null) && (_log.shouldLog(Log.DEBUG))) {
    StringBuffer buf=new StringBuffer(128);
    buf.append("Attempting to receive a packet on a known outbound state: ");
    buf.append(state);
    buf.append(" MAC key: ").append(state.getMACKey());
    buf.append(" intro key: ").append(state.getIntroKey());
    _log.debug(buf.toString());
  }
  boolean isValid=false;
  if (state.getMACKey() != null) {
    isValid=packet.validate(state.getMACKey());
    if (isValid) {
      if (_log.shouldLog(Log.WARN))       _log.warn("Valid introduction packet received for outbound established con: " + packet);
      packet.decrypt(state.getCipherKey());
      handlePacket(reader,packet,null,state,null);
      return;
    }
  }
  isValid=packet.validate(state.getIntroKey());
  if (isValid) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Valid introduction packet received for outbound established con with old intro key: " + packet);
    packet.decrypt(state.getIntroKey());
    handlePacket(reader,packet,null,state,null);
    return;
  }
 else {
    if (_log.shouldLog(Log.WARN))     _log.warn("Invalid introduction packet received for outbound established con with old intro key, falling back: " + packet);
  }
  receivePacket(reader,packet);
}
