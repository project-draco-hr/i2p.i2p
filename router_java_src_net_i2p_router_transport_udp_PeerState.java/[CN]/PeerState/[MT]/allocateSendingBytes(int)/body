{
  long now=_context.clock().now();
  if (_lastSendRefill + 1000 <= now) {
    _sendWindowBytesRemaining=_sendWindowBytes;
    _lastSendRefill=now;
  }
  if (size <= _sendWindowBytesRemaining) {
    _sendWindowBytesRemaining-=size;
    _lastSendTime=now;
    return true;
  }
 else {
    return false;
  }
}
