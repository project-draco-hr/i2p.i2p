{
  if (bytes > 0)   _receiveBytes+=bytes;
 else {
    if (_retransmissionPeriodStart + RETRANSMISSION_PERIOD_WIDTH < _packetsReceived) {
      _packetsReceivedDuplicate++;
    }
 else {
      _retransmissionPeriodStart=_packetsReceived;
      _packetsReceivedDuplicate=1;
    }
  }
  long now=_context.clock().now();
  long duration=now - _receivePeriodBegin;
  if (duration >= 1000) {
    _receiveBps=(int)(0.9f * (float)_receiveBps + 0.1f * ((float)_receiveBytes * (1000f / (float)duration)));
    _receiveBytes=0;
    _receivePeriodBegin=now;
    _context.statManager().addRateData("udp.receiveBps",_receiveBps,0);
  }
synchronized (_currentACKs) {
    if (_wantACKSendSince <= 0)     _wantACKSendSince=now;
    if (!_currentACKs.contains(messageId))     _currentACKs.add(messageId);
  }
  _messagesReceived++;
}
