{
  long now=_context.clock().now();
  _packetsTransmitted+=packets;
  if (_retransmissionPeriodStart + 1000 <= now) {
    _packetRetransmissionRate=(int)((float)(0.9f * _packetRetransmissionRate) + (float)(0.1f * _packetsRetransmitted));
    _retransmissionPeriodStart=0;
    _packetsPeriodRetransmitted=(int)_packetsRetransmitted;
    _packetsRetransmitted=0;
  }
}
