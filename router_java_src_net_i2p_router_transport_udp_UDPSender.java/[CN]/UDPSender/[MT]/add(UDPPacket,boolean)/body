{
  int remaining=-1;
  while ((_keepRunning) && (remaining < 0)) {
    try {
synchronized (_outboundQueue) {
        if (_outboundQueue.size() < MAX_QUEUED) {
          _outboundQueue.add(packet);
          remaining=_outboundQueue.size();
          _outboundQueue.notifyAll();
        }
 else {
          if (blocking) {
            _outboundQueue.wait();
          }
 else {
            remaining=_outboundQueue.size();
          }
        }
      }
    }
 catch (    InterruptedException ie) {
    }
  }
  _context.statManager().addRateData("udp.sendQueueSize",remaining,packet.getLifetime());
  return remaining;
}
