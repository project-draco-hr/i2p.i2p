{
  long inactivityCutoff=_context.clock().now() - EXPIRE_TIMEOUT;
  _expireBuffer.clear();
synchronized (_expirePeers) {
    int sz=_expirePeers.size();
    for (int i=0; i < sz; i++) {
      PeerState peer=(PeerState)_expirePeers.get(i);
      if ((peer.getLastReceiveTime() < inactivityCutoff) && (peer.getLastSendTime() < inactivityCutoff)) {
        _expireBuffer.add(peer);
        _expirePeers.remove(i);
        i--;
        sz--;
      }
    }
  }
  for (int i=0; i < _expireBuffer.size(); i++)   dropPeer((PeerState)_expireBuffer.get(i),false);
  _expireBuffer.clear();
  if (_alive)   SimpleTimer.getInstance().addEvent(ExpirePeerEvent.this,30 * 1000);
}
