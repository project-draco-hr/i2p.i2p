{
  if (_log.shouldLog(Log.DEBUG))   _log.debug("External address received: " + Base64.encode(ourIP) + ":"+ ourPort);
  if (explicitAddressSpecified())   return;
  boolean fixedPort=getIsPortFixed();
  boolean updated=false;
synchronized (this) {
    if ((_externalListenHost == null) || (!eq(_externalListenHost.getAddress(),_externalListenPort,ourIP,ourPort))) {
      try {
        _externalListenHost=InetAddress.getByAddress(ourIP);
        if (!fixedPort)         _externalListenPort=ourPort;
        rebuildExternalAddress();
        replaceAddress(_externalAddress);
        updated=true;
      }
 catch (      UnknownHostException uhe) {
        _externalListenHost=null;
      }
    }
  }
  if (!fixedPort)   _context.router().setConfigSetting(PROP_EXTERNAL_PORT,ourPort + "");
  _context.router().saveConfig();
  if (updated)   _context.router().rebuildRouterInfo();
}
