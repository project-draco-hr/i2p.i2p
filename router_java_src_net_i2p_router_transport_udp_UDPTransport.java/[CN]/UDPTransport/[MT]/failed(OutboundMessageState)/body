{
  if (msg == null)   return;
  int consecutive=0;
  if ((msg.getPeer() != null) && ((msg.getMaxSends() >= OutboundMessageFragments.MAX_VOLLEYS) || (msg.isExpired()))) {
    consecutive=msg.getPeer().incrementConsecutiveFailedSends();
    if (_log.shouldLog(Log.WARN))     _log.warn("Consecutive failure #" + consecutive + " sending to "+ msg.getPeer());
    if (consecutive > MAX_CONSECUTIVE_FAILED)     dropPeer(msg.getPeer());
  }
  failed(msg.getMessage());
}
