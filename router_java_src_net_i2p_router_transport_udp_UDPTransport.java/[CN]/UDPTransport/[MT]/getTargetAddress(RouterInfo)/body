{
  List<RouterAddress> addrs=target.getTargetAddresses(STYLE);
  for (int i=0; i < addrs.size(); i++) {
    RouterAddress addr=addrs.get(i);
    if (addr.getOption("ihost0") == null) {
      byte[] ip=addr.getIP();
      int port=addr.getPort();
      if (ip == null || port < MIN_PEER_PORT || (!isValid(ip)) || Arrays.equals(ip,getExternalIP())) {
        continue;
      }
    }
    return addr;
  }
  return null;
}
