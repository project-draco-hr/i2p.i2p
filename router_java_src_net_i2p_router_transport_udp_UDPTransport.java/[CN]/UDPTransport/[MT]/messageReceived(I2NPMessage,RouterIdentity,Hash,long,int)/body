{
  if (inMsg.getType() == DatabaseStoreMessage.MESSAGE_TYPE) {
    DatabaseStoreMessage dsm=(DatabaseStoreMessage)inMsg;
    if ((dsm.getRouterInfo() != null) && (dsm.getRouterInfo().getNetworkId() != Router.NETWORK_ID)) {
      _context.shitlist().shitlistRouter(dsm.getRouterInfo().getIdentity().calculateHash(),"Part of the wrong network");
      dropPeer(dsm.getRouterInfo().getIdentity().calculateHash());
      if (_log.shouldLog(Log.WARN))       _log.warn("Dropping the peer " + dsm.getRouterInfo().getIdentity().calculateHash().toBase64() + " because they are in the wrong net");
      return;
    }
 else {
      if (dsm.getRouterInfo() != null) {
        if (_log.shouldLog(Log.INFO))         _log.info("Received an RI from the same net");
      }
 else {
        if (_log.shouldLog(Log.INFO))         _log.info("Received a leaseSet: " + dsm);
      }
    }
  }
 else {
    if (_log.shouldLog(Log.INFO))     _log.info("Received another message: " + inMsg.getClass().getName());
  }
  PeerState peer=getPeerState(remoteIdentHash);
  super.messageReceived(inMsg,remoteIdent,remoteIdentHash,msToReceive,bytesReceived);
  if (peer != null)   peer.expireInboundMessages();
}
