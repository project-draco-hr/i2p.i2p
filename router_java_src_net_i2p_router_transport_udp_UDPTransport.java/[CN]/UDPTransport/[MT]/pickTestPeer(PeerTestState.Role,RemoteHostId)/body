{
  if (peerRole == ALICE)   throw new IllegalArgumentException();
  List<PeerState> peers=new ArrayList(_peersByIdent.values());
  for (Iterator<PeerState> iter=new RandomIterator(peers); iter.hasNext(); ) {
    PeerState peer=iter.next();
    if ((dontInclude != null) && (dontInclude.equals(peer.getRemoteHostId())))     continue;
    byte[] ip=peer.getRemoteIP();
    if (peerRole == BOB && ip.length != 4)     continue;
    RouterInfo peerInfo=_context.netDb().lookupRouterInfoLocally(peer.getRemotePeer());
    if (peerInfo == null)     continue;
    ip=null;
    List<RouterAddress> addrs=peerInfo.getTargetAddresses(STYLE);
    for (    RouterAddress addr : addrs) {
      ip=addr.getIP();
      if (ip != null && ip.length == 4)       break;
    }
    if (ip == null)     continue;
    if (DataHelper.eq(ip,0,getExternalIP(),0,2))     continue;
    return peer;
  }
  return null;
}
