{
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Sending " + startAt + ":"+ sendThrough+ " out of "+ pending.size());
  byte preprocessed[]=_dataCache.acquire().getData();
  ByteArray ivBuf=_ivCache.acquire();
  byte iv[]=ivBuf.getData();
  _context.random().nextBytes(iv);
  int offset=0;
  offset=writeFragments(pending,startAt,sendThrough,preprocessed,offset);
  preprocess(preprocessed,offset);
  sender.sendPreprocessed(preprocessed,rec);
}
