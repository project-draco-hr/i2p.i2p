{
  Log log=ctx.logManager().getLog(getClass());
  int rv[]=new int[TunnelBuildReplyMessage.RECORD_COUNT];
  for (int i=0; i < rv.length; i++) {
    int hop=((Integer)recordOrder.get(i)).intValue();
    if (BuildMessageGenerator.isBlank(cfg,hop)) {
      if (log.shouldLog(Log.DEBUG))       log.debug(reply.getUniqueId() + ": no need to decrypt record " + i+ "/"+ hop+ ", as its out of range: "+ cfg);
      rv[i]=0;
    }
 else {
      int ok=decryptRecord(ctx,reply,cfg,i,hop);
      if (ok == -1) {
        if (log.shouldLog(Log.WARN))         log.warn(reply.getUniqueId() + ": decrypt record " + i+ "/"+ hop+ " was not ok: "+ cfg);
        return null;
      }
 else {
        if (log.shouldLog(Log.DEBUG))         log.debug(reply.getUniqueId() + ": decrypt record " + i+ "/"+ hop+ " was ok: "+ ok+ " for "+ cfg);
      }
      rv[i]=ok;
    }
  }
  return rv;
}
