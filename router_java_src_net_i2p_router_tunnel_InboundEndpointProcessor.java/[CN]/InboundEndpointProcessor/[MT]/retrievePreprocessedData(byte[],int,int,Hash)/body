{
  Hash last=_config.getPeer(_config.getLength() - 1);
  if (!last.equals(prev)) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Invalid previous peer - attempted hostile loop?  from " + prev + ", expected "+ last);
    return false;
  }
  byte iv[]=new byte[HopProcessor.IV_LENGTH];
  System.arraycopy(orig,offset,iv,0,iv.length);
  boolean ok=_validator.receiveIV(iv);
  if (!ok) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Invalid IV received");
    return false;
  }
  if (USE_ENCRYPTION)   OutboundGatewayProcessor.decrypt(_context,_config,iv,orig,offset,length);
  return true;
}
