{
  Hash last=_config.getPeer(_config.getLength() - 2);
  if (!last.equals(prev)) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Invalid previous peer - attempted hostile loop?  from " + prev + ", expected "+ last);
    return false;
  }
  ByteArray ba=_cache.acquire();
  byte iv[]=ba.getData();
  System.arraycopy(orig,offset,iv,0,iv.length);
  boolean ok=_validator.receiveIV(iv);
  if (!ok) {
    if (_log.shouldLog(Log.WARN))     _log.warn("Invalid IV received");
    _cache.release(ba);
    return false;
  }
  if (USE_ENCRYPTION)   decrypt(_context,_config,iv,orig,offset,length);
  _cache.release(ba);
  return true;
}
