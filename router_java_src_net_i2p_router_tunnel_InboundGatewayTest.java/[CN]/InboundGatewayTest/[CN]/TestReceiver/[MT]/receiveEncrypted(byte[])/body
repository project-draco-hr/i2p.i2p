{
  for (int i=1; i <= _config.getLength() - 1; i++) {
    HopProcessor hop=new HopProcessor(_context,_config.getConfig(i));
    boolean ok=hop.process(encrypted,0,encrypted.length,_config.getConfig(i).getReceiveFrom());
    if (!ok)     _log.error("Error processing at hop " + i);
  }
  InboundEndpointProcessor end=new InboundEndpointProcessor(_context,_config);
  boolean ok=end.retrievePreprocessedData(encrypted,0,encrypted.length,_config.getPeer(_config.getLength() - 1));
  if (!ok)   _log.error("Error retrieving cleartext at the endpoint");
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Received      " + Base64.encode(encrypted));
  _handler.receiveTunnelMessage(encrypted,0,encrypted.length);
  _log.debug("\n\ndone receiving message\n\n");
}
