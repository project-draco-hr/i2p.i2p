{
  for (int i=0; i < _config.getLength(); i++) {
    HopProcessor hop=new HopProcessor(_context,_config.getConfig(i));
    boolean ok=hop.process(encrypted,0,encrypted.length,_config.getConfig(i).getReceiveFrom());
    if (!ok)     _log.error("Error processing at hop " + i);
  }
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Received      " + Base64.encode(encrypted));
  _handler.receiveTunnelMessage(encrypted,0,encrypted.length);
  _log.debug("\n\ndone receiving message\n\n");
}
