{
  _context=context;
  _log=context.logManager().getLog(TunnelGateway.class);
  _queue=new ArrayList(4);
  _preprocessor=preprocessor;
  _sender=sender;
  _receiver=receiver;
  _messagesSent=0;
  _flushFrequency=500;
  _delayedFlush=new DelayedFlush();
  _lastFlush=_context.clock().now();
  _context.statManager().createRateStat("tunnel.lockedGatewayAdd","How long do we block when adding a message to a tunnel gateway's queue","Tunnels",new long[]{60 * 1000,10 * 60 * 1000});
  _context.statManager().createRateStat("tunnel.lockedGatewayCheck","How long do we block when flushing a tunnel gateway's queue","Tunnels",new long[]{60 * 1000,10 * 60 * 1000});
}
