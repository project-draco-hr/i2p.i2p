{
  int checksumSize=HOPS * COLUMN_WIDTH;
  int offset=message.length - (checksumSize + VERIFICATION_WIDTH);
  Hash checksumHash=ctx.sha().calculateHash(message,offset,checksumSize);
  getLog(ctx).debug("Measured checksum: " + checksumHash.toBase64());
  byte expected[]=new byte[VERIFICATION_WIDTH];
  System.arraycopy(message,message.length - VERIFICATION_WIDTH,expected,0,VERIFICATION_WIDTH);
  getLog(ctx).debug("Expected checksum: " + Base64.encode(expected));
  return DataHelper.eq(checksumHash.getData(),0,message,message.length - VERIFICATION_WIDTH,VERIFICATION_WIDTH);
}
