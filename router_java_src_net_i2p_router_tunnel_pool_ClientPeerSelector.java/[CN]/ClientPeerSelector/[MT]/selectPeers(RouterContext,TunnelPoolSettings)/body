{
  int length=getLength(ctx,settings);
  if (length < 0)   return null;
  HashSet matches=new HashSet(length);
  if (length > 0) {
    if (shouldSelectExplicit(settings))     return selectExplicit(ctx,settings,length);
  }
  Set exclude=getExclude(ctx,settings.isInbound(),settings.isExploratory());
  ctx.profileOrganizer().selectFastPeers(length,exclude,matches);
  matches.remove(ctx.routerHash());
  ArrayList rv=new ArrayList(matches);
  Collections.shuffle(rv,ctx.random());
  if (settings.isInbound())   rv.add(0,ctx.routerHash());
 else   rv.add(ctx.routerHash());
  return rv;
}
