{
  if (_log.shouldLog(Log.DEBUG))   _log.debug(toString() + ": refreshing leaseSet on tunnel expiration (but prior to grace timeout)");
  int remaining=0;
  LeaseSet ls=null;
  if (_settings.isInbound() && (_settings.getDestination() != null)) {
synchronized (_tunnels) {
      ls=locked_buildNewLeaseSet();
      remaining=_tunnels.size();
    }
    if (ls != null) {
      _context.clientManager().requestLeaseSet(_settings.getDestination(),ls);
    }
 else {
      if (_log.shouldLog(Log.WARN))       _log.warn(toString() + ": unable to build a new leaseSet on expire (" + remaining+ " remaining), request a new tunnel");
      if (_settings.getAllowZeroHop())       buildFake();
    }
  }
}
