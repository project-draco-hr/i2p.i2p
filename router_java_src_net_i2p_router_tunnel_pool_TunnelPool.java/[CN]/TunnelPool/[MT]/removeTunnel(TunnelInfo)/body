{
  if (_log.shouldLog(Log.DEBUG))   _log.debug(toString() + ": Removing tunnel " + info);
  int remaining=0;
  LeaseSet ls=null;
synchronized (_tunnels) {
    _tunnels.remove(info);
    if (_settings.isInbound() && (_settings.getDestination() != null))     ls=locked_buildNewLeaseSet();
    remaining=_tunnels.size();
  }
  _lifetimeProcessed+=info.getProcessedMessagesCount();
  if (_settings.isInbound() && (_settings.getDestination() != null)) {
    if (ls != null) {
      _context.clientManager().requestLeaseSet(_settings.getDestination(),ls);
    }
 else {
      if (_log.shouldLog(Log.WARN))       _log.warn(toString() + ": unable to build a new leaseSet on removal (" + remaining+ " remaining), request a new tunnel");
      if (_settings.getAllowZeroHop())       buildFallback();
    }
  }
  boolean connected=true;
  if ((_settings.getDestination() != null) && (!_context.clientManager().isLocal(_settings.getDestination())))   connected=false;
  if ((getTunnelCount() <= 0) && (!connected)) {
    _manager.removeTunnels(_settings.getDestination());
    return;
  }
  refreshBuilders();
}
