{
  _context=ctx;
  _log=ctx.logManager().getLog(TunnelPoolManager.class);
  _clientInboundPools=new ConcurrentHashMap(4);
  _clientOutboundPools=new ConcurrentHashMap(4);
  _executor=new BuildExecutor(ctx,this);
  I2PThread execThread=new I2PThread(_executor,"BuildExecutor",true);
  execThread.start();
  _handler=new BuildHandler(ctx,this,_executor);
  int numHandlerThreads;
  int share=TunnelDispatcher.getShareBandwidth(ctx);
  if (share >= MIN_KBPS_THREE_HANDLERS)   numHandlerThreads=3;
 else   if (share >= MIN_KBPS_TWO_HANDLERS)   numHandlerThreads=2;
 else   numHandlerThreads=1;
  for (int i=1; i <= numHandlerThreads; i++) {
    I2PThread hThread=new I2PThread(_handler,"BuildHandler " + i + '/'+ numHandlerThreads,true);
    hThread.start();
  }
  ctx.statManager().createRequiredRateStat("tunnel.testFailedTime","Time for tunnel test failure (ms)","Tunnels",RATES);
  ctx.statManager().createRateStat("tunnel.testExploratoryFailedTime","How long did the failure of an exploratory tunnel take (max of 60s for full timeout)?","Tunnels",RATES);
  ctx.statManager().createRateStat("tunnel.testFailedCompletelyTime","How long did the complete failure take (max of 60s for full timeout)?","Tunnels",RATES);
  ctx.statManager().createRateStat("tunnel.testExploratoryFailedCompletelyTime","How long did the complete failure of an exploratory tunnel take (max of 60s for full timeout)?","Tunnels",RATES);
  ctx.statManager().createRateStat("tunnel.testSuccessLength","How long were the tunnels that passed the test?","Tunnels",RATES);
  ctx.statManager().createRequiredRateStat("tunnel.testSuccessTime","Time for tunnel test success (ms)","Tunnels",RATES);
  ctx.statManager().createRateStat("tunnel.testAborted","Tunnel test could not occur, since there weren't any tunnels to test with","Tunnels",RATES);
}
