{
  int numSafe=0;
  long expireAfter=Clock.getInstance().now() + Router.CLOCK_FUDGE_FACTOR + futureMs;
  for (Iterator iter=getInboundTunnelIds().iterator(); iter.hasNext(); ) {
    TunnelId id=(TunnelId)iter.next();
    TunnelInfo info=getInboundTunnel(id);
    if ((info != null) && (info.getIsReady()) && (info.getSettings().getExpiration() > expireAfter))     numSafe++;
  }
  return numSafe;
}
