{
  if (_log.shouldLog(Log.DEBUG))   _log.debug("Sending reply to a tunnel create of id " + _message.getTunnelId() + " with ok ("+ ok+ ") to router "+ _message.getReplyBlock().getRouter().toBase64());
  _context.messageHistory().receiveTunnelCreate(_message.getTunnelId(),_message.getNextRouter(),new Date(_context.clock().now() + 1000 * _message.getTunnelDurationSeconds()),ok,_message.getReplyBlock().getRouter());
  TunnelCreateStatusMessage msg=new TunnelCreateStatusMessage(_context);
  msg.setFromHash(_context.routerHash());
  msg.setTunnelId(_message.getTunnelId());
  if (ok) {
    msg.setStatus(TunnelCreateStatusMessage.STATUS_SUCCESS);
  }
 else {
    msg.setStatus(TunnelCreateStatusMessage.STATUS_FAILED_OVERLOADED);
  }
  msg.setMessageExpiration(new Date(_context.clock().now() + 60 * 1000));
  SendReplyMessageJob job=new SendReplyMessageJob(_context,_message.getReplyBlock(),msg,PRIORITY);
  _context.jobQueue().addJob(job);
}
