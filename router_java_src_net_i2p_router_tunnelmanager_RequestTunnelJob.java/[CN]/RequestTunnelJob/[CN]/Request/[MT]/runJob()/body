{
  boolean needsMore=_state.doNext();
  if (needsMore) {
    requeue(0);
  }
 else {
    MessageHistory hist=Request.this.getContext().messageHistory();
    hist.requestTunnelCreate(_tunnelGateway.getTunnelId(),_state.getOutboundTunnel(),_state.getParticipant().getThisHop(),_state.getParticipant().getNextHop(),_state.getInboundGateway().getTunnelId(),_state.getInboundGateway().getGateway());
  }
}
