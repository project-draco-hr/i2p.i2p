{
  long rv=DEFAULT_TEST_TIMEOUT;
  RateStat rs=getContext().statManager().getRate("tunnel.testSuccessTime");
  if (rs != null) {
    Rate r=rs.getRate(10 * 60 * 1000);
    if (r != null) {
      if (r.getLifetimeEventCount() > 0) {
        if (r.getLastEventCount() <= 0)         rv=(long)(r.getLifetimeAverageValue() * getTunnelTestDeviationLimit());
 else         rv=(long)(r.getAverageValue() * getTunnelTestDeviationLimit());
      }
    }
  }
  long min=getMinimumTestTimeout();
  if (rv < min)   rv=min;
  return rv;
}
