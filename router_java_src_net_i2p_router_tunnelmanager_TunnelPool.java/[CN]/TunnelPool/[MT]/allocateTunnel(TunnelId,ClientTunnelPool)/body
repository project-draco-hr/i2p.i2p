{
  if (!_isLive)   return false;
  if (pool == null) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error allocating tunnel " + id + " to "+ pool.getDestination()+ ": no pool for the client known");
    return false;
  }
  TunnelInfo tunnel=removeFreeTunnel(id);
  if (tunnel == null) {
    if (_log.shouldLog(Log.ERROR))     _log.error("Error allocating tunnel " + id + " to "+ pool.getDestination()+ ": tunnel is no longer free?");
    return false;
  }
  TunnelInfo t=tunnel;
  while (t != null) {
    t.setDestination(pool.getDestination());
    t=t.getNextHopInfo();
  }
  pool.addInboundTunnel(tunnel);
  return true;
}
