{
synchronized (RouterPasswordManager.class) {
    if (_context.getBooleanProperty(PROP_MIGRATED))     return true;
    String pw=_context.getProperty(PROP_I2CP_OLD);
    if (pw != null) {
      if (pw.length() > 0)       saveHash(PROP_I2CP_NEW,null,pw);
      _context.router().saveConfig(PROP_I2CP_OLD,null);
    }
    Map<String,String> toAdd=new HashMap(5);
    List<String> toDel=new ArrayList(5);
    for (int i=0; i < MIGRATE_FROM.length; i++) {
      if ((pw=_context.getProperty(MIGRATE_FROM[i])) != null) {
        toAdd.put(MIGRATE_TO[i],Base64.encode(DataHelper.getUTF8(pw)));
        toDel.add(MIGRATE_FROM[i]);
      }
    }
    toAdd.put(PROP_MIGRATED,"true");
    return _context.router().saveConfig(toAdd,toDel);
  }
}
