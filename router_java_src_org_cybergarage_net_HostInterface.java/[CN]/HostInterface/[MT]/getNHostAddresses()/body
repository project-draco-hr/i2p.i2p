{
  if (hasAssignedInterface() == true)   return 1;
  int nHostAddrs=0;
  try {
    Enumeration nis=NetworkInterface.getNetworkInterfaces();
    while (nis.hasMoreElements()) {
      NetworkInterface ni=(NetworkInterface)nis.nextElement();
      Enumeration addrs=ni.getInetAddresses();
      while (addrs.hasMoreElements()) {
        InetAddress addr=(InetAddress)addrs.nextElement();
        if (isUsableAddress(addr) == false)         continue;
        nHostAddrs++;
      }
    }
  }
 catch (  Exception e) {
  }
  ;
  return nHostAddrs;
}
