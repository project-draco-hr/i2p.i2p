{
  for (int i=1; i <= _config.getLength() - 2; i++) {
    HopProcessor hop=new HopProcessor(_context,_config.getConfig(i));
    assertTrue(hop.process(encrypted,0,encrypted.length,_config.getConfig(i).getReceiveFrom()));
  }
  InboundEndpointProcessor end=new InboundEndpointProcessor(_context,_config);
  assertTrue(end.retrievePreprocessedData(encrypted,0,encrypted.length,_config.getPeer(_config.getLength() - 2)));
  _handler.receiveTunnelMessage(encrypted,0,encrypted.length);
  return -1;
}
